{"ast":null,"code":"import React, { createContext, useState, useContext, useRef, useEffect, Component } from 'react';\nimport _$1 from 'lodash';\nimport { getLatestChats as getLatestChats$1, getLatestMessages as getLatestMessages$1, readMessage as readMessage$1, TextInput as TextInput$1, Button as Button$1, newChat as newChat$1, Avatar as Avatar$1, removePerson as removePerson$1, AutoCompleteInput, addPerson as addPerson$1, getOtherPeople as getOtherPeople$1, deleteChat as deleteChat$1, editChat as editChat$1, Dot as Dot$1, isTyping as isTyping$1, sendMessage as sendMessage$1, getChat as getChat$1 } from 'react-chat-engine';\nimport { WebSocket } from 'nextjs-websocket';\nimport axios from 'axios';\nimport { SyncOutlined, MenuOutlined, CloseOutlined, LeftOutlined, DownOutlined, SettingOutlined, LoadingOutlined, CloseCircleTwoTone, PaperClipOutlined, PlusOutlined, ArrowUpOutlined, DeleteOutlined, UserAddOutlined } from '@ant-design/icons';\nimport { setConfiguration, Row, Col } from 'react-grid-system';\nimport { animateScroll } from 'react-scroll';\nvar ChatEngineContext = createContext();\n\nvar ChatEngineWrapper = function ChatEngineWrapper(props) {\n  var _useState = useState(true),\n      connecting = _useState[0],\n      setConnecting = _useState[1];\n\n  var _useState2 = useState(null),\n      conn = _useState2[0],\n      setConn = _useState2[1];\n\n  var _useState3 = useState(null),\n      creds = _useState3[0],\n      setCreds = _useState3[1];\n\n  var _useState4 = useState(null),\n      chats = _useState4[0],\n      setChats = _useState4[1];\n\n  var _useState5 = useState({}),\n      messages = _useState5[0],\n      setMessages = _useState5[1];\n\n  var _useState6 = useState({}),\n      sendingMessages = _useState6[0],\n      setSendingMessages = _useState6[1];\n\n  var _useState7 = useState(null),\n      activeChat = _useState7[0],\n      setActiveChat = _useState7[1];\n\n  var _useState8 = useState({}),\n      typingCounter = _useState8[0],\n      setTypingCounter = _useState8[1];\n\n  var _useState9 = useState(false),\n      loadMoreMessages = _useState9[0],\n      setLoadMoreMessages = _useState9[1];\n\n  var _useState10 = useState(false),\n      isBottomVisible = _useState10[0],\n      setIsBottomVisible = _useState10[1];\n\n  var value = {\n    connecting: connecting,\n    setConnecting: setConnecting,\n    conn: conn,\n    setConn: setConn,\n    creds: creds,\n    setCreds: setCreds,\n    chats: chats,\n    setChats: setChats,\n    messages: messages,\n    setMessages: setMessages,\n    sendingMessages: sendingMessages,\n    setSendingMessages: setSendingMessages,\n    activeChat: activeChat,\n    setActiveChat: setActiveChat,\n    typingCounter: typingCounter,\n    setTypingCounter: setTypingCounter,\n    loadMoreMessages: loadMoreMessages,\n    setLoadMoreMessages: setLoadMoreMessages,\n    isBottomVisible: isBottomVisible,\n    setIsBottomVisible: setIsBottomVisible\n  };\n  return /*#__PURE__*/React.createElement(ChatEngineContext.Provider, {\n    value: value\n  }, props.children);\n};\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n\n  _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nvar _this = undefined;\n\nvar Socket = function Socket(props) {\n  var _useState = useState(Date.now() + 10000),\n      reconnect = _useState[0];\n\n  var _useContext = useContext(ChatEngineContext),\n      setConnecting = _useContext.setConnecting,\n      conn = _useContext.conn,\n      setConn = _useContext.setConn,\n      setCreds = _useContext.setCreds,\n      chats = _useContext.chats,\n      setChats = _useContext.setChats,\n      messages = _useContext.messages,\n      setMessages = _useContext.setMessages,\n      sendingMessages = _useContext.sendingMessages,\n      setSendingMessages = _useContext.setSendingMessages,\n      activeChat = _useContext.activeChat,\n      setActiveChat = _useContext.setActiveChat,\n      typingCounter = _useContext.typingCounter,\n      setTypingCounter = _useContext.setTypingCounter;\n\n  function sortChats(chats) {\n    return Object.values(chats).sort(function (a, b) {\n      var aDate = a.last_message.created ? new Date(a.last_message.created) : new Date(a.created);\n      var bDate = b.last_message.created ? new Date(b.last_message.created) : new Date(b.created);\n      return new Date(bDate) - new Date(aDate);\n    });\n  }\n\n  function onEditChat(chat) {\n    if (chats) {\n      var newChats = _extends({}, chats);\n\n      newChats[chat.id] = chat;\n      setChats(newChats);\n    }\n\n    props.onEditChat && props.onEditChat(chat);\n  }\n\n  function onConnect(conn) {\n    setConn(conn);\n    setCreds(conn);\n    setConnecting(false);\n    getLatestChats$1(conn, 25, function (chats) {\n      return setChats(_.mapKeys(chats, 'id'));\n    });\n\n    if (Date.now() > reconnect) {\n      getLatestMessages$1(conn, activeChat, 45, function (id, list) {\n        setMessages(_extends({}, messages, _.mapKeys(list, 'id')));\n      });\n    }\n\n    props.onConnect && props.onConnect(conn);\n  }\n\n  function handleEvent(event) {\n    var eventJSON = JSON.parse(event);\n\n    if (eventJSON.action === 'login_error') {\n      console.log(\"Your login credentials were not correct: \\n\\n                Project ID: \" + props.projectID + \" \\n\\n                Username: \" + props.userName + \" \\n\\n                User Secret: \" + props.userSecret + \"\\n\\n                Double check these credentials to make sure they're correct.\\n\\n                If all three are correct, try resetting the username and secret in the Online Dashboard or Private API.\");\n      setConn(undefined);\n      setCreds(undefined);\n      props.onFailAuth && props.onFailAuth(conn);\n    } else if (eventJSON.action === 'new_chat') {\n      var chat = eventJSON.data;\n\n      if (chats) {\n        var newChats = _extends({}, chats);\n\n        newChats[chat.id] = chat;\n        setChats(newChats);\n        setActiveChat(chat.id);\n      }\n\n      props.onNewChat && props.onNewChat(eventJSON.data);\n    } else if (eventJSON.action === 'edit_chat') {\n      onEditChat(eventJSON.data);\n    } else if (eventJSON.action === 'delete_chat') {\n      var _chat = eventJSON.data;\n\n      if (chats) {\n        chats[_chat.id] = undefined;\n        setChats(chats);\n\n        if (!_.isEmpty(chats)) {\n          var sortedChats = sortChats(chats);\n          setActiveChat(sortedChats[0] ? parseInt(sortedChats[0].id) : 0);\n        }\n      }\n\n      props.onDeleteChat && props.onDeleteChat(_chat);\n    } else if (eventJSON.action === 'add_person') {\n      onEditChat(eventJSON.data);\n      props.onAddPerson && props.onAddPerson(eventJSON.data);\n    } else if (eventJSON.action === 'remove_person') {\n      onEditChat(eventJSON.data);\n      props.onRemovePerson && props.onRemovePerson(eventJSON.data);\n    } else if (eventJSON.action === 'new_message') {\n      var _eventJSON$data = eventJSON.data,\n          id = _eventJSON$data.id,\n          message = _eventJSON$data.message;\n\n      if (typeof message.custom_json === \"string\" && message.custom_json.indexOf('sender_id') !== -1) {\n        sendingMessages[JSON.parse(message.custom_json).sender_id] = undefined;\n        setSendingMessages(sendingMessages);\n      }\n\n      if (id === activeChat) {\n        var newMessages = _extends({}, messages);\n\n        newMessages[message.id] = message;\n        setMessages(newMessages);\n      }\n\n      if (message.sender_username !== props.userName) {\n        readMessage$1(conn, activeChat, message.id, function (chat) {\n          return onEditChat(chat);\n        });\n      }\n\n      props.onNewMessage && props.onNewMessage(id, message);\n    } else if (eventJSON.action === 'edit_message') {\n      var _eventJSON$data2 = eventJSON.data,\n          _id = _eventJSON$data2.id,\n          _message = _eventJSON$data2.message;\n\n      if (_id === activeChat) {\n        messages[_message.id] = _message;\n        setMessages(messages);\n      }\n\n      props.onEditMessage && props.onEditMessage(_id, _message);\n    } else if (eventJSON.action === 'delete_message') {\n      var _eventJSON$data3 = eventJSON.data,\n          _id2 = _eventJSON$data3.id,\n          _message2 = _eventJSON$data3.message;\n\n      if (_id2 === activeChat) {\n        messages[_message2.id] = undefined;\n        setMessages(messages);\n      }\n\n      props.onDeleteMessage && props.onDeleteMessage(_id2, _message2);\n    } else if (eventJSON.action === 'is_typing') {\n      var _extends2, _extends3;\n\n      var _eventJSON$data4 = eventJSON.data,\n          _id3 = _eventJSON$data4.id,\n          person = _eventJSON$data4.person;\n\n      var newTypingCounter = _extends({}, typingCounter);\n\n      newTypingCounter = _extends({}, newTypingCounter, (_extends3 = {}, _extends3[_id3] = _extends({}, newTypingCounter[_id3], (_extends2 = {}, _extends2[person] = Date.now(), _extends2)), _extends3));\n      setTypingCounter(newTypingCounter);\n      props.onTyping && props.onTyping(_id3, person);\n    }\n  }\n\n  function onClose() {\n    setConnecting(true);\n  }\n\n  var development = props.development,\n      publicKey = props.publicKey,\n      projectID = props.projectID,\n      userName = props.userName,\n      userPassword = props.userPassword,\n      userSecret = props.userSecret;\n  var wsStart = development ? 'ws://' : 'wss://';\n  var rootHost = development ? '127.0.0.1:8000' : 'api.chatengine.io';\n  var project = publicKey ? publicKey : projectID;\n  var secret = userPassword ? userPassword : userSecret;\n  return /*#__PURE__*/React.createElement(WebSocket, {\n    url: \"\" + wsStart + rootHost + \"/person/?publicKey=\" + project + \"&username=\" + userName + \"&secret=\" + secret,\n    onOpen: function onOpen() {\n      return onConnect(props);\n    },\n    onClose: onClose.bind(_this),\n    onMessage: handleEvent.bind(_this),\n    reconnectIntervalInMilliSeconds: 3000\n  });\n};\n\nfunction getApiUrl(props) {\n  if (props && props.development) {\n    return 'http://127.0.0.1:8000';\n  }\n\n  return 'https://api.chatengine.io';\n}\n\nfunction getHeaders(props) {\n  if (props.chatID) {\n    return {\n      \"public-key\": props.publicKey ? props.publicKey : props.projectID,\n      \"chat-id\": props.chatID,\n      \"access-key\": props.chatAccessKey\n    };\n  }\n\n  return {\n    \"Public-Key\": props.publicKey ? props.publicKey : props.projectID,\n    \"User-Name\": props.userName,\n    \"User-Secret\": props.userPassword ? props.userPassword : props.userSecret\n  };\n}\n\nfunction getChats(props, callback) {\n  axios.get(getApiUrl(props) + \"/chats/\", {\n    headers: getHeaders(props)\n  }).then(function (response) {\n    props.onGetChats && props.onGetChats(response.data);\n    callback && callback(response.data);\n  })[\"catch\"](function (error) {\n    console.log('Fetch Chats Error', error);\n  });\n}\n\nfunction newChat(props, data, callback) {\n  axios.post(getApiUrl(props) + \"/chats/\", data, {\n    headers: getHeaders(props)\n  }).then(function (response) {\n    callback && callback(response.data);\n  })[\"catch\"](function (error) {\n    console.log('New Chat Error', error);\n  });\n}\n\nfunction getLatestChats(props, count, callback) {\n  axios.get(getApiUrl(props) + \"/chats/latest/\" + count + \"/\", {\n    headers: getHeaders(props)\n  }).then(function (response) {\n    props.onGetChats && props.onGetChats(response.data);\n    callback && callback(response.data);\n  })[\"catch\"](function (error) {\n    console.log('Fetch Chats Error', error);\n  });\n}\n\nfunction getOrCreateChat(props, data, callback) {\n  axios.put(getApiUrl(props) + \"/chats/\", data, {\n    headers: getHeaders(props)\n  }).then(function (response) {\n    callback && callback(response.data);\n  })[\"catch\"](function (error) {\n    console.log('Get or Create Chat Error', error);\n  });\n}\n\nfunction getChat(props, chatId, callback) {\n  axios.get(getApiUrl(props) + \"/chats/\" + chatId + \"/\", {\n    headers: getHeaders(props)\n  }).then(function (response) {\n    callback && callback(response.data);\n  })[\"catch\"](function (error) {\n    console.log('Get Chat Error', error);\n  });\n}\n\nfunction editChat(props, chatId, data, callback) {\n  axios.patch(getApiUrl(props) + \"/chats/\" + chatId + \"/\", data, {\n    headers: getHeaders(props)\n  }).then(function (response) {\n    callback && callback(response.data);\n  })[\"catch\"](function (error) {\n    console.log('Edit Chat Error', error);\n  });\n}\n\nfunction deleteChat(props, chatId, callback) {\n  axios[\"delete\"](getApiUrl(props) + \"/chats/\" + chatId + \"/\", {\n    headers: getHeaders(props)\n  }).then(function (response) {\n    callback && callback(response.data);\n  })[\"catch\"](function (error) {\n    console.log('Delete Chat Error', error);\n  });\n}\n\nvar ChatLoader = function ChatLoader(props) {\n  function useOnScreen(ref) {\n    var _useState = useState(false),\n        isIntersecting = _useState[0],\n        setIntersecting = _useState[1];\n\n    var observer = new IntersectionObserver(function (_ref) {\n      var entry = _ref[0];\n      setIntersecting(entry.isIntersecting);\n\n      if (entry.isIntersecting) {\n        props.onVisible();\n      }\n    });\n    useEffect(function () {\n      observer.observe(ref.current);\n      return function () {\n        observer.disconnect();\n      };\n    }, []);\n    return isIntersecting;\n  }\n\n  var ref = useRef();\n  var isVisible = useOnScreen(ref);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    ref: ref\n  });\n};\n\nvar _this$1 = undefined;\n\nvar NewChatForm = function NewChatForm() {\n  var _useContext = useContext(ChatEngineContext),\n      conn = _useContext.conn;\n\n  var _useState = useState(''),\n      value = _useState[0],\n      setValue = _useState[1];\n\n  var _useState2 = useState(false),\n      selected = _useState2[0],\n      setSelected = _useState2[1];\n\n  function _handleChange(event) {\n    setValue(event.target.value);\n  }\n\n  function handleSubmit(event) {\n    event.preventDefault();\n\n    if (value.trim().length > 0) {\n      newChat$1(conn, {\n        title: value\n      }, function () {\n        return setSelected(false);\n      });\n    }\n\n    setValue('');\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: styles.newChatContainer,\n    className: \"ce-chat-form-container\"\n  }, selected ? /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleSubmit.bind(_this$1)\n  }, /*#__PURE__*/React.createElement(TextInput$1, {\n    autoFocus: true,\n    label: \"Chat Title\",\n    value: value,\n    id: \"ce-new-chat-title-field\",\n    onBlur: function onBlur() {\n      return setSelected(false);\n    },\n    style: {\n      width: '100%'\n    },\n    handleChange: function handleChange(e) {\n      return _handleChange(e);\n    }\n  })) : /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      height: '0px'\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      fontWeight: '600',\n      fontSize: '24px',\n      position: 'relative',\n      top: '4px',\n      width: ' calc(100% - 48px)'\n    }\n  }, \"My Chats\")), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: '100%',\n      textAlign: 'right'\n    }\n  }, /*#__PURE__*/React.createElement(Button$1, {\n    icon: \"plus\",\n    id: \"new-chat-plus-button\",\n    onClick: function onClick() {\n      return setSelected(true);\n    }\n  }))));\n};\n\nvar styles = {\n  newChatContainer: {\n    padding: '16px 14px',\n    backgroundColor: 'white'\n  }\n};\n\nfunction timeSinceDate(date) {\n  if (!date) return '';\n  var day = date.substr(8, 2);\n  var month = date.substr(5, 2);\n  var year = date.substr(0, 4);\n  var hour = date.substr(11, 2);\n  var minute = date.substr(14, 2);\n  var second = date.substr(17, 2);\n  var sent = new Date(month + \" \" + day + \" \" + year);\n  sent.setHours(hour);\n  sent.setMinutes(minute);\n  sent.setSeconds(second);\n  sent = sent.toString();\n  var dayStr = sent.substr(0, 10);\n  var timeStr = sent.substr(15, 6);\n  return dayStr + \" at \" + timeStr;\n}\n\nfunction daySinceSent(date) {\n  if (!date) return '';\n  var day = date.substr(8, 2);\n  var month = date.substr(5, 2);\n  var year = date.substr(0, 4);\n  var sent = new Date(month + \" \" + day + \" \" + year).toString();\n  return sent.substr(4, 6);\n}\n\nvar ChatCard = function ChatCard(props) {\n  var _useContext = useContext(ChatEngineContext),\n      conn = _useContext.conn,\n      activeChat = _useContext.activeChat,\n      setActiveChat = _useContext.setActiveChat;\n\n  if (!conn || conn === null) return /*#__PURE__*/React.createElement(\"div\", null);\n\n  function readLastMessage(chat) {\n    var readLastMessage = true;\n    chat.people.map(function (chat_person) {\n      if (conn.userName === chat_person.person.username) {\n        readLastMessage = chat.last_message.id === chat_person.last_read;\n      }\n    });\n    return readLastMessage;\n  }\n\n  var chat = props.chat;\n  var extraStyle = activeChat === chat.id ? styles$1.activeChat : {};\n  var otherPerson = chat.people.find(function (person) {\n    return person.person.username !== conn.userName;\n  });\n  var title = chat.is_direct_chat && otherPerson ? otherPerson.person.username : chat.title;\n  var lastMessage = chat.last_message.text;\n\n  if (!lastMessage) {\n    lastMessage = chat.last_message.attachments.length > 0 ? chat.last_message.attachments.length + \" image\" + (chat.last_message.attachments.length > 1 ? 's' : '') : 'Say hello!';\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    onClick: function onClick() {\n      return setActiveChat(chat.id);\n    },\n    style: _extends({}, styles$1.chatContainer, extraStyle),\n    className: \"ce-chat-card \" + (activeChat === chat.id && 'ce-active-chat-card')\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: styles$1.titleText,\n    className: \"ce-chat-title-text\",\n    id: \"ce-chat-card-title-\" + title\n  }, title, !readLastMessage(chat) && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ce-chat-unread-dot\",\n    style: {\n      \"float\": 'right',\n      width: '12px',\n      height: '12px',\n      borderRadius: '6px',\n      backgroundColor: '#1890ff',\n      display: 'inline-block'\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: '100%'\n    },\n    className: \"ce-chat-subtitle\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: styles$1.messageText,\n    className: \"ce-chat-subtitle-text ce-chat-subtitle-message\"\n  }, lastMessage), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ce-chat-subtitle-text ce-chat-subtitle-date\",\n    style: _extends({}, styles$1.messageText, {\n      textAlign: 'right',\n      width: '25%'\n    })\n  }, daySinceSent(chat.last_message.created))));\n};\n\nvar styles$1 = {\n  chatContainer: {\n    padding: '16px',\n    paddingBottom: '12px',\n    cursor: 'pointer'\n  },\n  titleText: {\n    fontWeight: '500',\n    paddingBottom: '4px',\n    whiteSpace: 'nowrap',\n    overflow: 'hidden'\n  },\n  messageText: {\n    width: '75%',\n    color: 'rgba(153, 153, 153, 1)',\n    fontSize: '14px',\n    whiteSpace: 'nowrap',\n    overflow: 'hidden',\n    display: 'inline-block'\n  },\n  activeChat: {\n    backgroundColor: '#d9d9d9',\n    border: '4px solid white',\n    borderRadius: '12px'\n  }\n};\nvar count = 25;\nvar interval = 25;\n\nvar ChatList = function ChatList(props) {\n  var didMountRef = useRef(false);\n\n  var _useState = useState(true),\n      hasMoreChats = _useState[0],\n      setHasMoreChats = _useState[1];\n\n  var _useContext = useContext(ChatEngineContext),\n      conn = _useContext.conn,\n      chats = _useContext.chats,\n      setChats = _useContext.setChats,\n      activeChat = _useContext.activeChat,\n      setActiveChat = _useContext.setActiveChat;\n\n  function renderChats(chats) {\n    return chats.map(function (chat, index) {\n      if (!chat) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          key: \"chat_\" + index\n        });\n      } else if (props.renderChatCard) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          key: \"chat_\" + index\n        }, props.renderChatCard(chat, index));\n      } else {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          key: \"chat_\" + index,\n          onClick: function onClick() {\n            return props.onChatClick && props.onChatClick();\n          }\n        }, /*#__PURE__*/React.createElement(ChatCard, {\n          chat: chat\n        }));\n      }\n    });\n  }\n\n  function sortChats(chats) {\n    return chats.sort(function (a, b) {\n      var aDate = a.last_message.created ? new Date(a.last_message.created) : new Date(a.created);\n      var bDate = b.last_message.created ? new Date(b.last_message.created) : new Date(b.created);\n      return new Date(bDate) - new Date(aDate);\n    });\n  }\n\n  function onGetChats(chats, count) {\n    var chatList = sortChats(chats);\n\n    if (chatList.length > 0 && activeChat === null) {\n      setActiveChat(chatList[0].id);\n    }\n\n    if (count && count > chatList.length) {\n      setHasMoreChats(false);\n    }\n\n    var newChats = _extends({}, chats);\n\n    setChats(_$1.mapKeys(newChats, 'id'));\n  }\n\n  useEffect(function () {\n    if (!didMountRef.current) {\n      didMountRef.current = true;\n      getLatestChats(props, interval, function (chats) {\n        return onGetChats(chats);\n      });\n    }\n  });\n\n  function loadChats() {\n    count = count + interval;\n    getLatestChats(props, count, function (chats) {\n      return onGetChats(chats, count);\n    });\n  }\n\n  var chatList = sortChats(chats ? Object.values(chats) : []);\n  if (props.renderChatList) return props.renderChatList(props);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: styles$2.chatListContainer,\n    className: \"ce-chat-list\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: styles$2.chatsContainer,\n    className: \"ce-chats-container\"\n  }, props.renderNewChatForm ? props.renderNewChatForm(conn) : /*#__PURE__*/React.createElement(NewChatForm, null), renderChats(chatList), hasMoreChats && chatList.length > 0 && /*#__PURE__*/React.createElement(ChatLoader, {\n    onVisible: function onVisible() {\n      return loadChats();\n    }\n  })));\n};\n\nvar styles$2 = {\n  chatListContainer: {\n    height: '100%',\n    maxHeight: '100vh',\n    overflow: 'scroll',\n    overflowX: 'hidden',\n    borderRight: '1px solid #afafaf',\n    backgroundColor: 'white',\n    fontFamily: 'Avenir'\n  },\n  chatsContainer: {\n    width: '100%',\n    height: '100%',\n    backgroundColor: 'white',\n    borderRadius: '0px 0px 24px 24px'\n  }\n};\n\nfunction getMessages(props, chatId, callback) {\n  axios.get(getApiUrl(props) + \"/chats/\" + chatId + \"/messages/\", {\n    headers: getHeaders(props)\n  }).then(function (response) {\n    props.onGetMessages && props.onGetMessages(chatId, response.data);\n    callback && callback(chatId, response.data);\n  })[\"catch\"](function (error) {\n    console.log('Fetch Messages Error', error);\n  });\n}\n\nfunction getLatestMessages(props, chatId, count, callback) {\n  axios.get(getApiUrl(props) + \"/chats/\" + chatId + \"/messages/latest/\" + count + \"/\", {\n    headers: getHeaders(props)\n  }).then(function (response) {\n    props.onGetMessages && props.onGetMessages(chatId, response.data);\n    callback && callback(chatId, response.data);\n  })[\"catch\"](function (error) {\n    console.log('Fetch Latest Messages Error', error);\n  });\n}\n\nfunction sendMessage(props, chatId, data, callback) {\n  var formdata = new FormData();\n\n  if (data.attachments) {\n    for (var i = 0; i < data.attachments.length; i++) {\n      formdata.append('attachments', data.attachments[i], data.attachments[i].name);\n    }\n  } else if (data.files) {\n    for (var _i = 0; _i < data.files.length; _i++) {\n      formdata.append('attachments', data.files[_i], data.files[_i].name);\n    }\n  }\n\n  formdata.append('text', data.text);\n  formdata.append('sender_username', data.sender_username);\n  formdata.append('custom_json', JSON.stringify(data.custom_json ? data.custom_json : {}));\n  axios.post(getApiUrl(props) + \"/chats/\" + chatId + \"/messages/\", formdata, {\n    headers: getHeaders(props)\n  }).then(function (response) {\n    callback && callback(response.data);\n  })[\"catch\"](function (error) {\n    console.log('Send Messages Error', error);\n  });\n}\n\nfunction getMessage(props, chatId, messageId, callback) {\n  axios.get(getApiUrl(props) + \"/chats/\" + chatId + \"/messages/\" + messageId + \"/\", {\n    headers: getHeaders(props)\n  }).then(function (response) {\n    callback && callback(chatId, response.data);\n  })[\"catch\"](function (error) {\n    console.log('Fetch Message Error', error);\n  });\n}\n\nfunction editMessage(props, chatId, messageId, data, callback) {\n  axios.patch(getApiUrl(props) + \"/chats/\" + chatId + \"/messages/\" + messageId + \"/\", data, {\n    headers: getHeaders(props)\n  }).then(function (response) {\n    callback && callback(response.data);\n  })[\"catch\"](function (error) {\n    console.log('Delete Messages Error', error);\n  });\n}\n\nfunction readMessage(props, chatId, messageId, callback) {\n  axios.patch(getApiUrl(props) + \"/chats/\" + chatId + \"/people/\", {\n    last_read: messageId\n  }, {\n    headers: getHeaders(props)\n  }).then(function (response) {\n    callback && callback(response.data);\n  })[\"catch\"](function (error) {\n    console.log('Read Message Error', error);\n  });\n}\n\nfunction deleteMessage(props, chatId, messageId, callback) {\n  axios[\"delete\"](getApiUrl(props) + \"/chats/\" + chatId + \"/messages/\" + messageId + \"/\", {\n    headers: getHeaders(props)\n  }).then(function (response) {\n    callback && callback(response.data);\n  })[\"catch\"](function (error) {\n    console.log('Delete Messages Error', error);\n  });\n}\n\nvar AuthFail = function AuthFail() {\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      height: '100%',\n      textAlign: 'center'\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: '100%'\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    style: {\n      width: '40%',\n      paddingTop: '25vh'\n    },\n    src: \"https://chat-engine-assets.s3.amazonaws.com/denied.svg\",\n    alt: \"welcome-to-chat-engine\"\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      fontSize: '18px',\n      paddingTop: '24px',\n      width: '75%',\n      paddingLeft: '12.5%'\n    }\n  }, \"Your credentials are incorrect. Make sure your Public Key, Username, and Password are correct at \", /*#__PURE__*/React.createElement(\"a\", {\n    href: \"https://chatengine.io\"\n  }, \"chatengine.io\")));\n};\n\nvar Welcome = function Welcome() {\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      height: '100%',\n      textAlign: 'center'\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: '100%'\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    style: {\n      width: '60%',\n      paddingTop: '33vh'\n    },\n    src: \"https://chat-engine-assets.s3.amazonaws.com/welcome.svg\",\n    alt: \"welcome-to-chat-engine\"\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      fontSize: '18px',\n      paddingTop: '24px',\n      width: '75%',\n      paddingLeft: '12.5%'\n    }\n  }, \"Fill out the \\\"New Chat\\\" form to get started.\"));\n};\n\nvar ConnectionBar = function ConnectionBar() {\n  var _useContext = useContext(ChatEngineContext),\n      connecting = _useContext.connecting;\n\n  if (!connecting) return /*#__PURE__*/React.createElement(\"div\", null);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      zIndex: '1',\n      bottom: '66px',\n      left: 'calc(50% - 78px)',\n      position: 'absolute',\n      fontSize: '15px',\n      padding: '10px 22px',\n      color: 'white',\n      backgroundColor: '#fa8c16',\n      borderRadius: '1.3em'\n    },\n    id: \"ce-connecting-popup\"\n  }, /*#__PURE__*/React.createElement(SyncOutlined, {\n    spin: true\n  }), ' ', \"Connecting\");\n};\n\nvar ChatListDrawer = function ChatListDrawer(props) {\n  var _useState = useState(false),\n      isOpen = _useState[0],\n      setIsOpen = _useState[1];\n\n  return /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(MenuOutlined, {\n    onClick: function onClick() {\n      return setIsOpen(true);\n    },\n    style: {\n      color: 'rgb(24, 144, 255)',\n      outline: 'none'\n    }\n  }), isOpen && /*#__PURE__*/React.createElement(\"div\", {\n    style: styles$3.drawerContainer\n  }, /*#__PURE__*/React.createElement(CloseOutlined, {\n    style: styles$3.closeIcon,\n    onClick: function onClick() {\n      return setIsOpen(false);\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    style: styles$3.titleContainer\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: styles$3.titleText\n  }, \"My Chats\")), /*#__PURE__*/React.createElement(ChatList, _extends({}, props, {\n    onChatClick: function onChatClick() {\n      return setIsOpen(false);\n    }\n  }))));\n};\n\nvar styles$3 = {\n  drawerContainer: {\n    position: 'fixed',\n    zIndex: '1',\n    top: '0px',\n    left: '0px',\n    width: '100%',\n    height: '100%',\n    backgroundColor: 'white',\n    textAlign: 'left'\n  },\n  closeIcon: {\n    position: 'absolute',\n    left: '28px',\n    top: '32px'\n  },\n  titleContainer: {\n    width: '100%',\n    padding: '24px 0px',\n    textAlign: 'center',\n    color: 'rgb(24, 144, 255)'\n  },\n  titleText: {\n    fontSize: '24px',\n    fontWeight: '600'\n  }\n};\n\nvar Person = function Person(props) {\n  var _useState = useState(false),\n      selected = _useState[0],\n      setSelected = _useState[1];\n\n  var person = props.person,\n      chat = props.chat,\n      conn = props.conn;\n\n  if (!person || !chat) {\n    return /*#__PURE__*/React.createElement(\"div\", null);\n  }\n\n  if (!conn || conn === null) return /*#__PURE__*/React.createElement(\"div\", null);\n\n  function onRemovePerson() {\n    removePerson$1(props.conn, props.chat.id, props.person.username);\n  }\n\n  function renderPersonText(person) {\n    if (person.first_name && person.first_name !== null) {\n      return \"\" + person.first_name + (person.last_name ? \" \" + person.last_name : '');\n    } else {\n      return person.username;\n    }\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ce-person-container\",\n    onMouseEnter: function onMouseEnter() {\n      return setSelected(true);\n    },\n    onMouseLeave: function onMouseLeave() {\n      return setSelected(false);\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ce-person-avatar\",\n    style: {\n      padding: '2px',\n      height: '0px'\n    }\n  }, /*#__PURE__*/React.createElement(Avatar$1, {\n    avatar: person.avatar,\n    username: person.username,\n    is_online: person.is_online\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ce-person-text\",\n    style: {\n      paddingLeft: '52px',\n      height: '44px',\n      position: 'relative',\n      top: '10px',\n      fontSize: '15px'\n    }\n  }, renderPersonText(person)), selected && conn.userName === chat.admin.username && person.username !== chat.admin.username && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ce-delete-chat\",\n    style: {\n      \"float\": 'right',\n      height: '0px',\n      position: 'relative',\n      bottom: '44px'\n    }\n  }, /*#__PURE__*/React.createElement(Button$1, {\n    theme: \"danger\",\n    icon: \"delete\",\n    onClick: function onClick() {\n      return onRemovePerson();\n    }\n  })));\n};\n\nvar Option = function Option(props) {\n  var _useState = useState(false),\n      focused = _useState[0],\n      setFocused = _useState[1];\n\n  var _props$person = props.person,\n      avatar = _props$person.avatar,\n      username = _props$person.username;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    id: \"ce-username-option-\" + username,\n    onMouseEnter: function onMouseEnter() {\n      return setFocused(true);\n    },\n    onMouseLeave: function onMouseLeave() {\n      return setFocused(false);\n    },\n    onClick: function onClick() {\n      return props.onClick && props.onClick();\n    },\n    style: _extends({}, styles$4.option, {\n      backgroundColor: focused ? '#f5f5f5' : 'white'\n    })\n  }, /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(Avatar$1, {\n    username: username,\n    avatar: avatar\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      padding: '12px 4px'\n    }\n  }, props.person.username));\n};\n\nvar styles$4 = {\n  option: {\n    padding: '4px 16px',\n    cursor: 'pointer',\n    fontSize: '15px',\n    display: 'flex'\n  }\n};\n\nvar PersonForm = function PersonForm(props) {\n  var _useState = useState({\n    value: '',\n    others: []\n  }),\n      state = _useState[0],\n      setState = _useState[1];\n\n  function _handleChange(value) {\n    setState(_extends({}, state, {\n      value: value\n    }));\n  }\n\n  function invitePerson(name) {\n    addPerson$1(props.conn, props.chat.id, name, function () {\n      setState(_extends({}, state, {\n        value: ''\n      }));\n      getOthers();\n    });\n  }\n\n  function getOthers() {\n    getOtherPeople$1(props.conn, props.chat.id, function (id, others) {\n      return setState(_extends({}, state, {\n        others: others\n      }));\n    }, function () {});\n  }\n\n  function _renderOption(option) {\n    return /*#__PURE__*/React.createElement(Option, {\n      person: option,\n      onClick: function onClick() {\n        return invitePerson(option.username);\n      }\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      marginBottom: '12px'\n    }\n  }, /*#__PURE__*/React.createElement(AutoCompleteInput, {\n    style: {\n      width: '100%'\n    },\n    label: \"Type a username\",\n    value: state.value,\n    options: state.others,\n    onFocus: function onFocus() {\n      return getOthers();\n    },\n    handleChange: function handleChange(value) {\n      return _handleChange(value);\n    },\n    renderOption: function renderOption(option) {\n      return _renderOption(option);\n    }\n  }));\n};\n\nvar PeopleSettings = function PeopleSettings(props) {\n  var _useState = useState({\n    collapsed: false,\n    hovered: false\n  }),\n      state = _useState[0],\n      setState = _useState[1];\n\n  var chat = props.chat;\n\n  if (chat.is_direct_chat) {\n    return /*#__PURE__*/React.createElement(\"div\", null);\n  }\n\n  function renderChatPeople(people, chat) {\n    return people.map(function (chatPerson, index) {\n      return /*#__PURE__*/React.createElement(Person, {\n        key: \"person_\" + index,\n        person: chatPerson.person,\n        conn: props,\n        chat: chat\n      });\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      borderTop: '1px solid #f0f0f0'\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    onMouseEnter: function onMouseEnter() {\n      return setState(_extends({}, state, {\n        hovered: true\n      }));\n    },\n    onMouseLeave: function onMouseLeave() {\n      return setState(_extends({}, state, {\n        hovered: false\n      }));\n    },\n    onClick: function onClick() {\n      return setState(_extends({}, state, {\n        collapsed: !state.collapsed\n      }));\n    },\n    style: state.hovered ? {\n      backgroundColor: '#f0f0f0',\n      cursor: 'pointer'\n    } : {},\n    className: \"ce-section-title-container ce-person-title-container\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ce-section-title ce-people-title\",\n    style: {\n      fontSize: '17px',\n      padding: '12px',\n      fontWeight: '600'\n    }\n  }, \"People\"), state.collapsed ? /*#__PURE__*/React.createElement(LeftOutlined, {\n    style: styles$5.collapseIcon\n  }) : /*#__PURE__*/React.createElement(DownOutlined, {\n    style: styles$5.collapseIcon\n  })), !state.collapsed && /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      height: '12px'\n    }\n  }), renderChatPeople(chat.people, chat), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      height: '12px'\n    }\n  }), props && chat && props.userName === chat.admin.username && /*#__PURE__*/React.createElement(PersonForm, {\n    conn: props,\n    chat: chat\n  })));\n};\n\nvar styles$5 = {\n  collapseIcon: {\n    \"float\": 'right',\n    position: 'relative',\n    bottom: '30px',\n    right: '12px'\n  }\n};\n\nvar Thumbnail = function Thumbnail(props) {\n  var attachment = props.attachment;\n\n  if (!attachment) {\n    return /*#__PURE__*/React.createElement(\"div\", null);\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: styles$6.container,\n    className: \"ce-photo-thumbnail\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      paddingTop: '100%'\n    }\n  }), /*#__PURE__*/React.createElement(\"img\", {\n    alt: attachment.id,\n    style: styles$6.image,\n    src: attachment.file,\n    className: \"ce-photo-img\",\n    id: \"image-\" + attachment.id\n  }));\n};\n\nvar styles$6 = {\n  container: {\n    position: 'relative',\n    width: 'calc(33% - 8px)',\n    border: '1px solid white',\n    display: 'inline-block',\n    cursor: 'pointer'\n  },\n  image: {\n    top: '0px',\n    width: '100%',\n    height: '100%',\n    position: 'absolute',\n    objectFit: 'cover'\n  }\n};\n\nvar PhotosSettings = function PhotosSettings(props) {\n  var _useState = useState({\n    collapsed: true,\n    hovered: false\n  }),\n      state = _useState[0],\n      setState = _useState[1];\n\n  var chat = props.chat;\n\n  function renderPhotos(attachments) {\n    return attachments.map(function (attachment, index) {\n      return /*#__PURE__*/React.createElement(Thumbnail, {\n        key: \"person_\" + index,\n        attachment: attachment\n      });\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      borderTop: '1px solid #f0f0f0'\n    },\n    className: \"ce-photo-section\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    onMouseEnter: function onMouseEnter() {\n      return setState(_extends({}, state, {\n        hovered: true\n      }));\n    },\n    onMouseLeave: function onMouseLeave() {\n      return setState(_extends({}, state, {\n        hovered: false\n      }));\n    },\n    onClick: function onClick() {\n      return setState(_extends({}, state, {\n        collapsed: !state.collapsed\n      }));\n    },\n    style: state.hovered ? {\n      backgroundColor: '#f0f0f0',\n      cursor: 'pointer'\n    } : {},\n    className: \"ce-section-title-container ce-photo-title-container\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ce-section-title ce-photo-title\",\n    style: {\n      fontSize: '17px',\n      padding: '12px',\n      fontWeight: '600'\n    }\n  }, \"Photos\"), state.collapsed ? /*#__PURE__*/React.createElement(LeftOutlined, {\n    style: styles$7.collapseIcon\n  }) : /*#__PURE__*/React.createElement(DownOutlined, {\n    style: styles$7.collapseIcon\n  })), !state.collapsed && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ce-photo-feed\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      height: '12px'\n    }\n  }), renderPhotos(chat.attachments)));\n};\n\nvar styles$7 = {\n  collapseIcon: {\n    \"float\": 'right',\n    position: 'relative',\n    bottom: '30px',\n    right: '12px'\n  }\n};\n\nvar OptionsSettings = function OptionsSettings(props) {\n  var _useState = useState({\n    collapsed: true,\n    hovered: false\n  }),\n      state = _useState[0],\n      setState = _useState[1];\n\n  var chat = props.chat;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      borderTop: '1px solid #f0f0f0'\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"ce-options-drop-down\",\n    onMouseEnter: function onMouseEnter() {\n      return setState(_extends({}, state, {\n        hovered: true\n      }));\n    },\n    onMouseLeave: function onMouseLeave() {\n      return setState(_extends({}, state, {\n        hovered: false\n      }));\n    },\n    onClick: function onClick() {\n      return setState(_extends({}, state, {\n        collapsed: !state.collapsed\n      }));\n    },\n    style: state.hovered ? {\n      backgroundColor: '#f0f0f0',\n      cursor: 'pointer'\n    } : {}\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      fontSize: '17px',\n      padding: '12px',\n      fontWeight: '600'\n    }\n  }, \"Options\"), state.collapsed ? /*#__PURE__*/React.createElement(LeftOutlined, {\n    style: styles$8.collapseIcon\n  }) : /*#__PURE__*/React.createElement(DownOutlined, {\n    style: styles$8.collapseIcon\n  })), !state.collapsed && /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      height: '12px'\n    }\n  }), /*#__PURE__*/React.createElement(Button$1, {\n    value: \"Delete\",\n    theme: \"danger\",\n    icon: \"delete\",\n    id: \"ce-delete-chat-button\",\n    onClick: function onClick() {\n      return deleteChat$1(props, chat.id, function (data) {});\n    },\n    style: {\n      width: '100%',\n      marginBottom: '12px'\n    }\n  })));\n};\n\nvar styles$8 = {\n  collapseIcon: {\n    \"float\": 'right',\n    position: 'relative',\n    bottom: '30px',\n    right: '12px'\n  }\n};\n\nvar NewMessageForm = function NewMessageForm(props) {\n  var didMountRef = useRef(false);\n\n  var _useState = useState({\n    activeChat: null,\n    value: ''\n  }),\n      state = _useState[0],\n      setState = _useState[1];\n\n  function _handleChange(event) {\n    setState(_extends({}, state, {\n      value: event.target.value\n    }));\n  }\n\n  function handleSubmit(event) {\n    event.preventDefault();\n    editChat$1(props.conn, props.chat.id, {\n      title: state.value\n    }, function (data) {});\n  }\n\n  useEffect(function () {\n    if (!didMountRef.current) {\n      didMountRef.current = true;\n    } else {\n      if (state.activeChat !== props.chat.id) {\n        setState(_extends({}, state, {\n          value: props.chat.title,\n          activeChat: props.chat.id\n        }));\n      }\n    }\n  });\n  return /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: function onSubmit(e) {\n      return handleSubmit(e);\n    },\n    className: \"ce-chat-title-form\"\n  }, /*#__PURE__*/React.createElement(TextInput$1, {\n    label: \"Rename this Chat\",\n    value: state.value,\n    \"default\": props.chat.title,\n    handleChange: function handleChange(e) {\n      return _handleChange(e);\n    },\n    style: {\n      fontSize: '16px',\n      fontWeight: '600',\n      textAlign: 'center',\n      border: '0px solid white',\n      width: '100%'\n    }\n  }));\n};\n\nvar ChatSettingsTop = function ChatSettingsTop(props) {\n  var _useContext = useContext(ChatEngineContext),\n      conn = _useContext.conn;\n\n  var chat = props.chat;\n  if (!conn || conn === null) return /*#__PURE__*/React.createElement(\"div\", null);\n  var topPeople = chat.people.slice(0, 3);\n  var otherPerson = getOtherPerson(chat.people);\n\n  function renderOnePerson(people) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        width: '100%',\n        paddingTop: '14px'\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        \"float\": 'left',\n        position: 'relative',\n        left: 'calc(50% - 22px)'\n      }\n    }, /*#__PURE__*/React.createElement(Avatar$1, {\n      show_online: false,\n      username: people[0].person.username,\n      avatar: people[0].person.avatar\n    })));\n  }\n\n  function renderTwoPeople(people) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        width: '100%',\n        paddingTop: '14px'\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        \"float\": 'left',\n        position: 'relative',\n        left: 'calc(50% - 22px - 15px)'\n      }\n    }, /*#__PURE__*/React.createElement(Avatar$1, {\n      show_online: false,\n      username: people[0].person.username,\n      avatar: people[0].person.avatar\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        \"float\": 'left',\n        position: 'relative',\n        left: 'calc(50% - 44px - 22px + 15px)'\n      }\n    }, /*#__PURE__*/React.createElement(Avatar$1, {\n      show_online: false,\n      username: people[1].person.username,\n      avatar: people[1].person.avatar\n    })));\n  }\n\n  function renderThreePeople(people) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        width: '100%',\n        paddingTop: '14px'\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        \"float\": 'left',\n        position: 'relative',\n        left: 'calc(50% - 22px - 24px)'\n      }\n    }, /*#__PURE__*/React.createElement(Avatar$1, {\n      show_online: false,\n      username: people[0].person.username,\n      avatar: people[0].person.avatar\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        \"float\": 'left',\n        position: 'relative',\n        left: 'calc(50% - 24px - 44px)'\n      }\n    }, /*#__PURE__*/React.createElement(Avatar$1, {\n      show_online: false,\n      username: people[1].person.username,\n      avatar: people[1].person.avatar\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        \"float\": 'left',\n        position: 'relative',\n        left: 'calc(50% - 22px - 44px - 44px + 24px)'\n      }\n    }, /*#__PURE__*/React.createElement(Avatar$1, {\n      show_online: false,\n      username: people[2].person.username,\n      avatar: people[2].person.avatar\n    })));\n  }\n\n  function getOtherPerson(people) {\n    return people.find(function (person) {\n      return person.person.username !== conn.userName;\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ce-chat-settings-container\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ce-chat-avatars-row\"\n  }, topPeople.length === 1 && renderOnePerson(topPeople), chat.is_direct_chat && otherPerson && renderOnePerson([otherPerson]), !chat.is_direct_chat && otherPerson && topPeople.length === 2 && renderTwoPeople(topPeople), !chat.is_direct_chat && otherPerson && topPeople.length === 3 && renderThreePeople(topPeople)), chat.is_direct_chat && otherPerson ? /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      paddingTop: '55px',\n      paddingBottom: '7px',\n      fontSize: '16px',\n      fontWeight: '600',\n      textAlign: 'center',\n      border: '0px solid white',\n      width: '100%'\n    }\n  }, otherPerson.person.username) : /*#__PURE__*/React.createElement(NewMessageForm, {\n    chat: chat,\n    conn: conn\n  }));\n};\n\nvar ChatSettings = function ChatSettings(props) {\n  var _useContext = useContext(ChatEngineContext),\n      conn = _useContext.conn,\n      chats = _useContext.chats,\n      activeChat = _useContext.activeChat;\n\n  var chat = chats && chats[activeChat];\n  if (props.renderChatSettings) return props.renderChatSettings(props);\n  if (!chat) return /*#__PURE__*/React.createElement(\"div\", {\n    style: styles$9.filler\n  });\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: styles$9.settingsContainer,\n    className: \"ce-settings\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: '90%',\n      paddingLeft: '5%'\n    },\n    className: \"ce-settings-container\"\n  }, props.renderChatSettingsTop ? props.renderChatSettingsTop(conn, chat) : /*#__PURE__*/React.createElement(ChatSettingsTop, _extends({}, props, {\n    chat: chat\n  })), props.renderPeopleSettings ? props.renderPeopleSettings(conn, chat) : /*#__PURE__*/React.createElement(PeopleSettings, _extends({}, props, {\n    chat: chat\n  })), props.renderPhotosSettings ? props.renderPhotosSettings(chat) : /*#__PURE__*/React.createElement(PhotosSettings, _extends({}, props, {\n    chat: chat\n  })), props && chat && props.userName === chat.admin.username && /*#__PURE__*/React.createElement(\"div\", null, props.renderOptionsSettings ? props.renderOptionsSettings(conn, chat) : /*#__PURE__*/React.createElement(OptionsSettings, _extends({}, props, {\n    chat: chat\n  })))));\n};\n\nvar styles$9 = {\n  settingsContainer: {\n    height: '100%',\n    overflow: 'scroll',\n    overflowX: 'hidden',\n    borderLeft: '1px solid #afafaf',\n    backgroundColor: 'white',\n    fontFamily: 'Avenir'\n  },\n  filler: {\n    display: 'flex',\n    width: '90%',\n    paddingLeft: '5%',\n    borderLeft: '1px solid #afafaf'\n  }\n};\n\nvar ChatSettingsDrawer = function ChatSettingsDrawer(props) {\n  var _useState = useState(false),\n      isOpen = _useState[0],\n      setIsOpen = _useState[1];\n\n  return /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(SettingOutlined, {\n    onClick: function onClick() {\n      return setIsOpen(true);\n    },\n    style: {\n      color: 'rgb(24, 144, 255)',\n      outline: 'none'\n    }\n  }), isOpen && /*#__PURE__*/React.createElement(\"div\", {\n    style: styles$a.drawerContainer\n  }, /*#__PURE__*/React.createElement(CloseOutlined, {\n    style: styles$a.closeIcon,\n    onClick: function onClick() {\n      return setIsOpen(false);\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    style: styles$a.titleContainer\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: styles$a.titleText\n  }, \"Chat Settings\")), /*#__PURE__*/React.createElement(ChatSettings, props)));\n};\n\nvar styles$a = {\n  drawerContainer: {\n    position: 'fixed',\n    zIndex: '1',\n    top: '0px',\n    left: '0px',\n    width: '100%',\n    height: '100%',\n    backgroundColor: 'white',\n    textAlign: 'left'\n  },\n  closeIcon: {\n    position: 'absolute',\n    left: '28px',\n    top: '32px'\n  },\n  titleContainer: {\n    width: '100%',\n    padding: '24px 0px',\n    textAlign: 'center',\n    color: 'rgb(24, 144, 255)'\n  },\n  titleText: {\n    fontSize: '24px',\n    fontWeight: '600'\n  }\n};\nsetConfiguration({\n  maxScreenClass: 'xl',\n  gutterWidth: 0\n});\n\nvar ChatHeader = function ChatHeader() {\n  var _useContext = useContext(ChatEngineContext),\n      conn = _useContext.conn,\n      chats = _useContext.chats,\n      activeChat = _useContext.activeChat;\n\n  if (!chats || !activeChat || !chats[activeChat]) {\n    return /*#__PURE__*/React.createElement(\"div\", null);\n  }\n\n  if (!conn || conn === null) {\n    return /*#__PURE__*/React.createElement(\"div\", null);\n  }\n\n  var chat = chats[activeChat];\n  var otherPerson = chat.people.find(function (person) {\n    return person.person.username !== conn.userName;\n  });\n  var title = chat.is_direct_chat && otherPerson ? otherPerson.person.username : chat.title;\n  return /*#__PURE__*/React.createElement(Row, {\n    className: \"ce-chat-title\",\n    style: styles$b.titleSection\n  }, /*#__PURE__*/React.createElement(Col, {\n    xs: 2,\n    sm: 0,\n    style: _extends({}, styles$b.mobileOptiom, {\n      left: '6px'\n    }),\n    className: \"ce-chat-list-mobile-option\"\n  }, /*#__PURE__*/React.createElement(ChatListDrawer, null)), /*#__PURE__*/React.createElement(Col, {\n    xs: 8,\n    sm: 12,\n    style: styles$b.titleContainer,\n    className: \"ce-chat-title-container\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: styles$b.titleText,\n    className: \"ce-chat-title-text\",\n    id: \"ce-chat-feed-title-\" + title\n  }, title), /*#__PURE__*/React.createElement(\"div\", {\n    style: styles$b.subtitleText,\n    className: \"ce-chat-subtitle-text\"\n  }, chat.last_message.created && chat.last_message.created.length > 0 ? \"Active \" + timeSinceDate(chat.last_message.created) : 'Say hello!')), /*#__PURE__*/React.createElement(Col, {\n    xs: 2,\n    sm: 0,\n    style: _extends({}, styles$b.mobileOptiom, {\n      right: '6px'\n    }),\n    className: \"ce-chat-settings-mobile-option\"\n  }, /*#__PURE__*/React.createElement(ChatSettingsDrawer, null)));\n};\n\nvar styles$b = {\n  titleSection: {\n    position: 'absolute',\n    top: '0px',\n    width: '100%',\n    zIndex: '1',\n    backgroundColor: 'rgb(256, 256, 256, 0.92)',\n    fontFamily: 'Avenir'\n  },\n  mobileOptiom: {\n    width: '100%',\n    top: '32px',\n    textAlign: 'center',\n    color: 'rgb(24, 144, 255)',\n    overflow: 'hidden'\n  },\n  titleContainer: {\n    width: '100%',\n    padding: '18px 0px',\n    textAlign: 'center',\n    color: 'rgb(24, 144, 255)'\n  },\n  titleText: {\n    fontSize: '24px',\n    fontWeight: '600'\n  },\n  subtitleText: {\n    fontSize: '12px'\n  }\n};\n\nvar RenderTrigger = function RenderTrigger(props) {\n  var _useContext = useContext(ChatEngineContext);\n\n  function useOnScreen(ref) {\n    var _useState = useState(false),\n        isIntersecting = _useState[0],\n        setIntersecting = _useState[1];\n\n    var observer = new IntersectionObserver(function (_ref) {\n      var entry = _ref[0];\n      setIntersecting(entry.isIntersecting);\n\n      if (entry.isIntersecting) {\n        props.onEnter && props.onEnter();\n      } else {\n        props.onLeave && props.onLeave();\n      }\n    });\n    useEffect(function () {\n      observer.observe(ref.current);\n      return function () {\n        observer.disconnect();\n      };\n    }, []);\n    return isIntersecting;\n  }\n\n  var ref = useRef();\n  var isVisible = useOnScreen(ref);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    ref: ref\n  });\n};\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\nvar suffix = ['st', 'nd', 'rd', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'st', 'nd', 'rd', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'st'];\n\nvar DatePartition = function DatePartition(props) {\n  function getDate(date) {\n    return date ? date.substr(0, 10) : null;\n  }\n\n  function formatDate(date_time) {\n    if (!date_time) return '';\n    var year = date_time.substr(0, 4);\n    var month = months[parseInt(date_time.substr(5, 2)) - 1];\n    var day = date_time.substr(8, 2);\n    var dayDuffix = suffix[parseInt(date_time.substr(8, 2)) - 1];\n    var time = date_time.substr(11, 5);\n    var timeSuffix = '';\n\n    if (parseInt(time.substr(0, 2)) >= 12) {\n      if (parseInt(time.substr(0, 2)) > 12) {\n        time = String(parseInt(time.substr(0, 2)) - 12) + ':' + time.substr(3, 2);\n      }\n\n      timeSuffix = 'PM';\n    } else {\n      timeSuffix = 'AM';\n    }\n\n    return time + timeSuffix + ', ' + month + ' ' + day + dayDuffix + ', ' + year;\n  }\n\n  var lastCreated = props.lastCreated,\n      created = props.created;\n  var lastDate = getDate(lastCreated);\n  var thisDate = getDate(created);\n\n  if (lastCreated && lastDate === thisDate) {\n    return /*#__PURE__*/React.createElement(\"div\", null);\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: styles$c.dateText,\n    className: \"ce-message-date-text\"\n  }, formatDate(created));\n};\n\nvar styles$c = {\n  dateText: {\n    width: '100%',\n    textAlign: 'center',\n    paddingTop: '4px',\n    paddingBottom: '10px',\n    fontSize: '15px',\n    color: 'rgba(0, 0, 0, .40)'\n  }\n};\n\nvar _loadingContainer, _thumbnail;\n\nvar Thumbnail$1 = function Thumbnail(props) {\n  var _useState = useState(false),\n      hovered = _useState[0],\n      setHovered = _useState[1];\n\n  var attachment = props.attachment;\n\n  var style = _extends({}, styles$d.thumbnail, {\n    border: hovered ? '1px solid #1890ff' : '0px'\n  });\n\n  if (!attachment) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      style: styles$d.loadingContainer\n    }, /*#__PURE__*/React.createElement(LoadingOutlined, {\n      style: {\n        color: 'white',\n        padding: '4px',\n        fontSize: '28px'\n      }\n    }));\n  }\n\n  return /*#__PURE__*/React.createElement(\"img\", {\n    onClick: function onClick() {\n      return window.open(attachment.file);\n    },\n    onMouseEnter: function onMouseEnter() {\n      return setHovered(true);\n    },\n    onMouseLeave: function onMouseLeave() {\n      return setHovered(false);\n    },\n    src: attachment.file,\n    alt: 'thumb-nail',\n    style: style\n  });\n};\n\nvar styles$d = {\n  loadingContainer: (_loadingContainer = {\n    width: '100%',\n    cursor: 'pointer',\n    textAlign: 'right',\n    display: 'inline-block',\n    objectFit: 'cover',\n    borderRadius: '0.3em',\n    marginRight: '2px',\n    height: '30vw'\n  }, _loadingContainer[\"width\"] = '30vw', _loadingContainer.maxHeight = '200px', _loadingContainer.maxWidth = '200px', _loadingContainer.minHeight = '100px', _loadingContainer.minWidth = '100px', _loadingContainer.backgroundColor = '#d9d9d9', _loadingContainer),\n  thumbnail: (_thumbnail = {\n    width: '100%',\n    cursor: 'pointer',\n    textAlign: 'right',\n    display: 'inline',\n    objectFit: 'cover',\n    borderRadius: '0.3em',\n    paddingRight: '2px',\n    height: '30vw'\n  }, _thumbnail[\"width\"] = '30vw', _thumbnail.maxHeight = '200px', _thumbnail.maxWidth = '200px', _thumbnail.minHeight = '100px', _thumbnail.minWidth = '100px', _thumbnail)\n};\nvar colors = ['#D64045', '#5B3000', '#00CC99', '#467599', '#1D3354', '#8F250C', '#6153CC', '#961D4E', '#A29F15', '#0CAADC', '#FF5154', '#FA7921', '#688E26', '#550527', '#A10702', '#FF1053', '#6C6EA0', '#100B00'];\n\nfunction stringToNumber(str) {\n  var sum = 0;\n\n  for (var i = 0; i < str.length; i++) {\n    sum = sum + str.charCodeAt(i) * i - 97;\n  }\n\n  return sum;\n}\n\nfunction stringToColor(str) {\n  if (!str) {\n    return 'black';\n  } else {\n    return colors[stringToNumber(str) % colors.length];\n  }\n}\n\nvar Dot = /*#__PURE__*/function (_Component) {\n  _inheritsLoose(Dot, _Component);\n\n  function Dot() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _Component.call.apply(_Component, [this].concat(args)) || this;\n    _this.state = {\n      avatar: ''\n    };\n    return _this;\n  }\n\n  var _proto = Dot.prototype;\n\n  _proto.updateImg = function updateImg() {\n    var avatar = this.props.avatar;\n    avatar = avatar && avatar !== null ? avatar : '';\n\n    if (avatar.split('?')[0] !== this.state.avatar.split('?')[0]) {\n      this.setState({\n        avatar: avatar\n      });\n    }\n  };\n\n  _proto.componentDidMount = function componentDidMount() {\n    this.updateImg();\n  };\n\n  _proto.componentDidUpdate = function componentDidUpdate() {\n    this.updateImg();\n  };\n\n  _proto.render = function render() {\n    var username = this.props.username;\n    var color = stringToColor(username);\n    var customStyle = this.props.style ? this.props.style : {};\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"ce-avatar-dot\",\n      style: _extends({}, styles$e.dot, customStyle, {\n        backgroundColor: this.state.avatar ? 'white' : color,\n        backgroundImage: this.state.avatar && \"url(\" + this.state.avatar + \")\",\n        backgroundRepeat: 'no-repeat',\n        backgroundPosition: 'center',\n        backgroundSize: '14px'\n      })\n    });\n  };\n\n  return Dot;\n}(Component);\n\nvar styles$e = {\n  dot: {\n    width: '13px',\n    height: '13px',\n    borderRadius: '13px',\n    textAlign: 'center'\n  }\n};\nsetConfiguration({\n  maxScreenClass: 'xl'\n});\n\nvar Message = function Message(props) {\n  function renderReads() {\n    var chat = props.chat,\n        message = props.message;\n\n    if (!chat) {\n      return /*#__PURE__*/React.createElement(\"div\", null);\n    }\n\n    return chat.people.map(function (chatPerson, index) {\n      if (message.id === chatPerson.last_read) {\n        return /*#__PURE__*/React.createElement(Dot, {\n          key: \"read_\" + index,\n          avatar: chatPerson.person.avatar,\n          username: chatPerson.person.username,\n          style: {\n            \"float\": 'right',\n            marginLeft: '4px'\n          }\n        });\n      }\n\n      return /*#__PURE__*/React.createElement(\"div\", {\n        key: \"read_\" + index\n      });\n    });\n  }\n\n  function renderAttachments() {\n    var message = props.message;\n    var attachments = message && message.attachments ? message.attachments : [];\n    return attachments.map(function (attachment, index) {\n      return /*#__PURE__*/React.createElement(Thumbnail$1, {\n        attachment: attachment,\n        key: \"attachment_\" + index\n      });\n    });\n  }\n\n  var lastMessage = props.lastMessage,\n      message = props.message,\n      nextMessage = props.nextMessage;\n\n  if (!message) {\n    return /*#__PURE__*/React.createElement(\"div\", null);\n  }\n\n  var attachments = message && message.attachments && message.attachments;\n  var topRightRadius = !lastMessage || lastMessage.sender_username !== message.sender_username ? '1.3em' : '0.3em';\n  var bottomRightRadius = !nextMessage || nextMessage.sender_username !== message.sender_username ? '1.3em' : '0.3em';\n  var borderRadius = \"1.3em \" + topRightRadius + \" \" + bottomRightRadius + \" 1.3em\";\n  var paddingBottom = !nextMessage || nextMessage.sender_username !== message.sender_username ? '12px' : '2px';\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ce-message-row ce-my-message\",\n    style: {\n      width: '100%',\n      textAlign: 'right',\n      paddingBottom: paddingBottom\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'auto'\n    },\n    className: \"ce-my-message-attachments-container\"\n  }, renderAttachments()), /*#__PURE__*/React.createElement(Row, {\n    style: {\n      paddingRight: '2px'\n    },\n    className: \"ce-message-bubble-row ce-my-message-bubble-row\"\n  }, /*#__PURE__*/React.createElement(Col, {\n    xs: 1,\n    sm: 2,\n    md: 3\n  }), /*#__PURE__*/React.createElement(Col, {\n    xs: 11,\n    sm: 10,\n    md: 9\n  }, !attachments || message.text && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ce-message-bubble ce-my-message-bubble\",\n    style: _extends({}, styles$f.myMessage, {\n      borderRadius: borderRadius\n    })\n  }, message.text)), /*#__PURE__*/React.createElement(Col, {\n    xs: 1,\n    sm: 2,\n    md: 3\n  }), /*#__PURE__*/React.createElement(Col, {\n    xs: 12,\n    className: \"ce-reads-row ce-my-reads-row\"\n  }, renderReads())));\n};\n\nvar styles$f = {\n  myMessage: {\n    color: 'white',\n    cursor: 'pointer',\n    \"float\": 'right',\n    textAlign: 'left',\n    padding: '12px',\n    fontSize: '15px',\n    whiteSpace: 'pre-line',\n    backgroundColor: 'rgb(24, 144, 255)'\n  }\n};\nsetConfiguration({\n  maxScreenClass: 'xl'\n});\n\nvar TheirMessage = function TheirMessage(props) {\n  function renderReads() {\n    var chat = props.chat,\n        message = props.message;\n\n    if (!chat) {\n      return /*#__PURE__*/React.createElement(\"div\", null);\n    }\n\n    return chat.people.map(function (person, index) {\n      if (message.id === person.last_read) {\n        return /*#__PURE__*/React.createElement(Dot$1, {\n          key: \"read_\" + index,\n          avatar: person.person.avatar,\n          username: person.person.username,\n          style: {\n            \"float\": 'left',\n            marginLeft: '4px'\n          }\n        });\n      }\n\n      return /*#__PURE__*/React.createElement(\"div\", {\n        key: \"read_\" + index\n      });\n    });\n  }\n\n  function renderAttachments() {\n    var message = props.message;\n    var attachments = message && message.attachments ? props.message.attachments : [];\n    return attachments.map(function (attachment, index) {\n      return /*#__PURE__*/React.createElement(Thumbnail$1, {\n        attachment: attachment,\n        key: \"attachment_\" + index\n      });\n    });\n  }\n\n  var lastMessage = props.lastMessage,\n      message = props.message,\n      nextMessage = props.nextMessage;\n\n  if (!message) {\n    return /*#__PURE__*/React.createElement(\"div\", null);\n  }\n\n  var attachments = message && message.attachments && message.attachments;\n  var topLeftRadius = !lastMessage || lastMessage.sender_username !== message.sender_username ? '1.3em' : '0.3em';\n  var bottomLeftRadius = !nextMessage || nextMessage.sender_username !== message.sender_username ? '1.3em' : '0.3em';\n  var borderRadius = topLeftRadius + \" 1.3em 1.3em \" + bottomLeftRadius;\n  var paddingBottom = !nextMessage || nextMessage.sender_username !== message.sender_username ? '12px' : '2px';\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: '100%',\n      paddingBottom: paddingBottom\n    },\n    className: \"ce-message-row ce-their-message\"\n  }, (!lastMessage || lastMessage.sender_username !== message.sender_username) && /*#__PURE__*/React.createElement(\"div\", {\n    style: styles$g.nameText,\n    className: \"ce-their-message-sender\"\n  }, message.sender_username), /*#__PURE__*/React.createElement(Row, {\n    style: {\n      paddingLeft: '2px'\n    },\n    className: \"ce-their-message-row\"\n  }, /*#__PURE__*/React.createElement(Col, {\n    xs: 11,\n    sm: 10,\n    md: 9\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      height: '0px'\n    },\n    className: \"ce-their-message-avatar\"\n  }, (!nextMessage || nextMessage.sender_username !== message.sender_username) && /*#__PURE__*/React.createElement(Avatar$1, {\n    show_online: false,\n    username: message.sender_username,\n    avatar: message.sender && message.sender.avatar\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'auto',\n      paddingLeft: '50px'\n    },\n    className: \"ce-their-message-attachments-container\"\n  }, renderAttachments()), !attachments || message.text && /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      paddingLeft: '48px'\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ce-message-bubble ce-their-message-bubble\",\n    style: _extends({}, styles$g.theirMessage, {\n      borderRadius: borderRadius\n    })\n  }, message.text))), /*#__PURE__*/React.createElement(Col, {\n    xs: 9,\n    style: {\n      marginLeft: '48px'\n    },\n    className: \"ce-reads-row ce-their-reads-row\"\n  }, renderReads())));\n};\n\nvar styles$g = {\n  theirMessage: {\n    cusor: 'auto',\n    color: 'black',\n    \"float\": 'left',\n    padding: '12px',\n    fontSize: '15px',\n    whiteSpace: 'pre-line',\n    backgroundColor: '#f1f0f0'\n  },\n  nameText: {\n    paddingLeft: '62px',\n    paddingBottom: '2px',\n    color: 'rgba(0, 0, 0, .40)',\n    fontSize: '15px'\n  }\n};\nsetConfiguration({\n  maxScreenClass: 'xl'\n});\n\nvar SendingMessage = function SendingMessage(props) {\n  function renderAttachments(attachments) {\n    return attachments.map(function (a, index) {\n      return /*#__PURE__*/React.createElement(Thumbnail$1, {\n        key: \"sending-file-\" + index\n      });\n    });\n  }\n\n  var lastMessage = props.lastMessage,\n      message = props.message,\n      nextMessage = props.nextMessage;\n\n  if (!message) {\n    return /*#__PURE__*/React.createElement(\"div\", null);\n  }\n\n  var attachments = message && message.attachments ? message.attachments : [];\n  var topRightRadius = !lastMessage || lastMessage.sender_username !== message.sender_username ? '1.3em' : '0.3em';\n  var bottomRightRadius = !nextMessage || nextMessage.sender_username !== message.sender_username ? '1.3em' : '0.3em';\n  var borderRadius = \"1.3em \" + topRightRadius + \" \" + bottomRightRadius + \" 1.3em\";\n  var paddingBottom = !nextMessage || nextMessage.sender_username !== message.sender_username ? '12px' : '2px';\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ce-message-row ce-my-message ce-my-message-sending\",\n    style: {\n      width: '100%',\n      textAlign: 'right',\n      paddingBottom: paddingBottom\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'auto'\n    },\n    className: \"ce-my-message-attachments-container\"\n  }, renderAttachments(attachments)), /*#__PURE__*/React.createElement(Row, {\n    style: {\n      paddingRight: '2px'\n    },\n    className: \"ce-message-bubble-row ce-my-message-bubble-row ce-my-message-sending-row\"\n  }, /*#__PURE__*/React.createElement(Col, {\n    xs: 1,\n    sm: 2,\n    md: 3\n  }), /*#__PURE__*/React.createElement(Col, {\n    xs: 11,\n    sm: 10,\n    md: 9\n  }, message.text && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ce-message-bubble ce-my-message-bubble\",\n    style: _extends({}, styles$h.myMessage, {\n      borderRadius: borderRadius\n    })\n  }, message.text)), /*#__PURE__*/React.createElement(Col, {\n    xs: 1,\n    sm: 2,\n    md: 3\n  })));\n};\n\nvar styles$h = {\n  myMessage: {\n    color: 'white',\n    cursor: 'pointer',\n    \"float\": 'right',\n    textAlign: 'left',\n    padding: '12px',\n    fontSize: '15px',\n    whiteSpace: 'pre-line',\n    backgroundColor: '#40a9ff'\n  }\n};\n\nvar Message$1 = function Message$1(props) {\n  var lastMessage = props.lastMessage,\n      message = props.message,\n      nextMessage = props.nextMessage,\n      sending = props.sending,\n      chat = props.chat;\n\n  var _useContext = useContext(ChatEngineContext),\n      conn = _useContext.conn;\n\n  if (!message || !chat) {\n    return /*#__PURE__*/React.createElement(\"div\", null);\n  }\n\n  if (!conn || conn === null) {\n    return /*#__PURE__*/React.createElement(\"div\", null);\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ce-message-and-date\"\n  }, !sending && /*#__PURE__*/React.createElement(DatePartition, {\n    lastCreated: lastMessage ? lastMessage.created : null,\n    created: message.created\n  }), sending ? /*#__PURE__*/React.createElement(SendingMessage, {\n    chat: chat,\n    conn: conn,\n    lastMessage: lastMessage,\n    message: message,\n    nextMessage: nextMessage\n  }) : /*#__PURE__*/React.createElement(\"div\", null, message.sender_username === conn.userName || message.sender_username === conn.senderUsername ? /*#__PURE__*/React.createElement(Message, {\n    chat: chat,\n    conn: conn,\n    lastMessage: lastMessage,\n    message: message,\n    nextMessage: nextMessage\n  }) : /*#__PURE__*/React.createElement(TheirMessage, {\n    chat: chat,\n    conn: conn,\n    lastMessage: lastMessage,\n    message: message,\n    nextMessage: nextMessage\n  })));\n};\n\nvar Messages = function Messages(props) {\n  var _useContext = useContext(ChatEngineContext),\n      conn = _useContext.conn,\n      chats = _useContext.chats,\n      messages = _useContext.messages,\n      activeChat = _useContext.activeChat,\n      setLoadMoreMessages = _useContext.setLoadMoreMessages,\n      setIsBottomVisible = _useContext.setIsBottomVisible;\n\n  var chat = chats && chats[activeChat];\n  var keys = Object.keys(messages);\n  if (!conn || conn === null) return /*#__PURE__*/React.createElement(\"div\", null);\n  return keys.map(function (key, index) {\n    var message = messages[key];\n    var lastMessageKey = index === 0 ? null : keys[index - 1];\n    var nextMessageKey = index === keys.length - 1 ? null : keys[index + 1];\n\n    if (props.renderMessageBubble) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        key: \"message_\" + index\n      }, props.renderMessageBubble(conn, chat, messages[lastMessageKey], message, messages[nextMessageKey]));\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: \"message_\" + index,\n      id: \"ce-message-\" + message.id\n    }, index === keys.length - 1 && /*#__PURE__*/React.createElement(RenderTrigger, {\n      onEnter: function onEnter() {\n        return setIsBottomVisible(true);\n      },\n      onLeave: function onLeave() {\n        return setIsBottomVisible(false);\n      }\n    }), /*#__PURE__*/React.createElement(Message$1, {\n      chat: chat,\n      message: message,\n      lastMessage: messages[lastMessageKey],\n      nextMessage: messages[nextMessageKey]\n    }), index === 0 && /*#__PURE__*/React.createElement(RenderTrigger, {\n      onEnter: function onEnter() {\n        return setLoadMoreMessages(true);\n      }\n    }));\n  });\n};\n\nvar SendingMessages = function SendingMessages(props) {\n  var _useContext = useContext(ChatEngineContext),\n      conn = _useContext.conn,\n      chats = _useContext.chats,\n      activeChat = _useContext.activeChat,\n      sendingMessages = _useContext.sendingMessages;\n\n  var keys = Object.keys(sendingMessages);\n  var chat = chats && chats[activeChat];\n  if (!conn || conn === null) return /*#__PURE__*/React.createElement(\"div\", null);\n  return keys.map(function (key, index) {\n    var message = sendingMessages[key];\n    var lastMessageKey = index === 0 ? null : keys[index - 1];\n    var nextMessageKey = index === keys.length - 1 ? null : keys[index + 1];\n\n    if (message && message.chat === activeChat) {\n      return /*#__PURE__*/React.createElement(Message$1, {\n        sending: true,\n        key: \"sending-msg-\" + index,\n        chat: chat,\n        message: message,\n        lastMessage: sendingMessages[lastMessageKey],\n        nextMessage: sendingMessages[nextMessageKey]\n      });\n    }\n  });\n};\n\nvar Typers = function Typers(props) {\n  var _useContext = useContext(ChatEngineContext),\n      conn = _useContext.conn,\n      activeChat = _useContext.activeChat,\n      typingCounter = _useContext.typingCounter;\n\n  var typers = typingCounter && typingCounter[activeChat] ? typingCounter[activeChat] : [];\n  if (!conn || conn === null) return /*#__PURE__*/React.createElement(\"div\", null);\n\n  if (props.renderIsTyping) {\n    return props.renderIsTyping(typers);\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", null, Object.keys(typers).map(function (username, index) {\n    if (conn.userName !== username && props.currentTime < typers[username] + 2000) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        key: \"typer_\" + index,\n        style: {\n          color: stringToColor(username),\n          padding: '2px',\n          paddingLeft: '12px'\n        }\n      }, username + \" is typing...\");\n    } else {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        key: \"typer_\" + index\n      });\n    }\n  }));\n};\n\nvar Thumbnail$2 = function Thumbnail(props) {\n  var _useState = useState(false),\n      hovered = _useState[0],\n      setHovered = _useState[1];\n\n  var _useState2 = useState(''),\n      blob = _useState2[0],\n      setBlob = _useState2[1];\n\n  useEffect(function () {\n    setBlob(URL.createObjectURL(props.file));\n  }, [props.file]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      padding: '12px 6px',\n      display: 'inline-block',\n      position: \"relative\"\n    },\n    onMouseEnter: function onMouseEnter() {\n      return setHovered(true);\n    },\n    onMouseLeave: function onMouseLeave() {\n      return setHovered(false);\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    style: styles$i.imageSquare,\n    alt: props.file ? props.file.name : '',\n    src: blob\n  }), hovered && /*#__PURE__*/React.createElement(CloseCircleTwoTone, {\n    style: styles$i.closeIcon,\n    onClick: function onClick() {\n      return props.onRemove && props.onRemove();\n    }\n  }));\n};\n\nvar styles$i = {\n  imageSquare: {\n    height: '108px',\n    width: '108px',\n    border: '1px solid #afafaf',\n    borderRadius: '8px',\n    objectFit: 'cover',\n    display: 'inline'\n  },\n  closeIcon: {\n    position: 'absolute',\n    bottom: 'calc(100% - 32px)',\n    left: '96px',\n    width: '0px',\n    cursor: 'pointer'\n  }\n};\n\nvar FileRow = function FileRow(props) {\n  function renderFiles() {\n    return props.files.map(function (file, index) {\n      return /*#__PURE__*/React.createElement(Thumbnail$2, {\n        file: file,\n        key: \"thumb_\" + index,\n        onRemove: function onRemove() {\n          return props.onRemove && props.onRemove(index);\n        }\n      });\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: 'calc(100% - 24px)',\n      paddingLeft: '12px'\n    }\n  }, renderFiles());\n};\n\nvar ImagesInput = function ImagesInput(props) {\n  var _useState = useState({\n    hovered: false\n  }),\n      state = _useState[0],\n      setState = _useState[1];\n\n  function onSelect(event) {\n    var files = Array.from(event.target.files);\n    props.onSelectFiles && props.onSelectFiles(files);\n  }\n\n  return /*#__PURE__*/React.createElement(\"form\", {\n    className: \"uploader\",\n    encType: \"multipart/form-data\",\n    style: {\n      height: '0px'\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"files\",\n    id: \"upload-document-button\"\n  }, /*#__PURE__*/React.createElement(PaperClipOutlined, {\n    onMouseEnter: function onMouseEnter() {\n      return setState(_extends({}, state, {\n        hovered: true\n      }));\n    },\n    onMouseLeave: function onMouseLeave() {\n      return setState(_extends({}, state, {\n        hovered: false\n      }));\n    },\n    style: _extends({}, {\n      cursor: 'pointer',\n      position: 'absolute',\n      bottom: '20px',\n      right: '63px',\n      fontSize: '18px'\n    }, {\n      color: state.hovered ? '#69c0ff' : '#1890ff'\n    })\n  })), /*#__PURE__*/React.createElement(\"input\", {\n    multiple: true,\n    id: \"files\",\n    accept: \"image/x-png,image/gif,image/jpeg\",\n    style: {\n      visibility: \"hidden\"\n    },\n    type: \"file\",\n    onChange: function onChange(e) {\n      return onSelect(e);\n    },\n    onClick: function onClick(e) {\n      return e.target.value = null;\n    }\n  }));\n};\n\nvar MessageInput = /*#__PURE__*/function (_Component) {\n  _inheritsLoose(MessageInput, _Component);\n\n  function MessageInput() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _Component.call.apply(_Component, [this].concat(args)) || this;\n    _this.state = {\n      focused: false,\n      value: null,\n      height: 0\n    };\n    return _this;\n  }\n\n  var _proto = MessageInput.prototype;\n\n  _proto.resize = function resize() {\n    var textarea = document.getElementById(\"msg-textarea\");\n    textarea.style.height = \"\";\n    textarea.style.height = Math.min(textarea.scrollHeight, 150) + \"px\";\n    this.setState({\n      height: Math.min(textarea.scrollHeight, 150)\n    });\n  };\n\n  _proto.componentDidMount = function componentDidMount() {\n    this.resize();\n  };\n\n  _proto.handleChange = function handleChange(e) {\n    this.resize();\n    this.props.handleChange && this.props.handleChange(e);\n  };\n\n  _proto.onKeyDown = function onKeyDown(e) {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n\n      if (this.props.value.length > 0) {\n        this.props.onSubmit && this.props.onSubmit(e);\n      }\n    }\n  };\n\n  _proto.render = function render() {\n    var _this2 = this;\n\n    var style = _extends({}, styles$j.input, {\n      overflowY: this.state.height === 150 ? 'scroll' : 'hidden'\n    });\n\n    return /*#__PURE__*/React.createElement(\"textarea\", {\n      id: \"msg-textarea\",\n      className: \"ce-input ce-textarea-input\",\n      rows: \"1\",\n      style: style,\n      value: this.props.value,\n      placeholder: this.props.label,\n      onBlur: function onBlur() {\n        return _this2.setState({\n          focused: false\n        });\n      },\n      onFocus: function onFocus() {\n        return _this2.setState({\n          focused: true\n        });\n      },\n      type: this.props.type ? this.props.type : \"text\",\n      onChange: function onChange(e) {\n        return _this2.handleChange(e);\n      },\n      onKeyDown: function onKeyDown(e) {\n        return _this2.onKeyDown(e);\n      }\n    });\n  };\n\n  return MessageInput;\n}(Component);\n\nvar styles$j = {\n  input: {\n    border: '1px solid white',\n    width: 'calc(100% - 64px - 24px - 44px)',\n    outline: 'none',\n    fontSize: '15px',\n    fontFamily: 'Avenir',\n    paddingLeft: '12px',\n    paddingRight: '12px',\n    position: 'relative',\n    left: '12px',\n    resize: 'none',\n    overflowX: 'hidden'\n  }\n};\nvar _this$2 = undefined;\n\nvar NewMessageForm$1 = function NewMessageForm() {\n  var _useContext = useContext(ChatEngineContext),\n      conn = _useContext.conn,\n      activeChat = _useContext.activeChat,\n      sendingMessages = _useContext.sendingMessages,\n      setSendingMessages = _useContext.setSendingMessages;\n\n  var _useState = useState({\n    trigger: 0,\n    mod: 3,\n    value: '',\n    attachments: []\n  }),\n      state = _useState[0],\n      setState = _useState[1];\n\n  if (!conn || conn === null) return /*#__PURE__*/React.createElement(\"div\", null);\n\n  function _onRemove(index) {\n    var attachments = state.attachments;\n    attachments.splice(index, 1);\n    setState(_extends({}, state, {\n      attachments: attachments\n    }));\n  }\n\n  function handleChange(event) {\n    setState(_extends({}, state, {\n      value: event.target.value,\n      trigger: (state.trigger + 1) % state.mod\n    }));\n\n    if (state.trigger === 1) {\n      isTyping$1(conn, activeChat);\n    }\n  }\n\n  function handleSubmit(event) {\n    event.preventDefault();\n    var attachments = state.attachments;\n    var text = state.value.trim();\n    var custom_json = {\n      sender_id: Date.now().toString()\n    };\n    var sender_username = conn.userName ? conn.userName : conn.senderUsername;\n    var data = {\n      text: text,\n      attachments: attachments,\n      custom_json: custom_json,\n      sender_username: sender_username,\n      chat: activeChat\n    };\n\n    if (text.length > 0 || attachments.length > 0) {\n      sendMessage$1(conn, activeChat, data, function (data) {});\n    }\n\n    setState(_extends({}, state, {\n      value: '',\n      attachments: []\n    }));\n    var textarea = document.getElementById(\"msg-textarea\");\n    textarea.style.height = \"24px\";\n\n    var newSendingMessages = _extends({}, sendingMessages);\n\n    newSendingMessages[data.custom_json.sender_id] = data;\n    setSendingMessages(newSendingMessages);\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    id: \"msg-form-container\",\n    style: styles$k.NewMessageFormContainer,\n    className: \"ce-message-form-container\"\n  }, /*#__PURE__*/React.createElement(FileRow, {\n    files: state.attachments,\n    onRemove: function onRemove(i) {\n      return _onRemove(i);\n    }\n  }), /*#__PURE__*/React.createElement(ImagesInput, {\n    onSelectFiles: function onSelectFiles(attachments) {\n      return setState(_extends({}, state, {\n        attachments: attachments\n      }));\n    }\n  }), /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleSubmit.bind(_this$2),\n    className: \"ce-message-form\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: styles$k.inputContainer,\n    className: \"ce-message-input-form\"\n  }, /*#__PURE__*/React.createElement(MessageInput, {\n    value: state.value,\n    label: \"Send a message...\",\n    handleChange: handleChange.bind(_this$2),\n    onSubmit: handleSubmit.bind(_this$2)\n  }), /*#__PURE__*/React.createElement(Button$1, {\n    icon: \"send\",\n    type: \"submit\",\n    id: \"ce-send-message-button\",\n    style: {\n      position: 'absolute',\n      bottom: '10px',\n      right: '6px'\n    }\n  }))));\n};\n\nvar styles$k = {\n  NewMessageFormContainer: {\n    position: 'absolute',\n    bottom: '0px',\n    width: '100%',\n    backgroundColor: 'white'\n  },\n  inputContainer: {\n    minHeight: '36px',\n    paddingTop: '10px',\n    paddingBottom: '6px'\n  }\n};\nvar initial = 45;\nvar count$1 = initial;\nvar interval$1 = 33;\n\nvar ChatFeed = function ChatFeed(props) {\n  var didMountRef = useRef(false);\n\n  var _useState = useState(0),\n      duration = _useState[0],\n      setDuration = _useState[1];\n\n  var _useState2 = useState(null),\n      currentChat = _useState2[0],\n      setCurrentChat = _useState2[1];\n\n  var _useState3 = useState(Date.now()),\n      currentTime = _useState3[0],\n      setCurrentTime = _useState3[1];\n\n  var _useContext = useContext(ChatEngineContext),\n      conn = _useContext.conn,\n      chats = _useContext.chats,\n      setChats = _useContext.setChats,\n      sendingMessages = _useContext.sendingMessages,\n      messages = _useContext.messages,\n      setMessages = _useContext.setMessages,\n      activeChat = _useContext.activeChat,\n      setActiveChat = _useContext.setActiveChat,\n      loadMoreMessages = _useContext.loadMoreMessages,\n      setLoadMoreMessages = _useContext.setLoadMoreMessages,\n      isBottomVisible = _useContext.isBottomVisible;\n\n  function onReadMessage(chat) {\n    if (chats) {\n      var newChats = _extends({}, chats);\n\n      newChats[chat.id] = chat;\n      setChats(newChats);\n    }\n  }\n\n  function onGetMessages(chatId, messages, scrollDownTo) {\n    setMessages(_$1.mapKeys(messages, 'id'));\n\n    if (messages.length > 0) {\n      var message = messages[messages.length - 1];\n\n      if (props.userName && props.userName !== message.sender_username) {\n        readMessage(conn, chatId, message.id, function (chat) {\n          return onReadMessage(chat);\n        });\n      }\n    }\n\n    if (scrollDownTo) {\n      animateScroll.scrollToBottom({\n        duration: 0,\n        containerId: scrollDownTo\n      });\n    }\n\n    props.onGetMessages && props.onGetMessages(chatId, messages);\n  }\n\n  function loadMessages(loadMoreMessages) {\n    if (loadMoreMessages) {\n      count$1 = count$1 + interval$1;\n      setLoadMoreMessages(false);\n      getLatestMessages(conn, activeChat, count$1, function (chatId, messages) {\n        return onGetMessages(chatId, messages, false);\n      });\n    } else if (conn && !props.activeChat && activeChat !== null && activeChat !== currentChat) {\n      count$1 = initial;\n      setCurrentChat(activeChat);\n      getLatestMessages(conn, activeChat, count$1, function (chatId, messages) {\n        return onGetMessages(chatId, messages, \"ce-feed-container\");\n      });\n    } else if (conn && props.activeChat && props.activeChat !== currentChat) {\n      count$1 = initial;\n      setActiveChat(props.activeChat);\n      setCurrentChat(props.activeChat);\n      getLatestMessages(conn, props.activeChat, count$1, function (chatId, messages) {\n        return onGetMessages(chatId, messages, \"ce-feed-container\");\n      });\n    }\n  }\n\n  useEffect(function () {\n    loadMessages(false);\n  }, [conn, activeChat, currentChat]);\n  useEffect(function () {\n    loadMessages(loadMoreMessages);\n  }, [loadMoreMessages]);\n  useEffect(function () {\n    if (!didMountRef.current) {\n      didMountRef.current = true;\n      setTimeout(function () {\n        setDuration(100);\n      }, 3000);\n      setInterval(function () {\n        setCurrentTime(Date.now());\n      }, 1000);\n    } else {\n      if (isBottomVisible && !_$1.isEmpty(messages)) {\n        animateScroll.scrollToBottom({\n          duration: duration,\n          containerId: \"ce-feed-container\"\n        });\n      }\n    }\n  }, [sendingMessages, messages, isBottomVisible]);\n  var chat = chats && chats[currentChat];\n\n  if (props.renderChatFeed) {\n    return props.renderChatFeed(props);\n  } else if (conn === undefined) {\n    return /*#__PURE__*/React.createElement(AuthFail, null);\n  } else if (conn && chats !== null && _$1.isEmpty(chats)) {\n    return /*#__PURE__*/React.createElement(Welcome, null);\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ce-chat-feed\",\n    style: {\n      height: '100%',\n      maxHeight: '100vh',\n      backgroundColor: '#f0f0f0'\n    }\n  }, props.renderChatHeader ? props.renderChatHeader(chat) : /*#__PURE__*/React.createElement(ChatHeader, null), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"ce-feed-container\",\n    style: styles$l.feedContainer,\n    className: \"ce-chat-feed-container\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      height: '88px'\n    },\n    className: \"ce-feed-container-top\"\n  }), /*#__PURE__*/React.createElement(Messages, props), /*#__PURE__*/React.createElement(SendingMessages, props), /*#__PURE__*/React.createElement(Typers, {\n    currentTime: currentTime\n  }), /*#__PURE__*/React.createElement(ConnectionBar, null), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      height: '54px'\n    },\n    className: \"ce-feed-container-bottom\"\n  })), props.renderNewMessageForm ? props.renderNewMessageForm(props, currentChat) : /*#__PURE__*/React.createElement(NewMessageForm$1, null));\n};\n\nvar styles$l = {\n  feedContainer: {\n    width: '100%',\n    height: '100%',\n    maxHeight: '100vh',\n    overflowX: 'hidden',\n    overflowY: 'scroll',\n    backgroundColor: 'white',\n    fontFamily: 'Avenir'\n  }\n};\nsetConfiguration({\n  maxScreenClass: 'xl',\n  gutterWidth: 0\n});\n\nvar ChatEngine = function ChatEngine(props) {\n  var context = useContext(ChatEngineContext);\n  var height = props.height;\n\n  var propsAndContext = _extends({}, props, context);\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      textAlign: 'left',\n      backgroundColor: 'white'\n    }\n  }, /*#__PURE__*/React.createElement(Socket, props), /*#__PURE__*/React.createElement(Row, null, /*#__PURE__*/React.createElement(Col, {\n    xs: 0,\n    sm: 3,\n    style: {\n      height: height ? height : ''\n    }\n  }, /*#__PURE__*/React.createElement(ChatList, propsAndContext)), /*#__PURE__*/React.createElement(Col, {\n    xs: 12,\n    sm: 6,\n    style: {\n      height: height ? height : ''\n    }\n  }, /*#__PURE__*/React.createElement(ChatFeed, propsAndContext)), /*#__PURE__*/React.createElement(Col, {\n    xs: 0,\n    sm: 3,\n    style: {\n      height: height ? height : ''\n    }\n  }, /*#__PURE__*/React.createElement(ChatSettings, propsAndContext))));\n};\n\nvar ChatEngineApp = function ChatEngineApp(props) {\n  if (useContext(ChatEngineContext)) {\n    return /*#__PURE__*/React.createElement(ChatEngine, props);\n  } else {\n    return /*#__PURE__*/React.createElement(ChatEngineWrapper, null, /*#__PURE__*/React.createElement(ChatEngine, props));\n  }\n};\n\nvar _this$3 = undefined;\n\nvar ChatSocket = function ChatSocket(props) {\n  var _useState = useState(Date.now() + 10000),\n      reconnect = _useState[0];\n\n  var _useContext = useContext(ChatEngineContext),\n      setConnecting = _useContext.setConnecting,\n      conn = _useContext.conn,\n      setConn = _useContext.setConn,\n      setCreds = _useContext.setCreds,\n      chats = _useContext.chats,\n      setChats = _useContext.setChats,\n      messages = _useContext.messages,\n      setMessages = _useContext.setMessages,\n      sendingMessages = _useContext.sendingMessages,\n      setSendingMessages = _useContext.setSendingMessages,\n      activeChat = _useContext.activeChat,\n      setActiveChat = _useContext.setActiveChat,\n      typingCounter = _useContext.typingCounter,\n      setTypingCounter = _useContext.setTypingCounter;\n\n  function onEditChat(chat) {\n    if (chats) {\n      var newChats = _extends({}, chats);\n\n      newChats[chat.id] = chat;\n      setChats(newChats);\n    }\n\n    props.onEditChat && props.onEditChat(chat);\n  }\n\n  function onGetChat(chat) {\n    if (activeChat === null) {\n      setActiveChat(chat.id);\n    }\n\n    setChats(_.mapKeys([chat], 'id'));\n  }\n\n  function onConnect(conn) {\n    setConn(conn);\n    setCreds(conn);\n    setConnecting(false);\n    getChat$1(conn, props.chatID, function (chat) {\n      return onGetChat(chat);\n    });\n\n    if (Date.now() > reconnect) {\n      getLatestMessages$1(conn, props.chatID, 45, function (id, list) {\n        setMessages(_extends({}, messages, _.mapKeys(list, 'id')));\n      });\n    }\n\n    props.onConnect && props.onConnect(conn);\n  }\n\n  function handleEvent(event) {\n    var eventJSON = JSON.parse(event);\n\n    if (eventJSON.action === 'login_error') {\n      console.log(\"Your chat auth credentials were not correct: \\n\\n                Project ID: \" + props.projectID + \" \\n\\n                Chat ID: \" + props.chatID + \" \\n\\n                Access Key: \" + props.chatAccessKey + \"\\n\\n                Double check these credentials to make sure they're correct.\\n\\n                If all three are correct, try resetting the username and secret in the Online Dashboard or Private API.\");\n      setConn(undefined);\n      setCreds(undefined);\n      props.onFailAuth && props.onFailAuth(conn);\n    } else if (eventJSON.action === 'edit_chat') {\n      onEditChat(eventJSON.data);\n    } else if (eventJSON.action === 'delete_chat') {\n      var chat = eventJSON.data;\n\n      if (chats) {\n        chats[chat.id] = undefined;\n        setChats(chats);\n      }\n\n      props.onDeleteChat && props.onDeleteChat(chat);\n    } else if (eventJSON.action === 'add_person') {\n      onEditChat(eventJSON.data);\n      props.onAddPerson && props.onAddPerson(eventJSON.data);\n    } else if (eventJSON.action === 'remove_person') {\n      onEditChat(eventJSON.data);\n      props.onRemovePerson && props.onRemovePerson(eventJSON.data);\n    } else if (eventJSON.action === 'new_message') {\n      var _eventJSON$data = eventJSON.data,\n          id = _eventJSON$data.id,\n          message = _eventJSON$data.message;\n\n      if (typeof message.custom_json === \"string\" && message.custom_json.indexOf('sender_id') !== -1) {\n        sendingMessages[JSON.parse(message.custom_json).sender_id] = undefined;\n        setSendingMessages(sendingMessages);\n      }\n\n      if (id === activeChat) {\n        var newMessages = _extends({}, messages);\n\n        newMessages[message.id] = message;\n        setMessages(newMessages);\n      }\n\n      props.onNewMessage && props.onNewMessage(id, message);\n    } else if (eventJSON.action === 'edit_message') {\n      var _eventJSON$data2 = eventJSON.data,\n          _id = _eventJSON$data2.id,\n          _message = _eventJSON$data2.message;\n\n      if (_id === activeChat) {\n        messages[_message.id] = _message;\n        setMessages(messages);\n      }\n\n      props.onEditMessage && props.onEditMessage(_id, _message);\n    } else if (eventJSON.action === 'delete_message') {\n      var _eventJSON$data3 = eventJSON.data,\n          _id2 = _eventJSON$data3.id,\n          _message2 = _eventJSON$data3.message;\n\n      if (_id2 === activeChat) {\n        messages[_message2.id] = undefined;\n        setMessages(messages);\n      }\n\n      props.onDeleteMessage && props.onDeleteMessage(_id2, _message2);\n    } else if (eventJSON.action === 'is_typing') {\n      var _extends2, _extends3;\n\n      var _eventJSON$data4 = eventJSON.data,\n          _id3 = _eventJSON$data4.id,\n          person = _eventJSON$data4.person;\n\n      var newTypingCounter = _extends({}, typingCounter);\n\n      newTypingCounter = _extends({}, newTypingCounter, (_extends3 = {}, _extends3[_id3] = _extends({}, newTypingCounter[_id3], (_extends2 = {}, _extends2[person] = Date.now(), _extends2)), _extends3));\n      setTypingCounter(newTypingCounter);\n      props.onTyping && props.onTyping(_id3, person);\n    }\n  }\n\n  function onClose() {\n    setConnecting(true);\n  }\n\n  var development = props.development,\n      publicKey = props.publicKey,\n      projectID = props.projectID,\n      chatID = props.chatID,\n      chatAccessKey = props.chatAccessKey;\n  var wsStart = development ? 'ws://' : 'wss://';\n  var rootHost = development ? '127.0.0.1:8000' : 'api.chatengine.io';\n  var project = publicKey ? publicKey : projectID;\n  return /*#__PURE__*/React.createElement(WebSocket, {\n    url: \"\" + wsStart + rootHost + \"/chat/?projectID=\" + project + \"&chatID=\" + chatID + \"&accessKey=\" + chatAccessKey,\n    onOpen: function onOpen() {\n      return onConnect(props);\n    },\n    onClose: onClose.bind(_this$3),\n    onMessage: handleEvent.bind(_this$3),\n    reconnectIntervalInMilliSeconds: 3000\n  });\n};\n\nvar Avatar = /*#__PURE__*/function (_Component) {\n  _inheritsLoose(Avatar, _Component);\n\n  function Avatar() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _Component.call.apply(_Component, [this].concat(args)) || this;\n    _this.state = {\n      avatar: ''\n    };\n    return _this;\n  }\n\n  var _proto = Avatar.prototype;\n\n  _proto.updateImg = function updateImg() {\n    var avatar = this.props.avatar;\n    avatar = avatar && avatar !== null ? avatar : '';\n\n    if (avatar.split('?')[0] !== this.state.avatar.split('?')[0]) {\n      this.setState({\n        avatar: avatar\n      });\n    }\n  };\n\n  _proto.componentDidMount = function componentDidMount() {\n    this.updateImg();\n  };\n\n  _proto.componentDidUpdate = function componentDidUpdate() {\n    this.updateImg();\n  };\n\n  _proto.render = function render() {\n    var _this$props = this.props,\n        username = _this$props.username,\n        is_online = _this$props.is_online;\n    var customStyle = this.props.style ? this.props.style : {};\n    var text = username ? username.substring(0, 2).toUpperCase() : '';\n    var color = stringToColor(username);\n    return /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        width: '48px',\n        height: '48px'\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        height: '0px'\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"ce-avatar\",\n      style: _extends({}, styles$m.avatar, customStyle, {\n        backgroundColor: this.state.avatar ? 'white' : color,\n        backgroundImage: this.state.avatar && \"url(\" + this.state.avatar + \")\",\n        backgroundRepeat: 'no-repeat',\n        backgroundPosition: 'center',\n        backgroundSize: '48px'\n      })\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"ce-avatar-text\",\n      style: styles$m.avatarText\n    }, !this.state.avatar && text))), this.props.show_online !== false && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"ce-avatar-status\",\n      style: _extends({}, styles$m.status, {\n        backgroundColor: is_online ? '#52c41a' : '#f5222d'\n      })\n    }));\n  };\n\n  return Avatar;\n}(Component);\n\nvar styles$m = {\n  avatar: {\n    width: '44px',\n    height: '44px',\n    borderRadius: '22px',\n    color: 'white',\n    textAlign: 'center'\n  },\n  avatarText: {\n    color: 'white',\n    paddingTop: '12px',\n    fontSize: '15px',\n    fontWeight: '600'\n  },\n  status: {\n    width: '8px',\n    height: '8px',\n    borderRadius: '100%',\n    border: '2px solid white'\n  }\n};\n\nvar _dangerButton;\n\nvar Button = /*#__PURE__*/function (_Component) {\n  _inheritsLoose(Button, _Component);\n\n  function Button() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _Component.call.apply(_Component, [this].concat(args)) || this;\n    _this.state = {\n      hovered: false\n    };\n    return _this;\n  }\n\n  var _proto = Button.prototype;\n\n  _proto.render = function render() {\n    var _this2 = this;\n\n    var _this$props = this.props,\n        value = _this$props.value,\n        icon = _this$props.icon,\n        theme = _this$props.theme,\n        style = _this$props.style;\n    var customStyle = style ? style : {};\n    var hoverStyle = this.state.hovered ? styles$n.hoverButton : {};\n    var themeStyle = theme === 'danger' ? styles$n.dangerButton : styles$n.button;\n    return /*#__PURE__*/React.createElement(\"button\", {\n      id: this.props.id,\n      type: this.props.type,\n      onClick: function onClick() {\n        return _this2.props.onClick && _this2.props.onClick();\n      },\n      onMouseEnter: function onMouseEnter() {\n        return _this2.setState({\n          hovered: true\n        });\n      },\n      onMouseLeave: function onMouseLeave() {\n        return _this2.setState({\n          hovered: false\n        });\n      },\n      style: _extends({}, themeStyle, customStyle, hoverStyle),\n      className: \"ce-primary-button \" + (theme === 'danger' ? 'ce-danger-button' : '')\n    }, icon === 'plus' && /*#__PURE__*/React.createElement(PlusOutlined, null), icon === 'send' && /*#__PURE__*/React.createElement(ArrowUpOutlined, null), icon === 'delete' && /*#__PURE__*/React.createElement(DeleteOutlined, null), icon === 'user-add' && /*#__PURE__*/React.createElement(UserAddOutlined, null), value && icon ? \" \" + value : value);\n  };\n\n  return Button;\n}(Component);\n\nvar styles$n = {\n  button: {\n    color: 'white',\n    border: 'none',\n    outline: 'none',\n    height: '36px',\n    fontSize: '15px',\n    cursor: 'pointer',\n    padding: '8px 16px',\n    borderRadius: '33px',\n    backgroundColor: '#1890ff'\n  },\n  dangerButton: (_dangerButton = {\n    color: 'red',\n    border: 'none',\n    outline: 'none',\n    height: '36px',\n    fontSize: '15px',\n    cursor: 'pointer',\n    padding: '8px 16px',\n    borderRadius: '33px',\n    backgroundColor: 'white'\n  }, _dangerButton[\"border\"] = '1px solid red', _dangerButton),\n  hoverButton: {\n    opacity: '0.66'\n  }\n};\n\nvar TextInput = /*#__PURE__*/function (_Component) {\n  _inheritsLoose(TextInput, _Component);\n\n  function TextInput() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _Component.call.apply(_Component, [this].concat(args)) || this;\n    _this.state = {\n      focused: false,\n      value: null\n    };\n    return _this;\n  }\n\n  var _proto = TextInput.prototype;\n\n  _proto.componentDidMount = function componentDidMount() {\n    var value = this.props[\"default\"];\n\n    if (value) {\n      var event = {\n        target: {\n          value: value\n        }\n      };\n      this.props.handleChange(event);\n      this.setState({\n        value: value\n      });\n    }\n  };\n\n  _proto.render = function render() {\n    var _this2 = this;\n\n    var customStyle = this.props.style ? this.props.style : {};\n    var defaultStyle = this.state.focused ? styles$o.focusInput : styles$o.input;\n    return /*#__PURE__*/React.createElement(\"input\", {\n      id: this.props.id,\n      autoFocus: this.props.autoFocus,\n      className: \"ce-input ce-text-input\",\n      value: this.props.value,\n      placeholder: this.props.label,\n      style: _extends({}, defaultStyle, customStyle),\n      onBlur: function onBlur() {\n        _this2.setState({\n          focused: false\n        });\n\n        _this2.props.onBlur && _this2.props.onBlur();\n      },\n      onFocus: function onFocus() {\n        _this2.setState({\n          focused: true\n        });\n\n        _this2.props.onFocus && _this2.props.onFocus();\n      },\n      type: this.props.type ? this.props.type : \"text\",\n      onChange: function onChange(e) {\n        return _this2.props.handleChange && _this2.props.handleChange(e);\n      }\n    });\n  };\n\n  return TextInput;\n}(Component);\n\nvar styles$o = {\n  input: {\n    height: '36px',\n    fontSize: '15px',\n    fontFamily: 'Avenir',\n    outline: 'none',\n    borderRadius: '24px',\n    border: '1px solid #d9d9d9',\n    padding: '0px 12px',\n    boxSizing: 'border-box'\n  },\n  focusInput: {\n    height: '36px',\n    fontSize: '15px',\n    fontFamily: 'Avenir',\n    outline: 'none',\n    borderRadius: '24px',\n    border: '1px solid #1890ff',\n    padding: '0px 12px',\n    boxSizing: 'border-box'\n  }\n};\n\nvar AutoComplete = /*#__PURE__*/function (_Component) {\n  _inheritsLoose(AutoComplete, _Component);\n\n  function AutoComplete() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _Component.call.apply(_Component, [this].concat(args)) || this;\n    _this.state = {\n      focused: false,\n      showAll: false\n    };\n    return _this;\n  }\n\n  var _proto = AutoComplete.prototype;\n\n  _proto.onFocus = function onFocus() {\n    this.onChange('', true);\n    this.setState({\n      focused: true\n    });\n    this.props.onFocus && this.props.onFocus();\n  };\n\n  _proto.onBlur = function onBlur() {\n    this.setState({\n      focused: false\n    });\n    this.props.onBlur && this.props.onBlur();\n  };\n\n  _proto.onChange = function onChange(value, showAll) {\n    this.setState({\n      showAll: showAll\n    });\n    this.props.handleChange && this.props.handleChange(value);\n  };\n\n  _proto.getNames = function getNames() {\n    var _this2 = this;\n\n    var count = 0;\n    var max = this.props.max ? this.props.max : 3;\n    var results = [];\n    this.props.options.map(function (option) {\n      if (JSON.stringify(option).toLowerCase().indexOf(_this2.props.value.toLowerCase()) !== -1 && count < max) {\n        count = count + 1;\n        results.push(option);\n      }\n    });\n    return results;\n  };\n\n  _proto.renderOptions = function renderOptions() {\n    var _this3 = this;\n\n    if (!this.props.value && !this.state.showAll) {\n      return /*#__PURE__*/React.createElement(\"div\", null);\n    }\n\n    var results = this.getNames();\n    return results.map(function (option, index) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        key: \"option_\" + index,\n        className: \"ce-autocomplete-option\"\n      }, _this3.props.renderOption && _this3.props.renderOption(option), index === results.length - 1 && /*#__PURE__*/React.createElement(\"div\", {\n        style: styles$p.close,\n        className: \"ce-autocomplete-close\",\n        onClick: function onClick() {\n          return _this3.onChange('', false);\n        }\n      }, /*#__PURE__*/React.createElement(CloseOutlined, null)));\n    });\n  };\n\n  _proto.render = function render() {\n    var _this4 = this;\n\n    var options = this.props.options;\n    var customStyle = this.props.style ? this.props.style : {};\n\n    var defaultStyle = _extends({}, styles$p.input, {\n      border: this.state.focused ? '1px solid #1890ff' : '1px solid #d9d9d9'\n    });\n\n    return /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(\"input\", {\n      id: \"ce-add-username-input\",\n      className: \"ce-input ce-autocomplete-input\",\n      value: this.props.value,\n      placeholder: this.props.label,\n      style: _extends({}, defaultStyle, customStyle),\n      type: this.props.type ? this.props.type : \"text\",\n      onBlur: function onBlur() {\n        return _this4.onBlur();\n      },\n      onFocus: function onFocus() {\n        return _this4.onFocus();\n      },\n      onChange: function onChange(e) {\n        return _this4.onChange(e.target.value, true);\n      }\n    }), options && options.length > 0 && this.state.showAll && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"ce-autocomplete-options\",\n      style: {\n        borderRadius: '19px',\n        border: '1px solid #afafaf',\n        overflow: 'hidden'\n      }\n    }, this.props.options && this.renderOptions()));\n  };\n\n  return AutoComplete;\n}(Component);\n\nvar styles$p = {\n  input: {\n    height: '36px',\n    fontSize: '15px',\n    outline: 'none',\n    borderRadius: '24px',\n    padding: '0px 12px',\n    boxSizing: 'border-box',\n    fontFamily: 'Avenir'\n  },\n  close: {\n    cursor: 'pointer',\n    textAlign: 'center',\n    padding: '8px 12px',\n    fontSize: '15px',\n    borderRadius: '24px'\n  }\n};\n\nfunction addPerson(props, chatId, userName, callback) {\n  axios.post(getApiUrl(props) + \"/chats/\" + chatId + \"/people/\", {\n    username: userName\n  }, {\n    headers: getHeaders(props)\n  }).then(function (response) {\n    callback && callback(response.data);\n  })[\"catch\"](function (error) {\n    console.log('New Person Error', error);\n  });\n}\n\nfunction removePerson(props, chatId, userName, callback) {\n  axios.put(getApiUrl(props) + \"/chats/\" + chatId + \"/people/\", {\n    username: userName\n  }, {\n    headers: getHeaders(props)\n  }).then(function (response) {\n    callback && callback(response.data);\n  })[\"catch\"](function (error) {\n    console.log('Delete Person Error', error);\n  });\n}\n\nfunction getOtherPeople(props, chatId, successCallback, errorCallback) {\n  axios.get(getApiUrl(props) + \"/chats/\" + chatId + \"/others/\", {\n    headers: getHeaders(props)\n  }).then(function (response) {\n    props.onGetOtherPeople && props.onGetOtherPeople(chatId, response.data);\n    successCallback && successCallback(chatId, response.data);\n  })[\"catch\"](function (error) {\n    console.log('Fetch Other People Error', error);\n    errorCallback && errorCallback();\n  });\n}\n\nfunction getMyData(props, callback) {\n  axios.get(getApiUrl(props) + \"/chats/me/\", {\n    headers: getHeaders(props)\n  }).then(function (response) {\n    callback && callback(response.data);\n  })[\"catch\"](function (error) {\n    console.log('Get Myself Error', error);\n  });\n}\n\nfunction editMyData(props, data, callback) {\n  axios.patch(getApiUrl(props) + \"/chats/me/\", data, {\n    headers: getHeaders(props)\n  }).then(function (response) {\n    callback && callback(response.data);\n  })[\"catch\"](function (error) {\n    console.log('Edit Myself Error', error);\n  });\n}\n\nfunction leaveChat(props, chatId, callback) {\n  axios[\"delete\"](getApiUrl(props) + \"/chats/\" + chatId + \"/people/\", {\n    headers: getHeaders(props)\n  }).then(function (response) {\n    callback && callback(response.data);\n  })[\"catch\"](function (error) {\n    console.log('Delete Person Error', error);\n  });\n}\n\nfunction isTyping(props, chatId, callback) {\n  axios.post(getApiUrl(props) + \"/chats/\" + chatId + \"/typing/\", {}, {\n    headers: getHeaders(props)\n  }).then(function (response) {\n    callback && callback(response.data);\n  })[\"catch\"](function (error) {});\n}\n\nexport { AutoComplete as AutoCompleteInput, Avatar, Button, ChatCard, ChatEngineApp as ChatEngine, ChatEngineContext, ChatEngineWrapper, ChatFeed, ChatHeader, ChatList, ChatSettings, ChatSettingsTop, ChatSocket, Dot, Message$1 as MessageBubble, NewChatForm, NewMessageForm$1 as NewMessageForm, OptionsSettings, PeopleSettings, PhotosSettings, Socket, TextInput, Typers, addPerson, deleteChat, deleteMessage, editChat, editMessage, editMyData, getChat, getChats, getLatestChats, getLatestMessages, getMessage, getMessages, getMyData, getOrCreateChat, getOtherPeople, isTyping, leaveChat, newChat, readMessage, removePerson, sendMessage };","map":{"version":3,"mappings":"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","names":["ChatEngineContext","createContext","ChatEngineWrapper","useState","connecting","setConnecting","conn","setConn","creds","setCreds","chats","setChats","messages","setMessages","sendingMessages","setSendingMessages","activeChat","setActiveChat","typingCounter","setTypingCounter","loadMoreMessages","setLoadMoreMessages","isBottomVisible","setIsBottomVisible","value","React","Provider","props","children","Socket","Date","now","reconnect","useContext","sortChats","Object","values","sort","a","b","aDate","last_message","created","bDate","onEditChat","chat","newChats","id","onConnect","getLatestChats","_","mapKeys","getLatestMessages","list","handleEvent","event","eventJSON","JSON","parse","action","console","log","projectID","userName","userSecret","undefined","onFailAuth","data","onNewChat","isEmpty","sortedChats","parseInt","onDeleteChat","onAddPerson","onRemovePerson","message","custom_json","indexOf","sender_id","newMessages","sender_username","readMessage","onNewMessage","onEditMessage","onDeleteMessage","person","newTypingCounter","onTyping","onClose","development","publicKey","userPassword","wsStart","rootHost","project","secret","WebSocket","url","onOpen","bind","_this","onMessage","reconnectIntervalInMilliSeconds","getApiUrl","getHeaders","chatID","chatAccessKey","getChats","callback","axios","get","str","headers","then","response","onGetChats","error","newChat","post","count","getOrCreateChat","put","getChat","chatId","editChat","patch","deleteChat","ChatLoader","useOnScreen","ref","isIntersecting","setIntersecting","observer","IntersectionObserver","entry","onVisible","useEffect","observe","current","disconnect","useRef","isVisible","NewChatForm","setValue","selected","setSelected","handleChange","target","handleSubmit","preventDefault","trim","length","title","style","styles","newChatContainer","className","onSubmit","TextInput","autoFocus","label","onBlur","width","e","height","fontWeight","fontSize","position","top","textAlign","Button","icon","onClick","padding","backgroundColor","timeSinceDate","date","day","substr","month","year","hour","minute","second","sent","setHours","setMinutes","setSeconds","toString","dayStr","timeStr","daySinceSent","ChatCard","readLastMessage","people","map","chat_person","username","last_read","extraStyle","otherPerson","find","is_direct_chat","lastMessage","text","attachments","chatContainer","titleText","borderRadius","display","messageText","paddingBottom","cursor","whiteSpace","overflow","color","border","interval","ChatList","didMountRef","hasMoreChats","setHasMoreChats","renderChats","index","key","renderChatCard","onChatClick","chatList","loadChats","renderChatList","chatListContainer","chatsContainer","renderNewChatForm","ChatForm","maxHeight","overflowX","borderRight","fontFamily","getMessages","onGetMessages","sendMessage","formdata","FormData","i","append","name","files","stringify","getMessage","messageId","editMessage","deleteMessage","AuthFail","paddingTop","src","alt","paddingLeft","href","Welcome","ConnectionBar","zIndex","bottom","left","SyncOutlined","spin","ChatListDrawer","isOpen","setIsOpen","MenuOutlined","outline","drawerContainer","CloseOutlined","closeIcon","titleContainer","Person","removePerson","renderPersonText","first_name","last_name","onMouseEnter","onMouseLeave","Avatar","avatar","is_online","admin","theme","Option","focused","setFocused","option","PersonForm","others","state","setState","invitePerson","addPerson","getOthers","getOtherPeople","renderOption","marginBottom","AutoCompleteInput","options","onFocus","PeopleSettings","collapsed","hovered","renderChatPeople","chatPerson","borderTop","LeftOutlined","collapseIcon","DownOutlined","right","Thumbnail","attachment","container","image","file","objectFit","PhotosSettings","renderPhotos","OptionsSettings","NewMessageForm","ChatSettingsTop","topPeople","slice","getOtherPerson","renderOnePerson","show_online","renderTwoPeople","renderThreePeople","TitleForm","ChatSettings","renderChatSettings","filler","settingsContainer","renderChatSettingsTop","renderPeopleSettings","renderPhotosSettings","renderOptionsSettings","borderLeft","ChatSettingsDrawer","SettingOutlined","setConfiguration","maxScreenClass","gutterWidth","ChatHeader","Row","titleSection","Col","xs","sm","mobileOptiom","subtitleText","RenderTrigger","onEnter","onLeave","months","suffix","DatePartition","getDate","formatDate","date_time","dayDuffix","time","timeSuffix","String","lastCreated","lastDate","thisDate","dateText","setHovered","thumbnail","loadingContainer","LoadingOutlined","window","open","marginRight","maxWidth","minHeight","minWidth","paddingRight","colors","stringToNumber","sum","charCodeAt","stringToColor","Dot","updateImg","split","componentDidMount","componentDidUpdate","render","customStyle","dot","backgroundImage","backgroundRepeat","backgroundPosition","backgroundSize","Component","Message","renderReads","marginLeft","renderAttachments","nextMessage","topRightRadius","bottomRightRadius","md","myMessage","TheirMessage","topLeftRadius","bottomLeftRadius","nameText","sender","theirMessage","cusor","SendingMessage","sending","senderUsername","MyMessage","Messages","keys","lastMessageKey","nextMessageKey","renderMessageBubble","MessageBubble","SendingMessages","Typers","typers","renderIsTyping","currentTime","blob","setBlob","URL","createObjectURL","imageSquare","CloseCircleTwoTone","onRemove","FileRow","renderFiles","ImagesInput","onSelect","Array","from","onSelectFiles","encType","htmlFor","PaperClipOutlined","multiple","accept","visibility","type","onChange","MessageInput","resize","textarea","document","getElementById","Math","min","scrollHeight","onKeyDown","input","overflowY","rows","placeholder","_this2","trigger","mod","splice","isTyping","newSendingMessages","NewMessageFormContainer","inputContainer","initial","ChatFeed","duration","setDuration","currentChat","setCurrentChat","setCurrentTime","onReadMessage","scrollDownTo","animateScroll","scrollToBottom","containerId","loadMessages","setTimeout","setInterval","renderChatFeed","renderChatHeader","feedContainer","renderNewMessageForm","ChatEngine","context","propsAndContext","ChatEngineApp","ChatSocket","onGetChat","substring","toUpperCase","avatarText","status","hoverStyle","hoverButton","themeStyle","dangerButton","button","PlusOutlined","ArrowUpOutlined","DeleteOutlined","UserAddOutlined","opacity","defaultStyle","focusInput","boxSizing","AutoComplete","showAll","getNames","max","results","toLowerCase","push","renderOptions","_this3","close","_this4","successCallback","errorCallback","onGetOtherPeople","getMyData","editMyData","leaveChat"],"sources":["../src/components/Context/index.js","../src/components/Socket/index.js","../src/actions/index.js","../src/actions/auth.js","../src/actions/chats/getChats.js","../src/actions/chats/newChat.js","../src/actions/chats/getLatestChats.js","../src/actions/chats/getOrCreateChat.js","../src/actions/chats/getChat.js","../src/actions/chats/editChat.js","../src/actions/chats/deleteChat.js","../src/components/ChatEngine/ChatList/ChatLoader.js","../src/components/ChatEngine/ChatList/NewChatForm/index.js","../src/components/ChatEngine/Utilities/dateToString.js","../src/components/ChatEngine/ChatList/ChatCard.js","../src/components/ChatEngine/ChatList/index.js","../src/actions/messages/getMessages.js","../src/actions/messages/getLatestMessages.js","../src/actions/messages/sendMessage.js","../src/actions/messages/getMessage.js","../src/actions/messages/editMessage.js","../src/actions/messages/readMessage.js","../src/actions/messages/deleteMessage.js","../src/components/ChatEngine/ChatFeed/Steps/AuthFail.js","../src/components/ChatEngine/ChatFeed/Steps/Welcome.js","../src/components/ChatEngine/ChatFeed/Steps/ConnectionBar.js","../src/components/ChatEngine/ChatFeed/ChatHeader/ChatListDrawer.js","../src/components/ChatEngine/ChatSettings/PeopleSettings/Person.js","../src/components/ChatEngine/ChatSettings/PeopleSettings/PersonForm/Option.js","../src/components/ChatEngine/ChatSettings/PeopleSettings/PersonForm/index.js","../src/components/ChatEngine/ChatSettings/PeopleSettings/index.js","../src/components/ChatEngine/ChatSettings/PhotosSettings/Thumbnail.js","../src/components/ChatEngine/ChatSettings/PhotosSettings/index.js","../src/components/ChatEngine/ChatSettings/OptionsSettings/index.js","../src/components/ChatEngine/ChatSettings/ChatSettingsTop/TitleForm/index.js","../src/components/ChatEngine/ChatSettings/ChatSettingsTop/index.js","../src/components/ChatEngine/ChatSettings/index.js","../src/components/ChatEngine/ChatFeed/ChatHeader/ChatSettingsDrawer.js","../src/components/ChatEngine/ChatFeed/ChatHeader/index.js","../src/components/ChatEngine/ChatFeed/Triggers/RenderTrigger.js","../src/components/ChatEngine/ChatFeed/Messages/MessageBubbles/DatePartition.js","../src/components/ChatEngine/ChatFeed/Messages/MessageBubbles/Thumbnail.js","../src/components/ChatEngine/Utilities/colorMapping.js","../src/components/ChatEngine/components/Avatar/Dot.js","../src/components/ChatEngine/ChatFeed/Messages/MessageBubbles/MyMessage.js","../src/components/ChatEngine/ChatFeed/Messages/MessageBubbles/TheirMessage.js","../src/components/ChatEngine/ChatFeed/Messages/MessageBubbles/SendingMessage.js","../src/components/ChatEngine/ChatFeed/Messages/MessageBubbles/index.js","../src/components/ChatEngine/ChatFeed/Messages/index.js","../src/components/ChatEngine/ChatFeed/Messages/SendingMessages.js","../src/components/ChatEngine/ChatFeed/Typers.js","../src/components/ChatEngine/ChatFeed/NewMessageForm/Thumbnail.js","../src/components/ChatEngine/ChatFeed/NewMessageForm/FileRow.js","../src/components/ChatEngine/ChatFeed/NewMessageForm/ImagesInput.js","../src/components/ChatEngine/ChatFeed/NewMessageForm/MessageInput.js","../src/components/ChatEngine/ChatFeed/NewMessageForm/index.js","../src/components/ChatEngine/ChatFeed/index.js","../src/components/ChatEngine/index.js","../src/components/index.js","../src/components/Socket/ChatSocket.js","../src/components/ChatEngine/components/Avatar/Avatar.js","../src/components/ChatEngine/components/Button/Button.js","../src/components/ChatEngine/components/Input/TextInput.js","../src/components/ChatEngine/components/Input/AutocompleteInput.js","../src/actions/people/addPerson.js","../src/actions/people/removePerson.js","../src/actions/people/getOtherPeople.js","../src/actions/people/getMyData.js","../src/actions/people/editMyData.js","../src/actions/people/leaveChat.js","../src/actions/typing/isTyping.js"],"sourcesContent":["import React, { useState, createContext } from 'react'\n\nexport const ChatEngineContext = createContext()\n\nexport const ChatEngineWrapper = props => {\n    const [connecting, setConnecting] = useState(true)\n    const [conn, setConn] = useState(null)\n    const [creds, setCreds] = useState(null)\n    const [chats, setChats] = useState(null)\n    const [messages, setMessages] = useState({})\n    const [sendingMessages, setSendingMessages] = useState({})\n    const [activeChat, setActiveChat] = useState(null)\n    const [typingCounter, setTypingCounter] = useState({})\n    const [loadMoreMessages, setLoadMoreMessages] = useState(false)\n    const [isBottomVisible, setIsBottomVisible] = useState(false)\n\n    const value = {\n        connecting, setConnecting,\n        conn, setConn,\n        creds, setCreds,\n        chats, setChats,\n        messages, setMessages,\n        sendingMessages, setSendingMessages,\n        activeChat, setActiveChat,\n        typingCounter, setTypingCounter,\n        loadMoreMessages, setLoadMoreMessages,\n        isBottomVisible, setIsBottomVisible,\n    }\n\n    return (\n        <ChatEngineContext.Provider value={value}>\n            {props.children}\n        </ChatEngineContext.Provider>\n    )\n}\n","import React, { useContext, useState } from 'react'\n\nimport { ChatEngineContext } from '../Context'\n\nimport { getLatestChats, getLatestMessages, readMessage } from 'react-chat-engine'\n\nimport { WebSocket } from 'nextjs-websocket'\n\nconst Socket = props => {\n    const [reconnect, reset] = useState(Date.now() + 10000)\n    const {\n      setConnecting,\n      conn, setConn, setCreds,\n      chats, setChats,\n      messages, setMessages,\n      sendingMessages, setSendingMessages,\n      activeChat, setActiveChat,\n      typingCounter, setTypingCounter,\n    } = useContext(ChatEngineContext)\n\n    function sortChats(chats) {\n        return Object.values(chats).sort((a, b) => { \n            const aDate = a.last_message.created ? new Date(a.last_message.created) : new Date(a.created)\n            const bDate = b.last_message.created ? new Date(b.last_message.created) : new Date(b.created)\n            return new Date(bDate) - new Date(aDate); \n        })\n    }\n\n    // Common Context Handlers\n\n    function onEditChat(chat) {\n        if (chats) {\n            const newChats = {...chats}\n            newChats[chat.id] = chat\n            setChats(newChats)\n        }\n\n        props.onEditChat && props.onEditChat(chat)\n    }\n\n    function onConnect(conn) {\n        setConn(conn); setCreds(conn);\n        setConnecting(false)\n\n        getLatestChats(conn, 25, (chats) => setChats(_.mapKeys(chats, 'id')))\n\n        if (Date.now() > reconnect) {\n            getLatestMessages(\n                conn, activeChat, 45,\n                (id, list) => {\n                    setMessages({...messages, ..._.mapKeys(list, 'id')})\n                }\n            )\n        }\n        \n        props.onConnect && props.onConnect(conn)\n    }\n    \n    // Socket Events\n\n    function handleEvent(event) {\n        const eventJSON = JSON.parse(event)\n\n        if (eventJSON.action === 'login_error') {\n            console.log(\n                `Your login credentials were not correct: \\n\n                Project ID: ${props.projectID} \\n\n                Username: ${props.userName} \\n\n                User Secret: ${props.userSecret}\\n\n                Double check these credentials to make sure they're correct.\\n\n                If all three are correct, try resetting the username and secret in the Online Dashboard or Private API.`\n            )\n\n            setConn(undefined); setCreds(undefined);\n\n            props.onFailAuth && props.onFailAuth(conn)\n\n        } else if (eventJSON.action === 'new_chat') {\n            const chat = eventJSON.data\n            \n            if (chats) {\n                const newChats = {...chats}\n                newChats[chat.id] = chat\n                setChats(newChats)\n                setActiveChat(chat.id)\n            }\n\n            props.onNewChat && props.onNewChat(eventJSON.data)\n\n        } else if (eventJSON.action === 'edit_chat') {\n            onEditChat(eventJSON.data)\n            \n        } else if (eventJSON.action === 'delete_chat') {\n            const chat = eventJSON.data \n\n            if (chats) {\n                chats[chat.id] = undefined\n                \n                setChats(chats)\n          \n                if (!_.isEmpty(chats)) {\n                    const sortedChats = sortChats(chats)\n                    setActiveChat(sortedChats[0] ? parseInt(sortedChats[0].id) : 0)\n                }\n            }\n\n            props.onDeleteChat && props.onDeleteChat(chat)\n\n        } else if (eventJSON.action === 'add_person') {\n            onEditChat(eventJSON.data)\n            \n            props.onAddPerson && props.onAddPerson(eventJSON.data)\n\n        } else if (eventJSON.action === 'remove_person') {\n            onEditChat(eventJSON.data)\n\n            props.onRemovePerson && props.onRemovePerson(eventJSON.data)\n\n        } else if (eventJSON.action === 'new_message') {\n            const { id, message } = eventJSON.data\n\n            if (typeof message.custom_json === \"string\" && message.custom_json.indexOf('sender_id') !== -1) {\n                sendingMessages[JSON.parse(message.custom_json).sender_id] = undefined\n                setSendingMessages(sendingMessages)\n            }\n        \n            if (id === activeChat) {\n                const newMessages = {...messages}\n                newMessages[message.id] = message\n                setMessages(newMessages)\n            }\n          \n            if (message.sender_username !== props.userName) {\n                readMessage(conn, activeChat, message.id, (chat) => onEditChat(chat))\n            }\n\n            props.onNewMessage && props.onNewMessage(id, message)\n\n        } else if (eventJSON.action === 'edit_message') {\n            const { id, message } = eventJSON.data\n            \n            if (id === activeChat) {\n                messages[message.id] = message\n                setMessages(messages)\n            }\n\n            props.onEditMessage && props.onEditMessage(id, message)\n\n        } else if (eventJSON.action === 'delete_message') {\n            const { id, message } = eventJSON.data\n\n            if (id === activeChat) {\n                messages[message.id] = undefined\n                setMessages(messages)\n            }\n\n            props.onDeleteMessage && props.onDeleteMessage(id, message)\n        \n        } else if (eventJSON.action === 'is_typing') {\n            const { id, person } = eventJSON.data\n            let newTypingCounter = {...typingCounter}\n            newTypingCounter = {\n                ...newTypingCounter,\n                [id]: {\n                    ...newTypingCounter[id],\n                    [person]: Date.now()\n                }\n            }\n                \n            setTypingCounter(newTypingCounter)\n                \n            props.onTyping && props.onTyping(id, person)\n        }\n    }\n\n    function onClose() { setConnecting(true) }\n\n    // Render\n    \n    const { \n        development,\n        publicKey, projectID, \n        userName, \n        userPassword, userSecret, \n    } = props \n    \n    const wsStart = development ? 'ws://' : 'wss://'\n    const rootHost = development ? '127.0.0.1:8000' : 'api.chatengine.io'\n    const project = publicKey ? publicKey : projectID\n    const secret = userPassword ? userPassword : userSecret\n\n    return <WebSocket \n        url={`${wsStart}${rootHost}/person/?publicKey=${project}&username=${userName}&secret=${secret}`}\n        onOpen={() => onConnect(props)}\n        onClose={onClose.bind(this)}\n        onMessage={handleEvent.bind(this)}\n        reconnectIntervalInMilliSeconds={3000}\n    />\n}\n\nexport default Socket","export function getApiUrl(props) { \n    if (props && props.development) {\n        return 'http://127.0.0.1:8000'\n    }\n    return 'https://api.chatengine.io'\n}\n","export function getHeaders(props) { \n    if (props.chatID) {\n        return { \n            \"public-key\": props.publicKey ? props.publicKey : props.projectID,\n            \"chat-id\": props.chatID,\n            \"access-key\": props.chatAccessKey,\n        }\n    }\n\n    return { \n        \"Public-Key\": props.publicKey ? props.publicKey : props.projectID,\n        \"User-Name\": props.userName,\n        \"User-Secret\": props.userPassword ? props.userPassword : props.userSecret,\n    }\n}\n","import axios from 'axios'\nimport * as str from '../../actions'\nimport { getHeaders } from '../auth'\n\nexport function getChats(props, callback) {\n    axios.get(\n        `${str.getApiUrl(props)}/chats/`,\n        { headers: getHeaders(props) }\n    )\n\n    .then((response) => {\n        // Run hook in Axios on GET requests\n        props.onGetChats && props.onGetChats(response.data)\n\n        callback && callback(response.data)\n    })\n    \n    .catch((error) => {\n        console.log('Fetch Chats Error', error)\n    });\n}","import axios from 'axios'\nimport * as str from '../../actions'\nimport { getHeaders } from '../auth'\n\nexport function newChat(props, data, callback) {\n    axios.post(\n        `${str.getApiUrl(props)}/chats/`,\n        data, \n        { headers: getHeaders(props) }\n    )\n\n    .then((response) => {\n        callback && callback(response.data)\n    })\n    \n    .catch((error) => {\n        console.log('New Chat Error', error)\n    });\n}","import axios from 'axios'\nimport * as str from '../../actions'\nimport { getHeaders } from '../auth'\n\nexport function getLatestChats(props, count, callback) {\n    axios.get(\n        `${str.getApiUrl(props)}/chats/latest/${count}/`,\n        { headers: getHeaders(props) }\n    )\n\n    .then((response) => {\n        // Run hook in Axios on GET requests\n        props.onGetChats && props.onGetChats(response.data)\n\n        callback && callback(response.data)\n    })\n    \n    .catch((error) => {\n        console.log('Fetch Chats Error', error)\n    });\n}","import axios from 'axios'\nimport * as str from '../../actions'\nimport { getHeaders } from '../auth'\n\nexport function getOrCreateChat(props, data, callback) {\n    axios.put(\n        `${str.getApiUrl(props)}/chats/`,\n        data,\n        { headers: getHeaders(props) }\n    )\n\n    .then((response) => {\n        callback && callback(response.data)\n    })\n    \n    .catch((error) => {\n        console.log('Get or Create Chat Error', error)\n    });\n}","import axios from 'axios'\nimport * as str from '../../actions'\nimport { getHeaders } from '../auth'\n\nexport function getChat(props, chatId, callback) {\n    axios.get(\n        `${str.getApiUrl(props)}/chats/${chatId}/`,\n        { headers: getHeaders(props) }\n    )\n\n    .then((response) => {\n        callback && callback(response.data)\n    })\n    \n    .catch((error) => {\n        console.log('Get Chat Error', error)\n    });\n}","import axios from 'axios'\nimport * as str from '../../actions'\nimport { getHeaders } from '../auth'\n\nexport function editChat(props, chatId, data, callback) {\n    axios.patch(\n        `${str.getApiUrl(props)}/chats/${chatId}/`,\n        data, \n        { headers: getHeaders(props) }\n    )\n\n    .then((response) => {\n        callback && callback(response.data)\n    })\n    \n    .catch((error) => {\n        console.log('Edit Chat Error', error)\n    });\n}","import axios from 'axios'\nimport * as str from '../../actions'\nimport { getHeaders } from '../auth'\n\nexport function deleteChat(props, chatId, callback) {\n    axios.delete(\n        `${str.getApiUrl(props)}/chats/${chatId}/`,\n        { headers: getHeaders(props) }\n    )\n\n    .then((response) => {\n        callback && callback(response.data)\n    })\n    \n    .catch((error) => {\n        console.log('Delete Chat Error', error)\n    });\n}","import React, { useState, useRef, useEffect } from 'react'\n\nconst ChatLoader = props => {\n    function useOnScreen(ref) {\n        const [isIntersecting, setIntersecting] = useState(false)\n      \n        const observer = new IntersectionObserver(\n            ([entry]) => {\n                setIntersecting(entry.isIntersecting)\n                if (entry.isIntersecting) {\n                    props.onVisible()\n                }\n            }\n        )\n      \n        useEffect(() => {\n          observer.observe(ref.current)\n          // Remove the observer as soon as the component is unmounted\n          return () => { observer.disconnect() }\n        }, [])\n      \n        return isIntersecting\n    }\n  \n    const ref = useRef()\n    const isVisible = useOnScreen(ref)\n    \n    return <div ref={ref} />\n}\n\nexport default ChatLoader","import React, { useState, useContext } from 'react'\n\nimport { ChatEngineContext } from '../../../Context'\n\nimport { newChat } from 'react-chat-engine'\n\nimport { Button, TextInput } from 'react-chat-engine'\n\nconst NewChatForm = () => {\n  const { conn } = useContext(ChatEngineContext)\n  const [value, setValue] = useState('')\n  const [selected, setSelected] = useState(false)\n  \n  function handleChange(event) {\n    setValue(event.target.value)\n  }\n\n  function handleSubmit(event) {\n    event.preventDefault()\n\n    if (value.trim().length > 0) {\n      newChat(\n        conn, \n        { title: value },\n        () => setSelected(false)\n      )\n    }\n\n    setValue('')\n  }\n\n  return (\n    <div style={styles.newChatContainer} className='ce-chat-form-container'>\n        {\n          selected ?\n          <form onSubmit={handleSubmit.bind(this)}> \n              <TextInput \n                autoFocus\n                label='Chat Title'\n                value={value}\n                id='ce-new-chat-title-field'\n                onBlur={() => setSelected(false)}\n                style={{ width: '100%' }}\n                handleChange={(e) => handleChange(e)}\n              />\n          </form>:\n          <div>\n            <div style={{ height: '0px' }}>\n              <div style={{ fontWeight: '600', fontSize: '24px', position: 'relative', top: '4px', width:' calc(100% - 48px)' }}>\n                My Chats\n              </div>\n            </div>\n\n            <div style={{ width: '100%', textAlign: 'right' }}>\n              <Button \n                icon='plus'\n                id='new-chat-plus-button'\n                onClick={() => setSelected(true)}\n              />\n            </div>\n          </div>\n        }\n    </div>\n  )\n}\n\nexport default NewChatForm\n\nconst styles = {\n  newChatContainer: { \n    padding: '16px 14px',\n    backgroundColor: 'white'\n  }\n}","export function timeSinceDate(date) {\n    if (!date) return ''\n\n    const day = date.substr(8,2)\n    const month = date.substr(5,2)\n    const year = date.substr(0,4)\n\n    const hour = date.substr(11,2)\n    const minute = date.substr(14,2)\n    const second = date.substr(17,2)\n\n    var sent = new Date(`${month} ${day} ${year}`)\n    sent.setHours(hour)\n    sent.setMinutes(minute)\n    sent.setSeconds(second)\n    sent = sent.toString()\n\n    const dayStr = sent.substr(0, 10)\n    const timeStr = sent.substr(15, 6)\n    return `${dayStr} at ${timeStr}`\n}\n\nexport function daySinceSent(date) {\n    if (!date) return ''\n    const day = date.substr(8,2)\n    const month = date.substr(5,2)\n    const year = date.substr(0,4)\n    const sent = new Date(`${month} ${day} ${year}`).toString()\n    return sent.substr(4, 6)\n}\n","import React, { useContext } from 'react'\n\nimport { ChatEngineContext } from '../../Context'\n\nimport _ from 'lodash'\n\nimport { daySinceSent } from '../Utilities/dateToString'\n\nconst ChatCard = props => {\n    const { conn, activeChat, setActiveChat } = useContext(ChatEngineContext)\n\n    if (!conn || conn === null) return <div/>\n\n    function readLastMessage(chat) {\n        let readLastMessage = true\n        chat.people.map(chat_person => {\n            if(conn.userName === chat_person.person.username) {\n                readLastMessage = chat.last_message.id === chat_person.last_read\n            }\n        })\n        return readLastMessage\n    }\n\n    const { chat } = props\n    const extraStyle = activeChat === chat.id ? styles.activeChat : {}\n    const otherPerson = chat.people.find(person => person.person.username !== conn.userName);\n    const title = chat.is_direct_chat && otherPerson ? otherPerson.person.username : chat.title\n    \n    let lastMessage = chat.last_message.text\n    if (!lastMessage) {\n        lastMessage = chat.last_message.attachments.length > 0 ?\n        `${chat.last_message.attachments.length} image${chat.last_message.attachments.length > 1 ? 's' : ''}` :\n        'Say hello!'\n    }\n\n    return (\n        <div \n            onClick={() => setActiveChat(chat.id)}\n            style={{ ...styles.chatContainer, ...extraStyle }}\n            className={`ce-chat-card ${activeChat === chat.id && 'ce-active-chat-card'}`}\n        >\n            <div \n                style={ styles.titleText } \n                className='ce-chat-title-text'\n                id={`ce-chat-card-title-${title}`}\n            >\n                { title }\n                \n                {\n                    !readLastMessage(chat) &&\n                    <div \n                        className='ce-chat-unread-dot'\n                        style={{ \n                            float: 'right',\n                            width: '12px',\n                            height: '12px',\n                            borderRadius: '6px',\n                            backgroundColor: '#1890ff',\n                            display: 'inline-block'\n                        }} \n                    />\n                }\n            </div>\n\n            <div style={{ width: '100%' }} className='ce-chat-subtitle'>\n                <div style={styles.messageText} className='ce-chat-subtitle-text ce-chat-subtitle-message'>\n                    { lastMessage }\n                </div>\n\n                <div \n                    className='ce-chat-subtitle-text ce-chat-subtitle-date'\n                    style={{ ...styles.messageText, ...{ textAlign: 'right', width: '25%' } }}\n                >\n                    { daySinceSent(chat.last_message.created) }\n                </div>\n            </div>\n        </div>\n    )\n}\n\nconst styles={\n    chatContainer: { \n        padding: '16px', \n        paddingBottom: '12px',\n        cursor: 'pointer'\n    },\n    titleText: { \n        fontWeight: '500',\n         paddingBottom: '4px', \n         whiteSpace: 'nowrap', \n         overflow: 'hidden' \n    },\n    messageText: {\n        width: '75%',\n        color: 'rgba(153, 153, 153, 1)', \n        fontSize: '14px', \n        whiteSpace: 'nowrap', \n        overflow: 'hidden',\n        display: 'inline-block'\n    },\n    activeChat: {\n        backgroundColor: '#d9d9d9',\n        border: '4px solid white',\n        borderRadius: '12px'\n    },\n}\n\nexport default ChatCard;\n","import React, { useContext, useEffect, useRef, useState } from 'react'\n\nimport { ChatEngineContext } from '../../Context'\n\nimport { getLatestChats } from '../../../actions/chats'\n\nimport _ from 'lodash'\n\nimport ChatLoader from './ChatLoader'\n\nimport ChatForm from './NewChatForm'\nimport ChatCard from './ChatCard'\n\nlet count = 25\nconst interval = 25\n\nconst ChatList = props => {\n    const didMountRef = useRef(false)\n    const [hasMoreChats, setHasMoreChats] = useState(true)\n    const { conn, chats, setChats, activeChat, setActiveChat } = useContext(ChatEngineContext)\n\n    function renderChats(chats) {\n        return chats.map((chat, index) => {\n            if (!chat) {\n                return <div key={`chat_${index}`} />\n\n            } else if (props.renderChatCard) {\n                return <div key={`chat_${index}`}>{props.renderChatCard(chat, index)}</div>\n                \n            } else {\n                return (\n                    <div \n                        key={`chat_${index}`}\n                        onClick={() => props.onChatClick && props.onChatClick()}\n                    >\n                        <ChatCard chat={chat} />\n                    </div>\n                )\n            }\n        })\n    }\n\n    function sortChats(chats) {\n        return chats.sort((a, b) => { \n            const aDate = a.last_message.created ? new Date(a.last_message.created) : new Date(a.created)\n            const bDate = b.last_message.created ? new Date(b.last_message.created) : new Date(b.created)\n            return new Date(bDate) - new Date(aDate); \n        })\n    }\n\n    function onGetChats(chats, count) {\n        const chatList = sortChats(chats)\n    \n        if (chatList.length > 0 && activeChat === null) {\n            setActiveChat(chatList[0].id)\n        }\n\n        if(count && count > chatList.length) { setHasMoreChats(false) }\n        \n        const newChats = {...chats}\n        setChats(_.mapKeys(newChats, 'id'))\n    }\n\n    useEffect(() => {\n        if (!didMountRef.current) {\n            didMountRef.current = true\n            getLatestChats(props, interval, (chats) => onGetChats(chats))\n        }\n    })\n\n    function loadChats() {\n        count = count + interval\n        getLatestChats(props, count, (chats) => onGetChats(chats, count))\n    }\n\n    const chatList = sortChats(chats ? Object.values(chats) : [])\n\n    if (props.renderChatList) return props.renderChatList(props)\n\n    return (\n        <div style={styles.chatListContainer} className='ce-chat-list'>\n            <div style={styles.chatsContainer} className='ce-chats-container'>\n                { props.renderNewChatForm ? props.renderNewChatForm(conn) : <ChatForm  /> }\n\n                { renderChats(chatList) } \n\n                { hasMoreChats && chatList.length > 0 && <ChatLoader onVisible={() => loadChats()} /> }\n            </div>\n        </div>\n    )\n}\n\nconst styles={\n    chatListContainer: { \n        height: '100%', \n        maxHeight: '100vh', \n        overflow: 'scroll', \n        overflowX: 'hidden',\n        borderRight: '1px solid #afafaf', \n        backgroundColor: 'white',\n        fontFamily: 'Avenir'\n    },\n    chatsContainer: { \n        width: '100%', \n        height: '100%',\n        backgroundColor: 'white', \n        borderRadius: '0px 0px 24px 24px'\n    },\n}\n\nexport default ChatList;\n","import axios from 'axios'\nimport * as str from '../../actions'\nimport { getHeaders } from '../auth'\n\nexport function getMessages(props, chatId, callback) {\n    axios.get(\n        `${str.getApiUrl(props)}/chats/${chatId}/messages/`,\n        { headers: getHeaders(props) }\n    )\n\n    .then((response) => {\n        // Run hook in Axios on GET requests\n        props.onGetMessages && props.onGetMessages(chatId, response.data)\n\n        callback && callback(chatId, response.data)\n    })\n    \n    .catch((error) => {\n        console.log('Fetch Messages Error', error)\n    });\n}","import axios from 'axios'\nimport * as str from '../../actions'\nimport { getHeaders } from '../auth'\n\nexport function getLatestMessages(props, chatId, count, callback) {\n    axios.get(\n        `${str.getApiUrl(props)}/chats/${chatId}/messages/latest/${count}/`,\n        { headers: getHeaders(props) }\n    )\n\n    .then((response) => {\n        props.onGetMessages && props.onGetMessages(chatId, response.data)\n\n        callback && callback(chatId, response.data)\n    })\n    \n    .catch((error) => {\n        console.log('Fetch Latest Messages Error', error)\n    });\n}","import axios from 'axios'\nimport * as str from '../../actions'\nimport { getHeaders } from '../auth'\n\nexport function sendMessage(props, chatId, data, callback) {\n    let formdata = new FormData()\n    \n    if (data.attachments) {\n        for (let i = 0; i < data.attachments.length; i++) { \n            formdata.append('attachments', data.attachments[i], data.attachments[i].name)\n        }\n    } else if (data.files) {\n        for (let i = 0; i < data.files.length; i++) { \n            formdata.append('attachments', data.files[i], data.files[i].name)\n        }\n    }\n\n    formdata.append('text', data.text)\n    formdata.append('sender_username', data.sender_username)\n    formdata.append('custom_json', JSON.stringify(data.custom_json ? data.custom_json : {}))\n    \n    axios.post(\n        `${str.getApiUrl(props)}/chats/${chatId}/messages/`,\n        formdata,\n        { headers: getHeaders(props) }\n    )\n\n    .then((response) => {\n        callback && callback(response.data)\n    })\n    \n    .catch((error) => {\n        console.log('Send Messages Error', error)\n    });\n    \n}","import axios from 'axios'\nimport * as str from '../../actions'\nimport { getHeaders } from '../auth'\n\nexport function getMessage(props, chatId, messageId, callback) {\n    axios.get(\n        `${str.getApiUrl(props)}/chats/${chatId}/messages/${messageId}/`,\n        { headers: getHeaders(props) }\n    )\n\n    .then((response) => {\n        callback && callback(chatId, response.data)\n    })\n    \n    .catch((error) => {\n        console.log('Fetch Message Error', error)\n    });\n}","import axios from 'axios'\nimport * as str from '../../actions'\nimport { getHeaders } from '../auth'\n\nexport function editMessage(props, chatId, messageId, data, callback) {\n    axios.patch(\n        `${str.getApiUrl(props)}/chats/${chatId}/messages/${messageId}/`,\n        data,\n        { headers: getHeaders(props) }\n    )\n\n    .then((response) => {\n        callback && callback(response.data)\n    })\n    \n    .catch((error) => {\n        console.log('Delete Messages Error', error)\n    });\n}","import axios from 'axios'\nimport * as str from '../../actions'\nimport { getHeaders } from '../auth'\n\nexport function readMessage(props, chatId, messageId, callback) {\n    axios.patch(\n        `${str.getApiUrl(props)}/chats/${chatId}/people/`,\n        { last_read: messageId },\n        { headers: getHeaders(props) }\n    )\n\n    .then((response) => {\n        callback && callback(response.data)\n    })\n    \n    .catch((error) => {\n        console.log('Read Message Error', error)\n    });\n}","import axios from 'axios'\nimport * as str from '../../actions'\nimport { getHeaders } from '../auth'\n\nexport function deleteMessage(props, chatId, messageId, callback) {\n    axios.delete(\n        `${str.getApiUrl(props)}/chats/${chatId}/messages/${messageId}/`,\n        { headers: getHeaders(props) }\n    )\n\n    .then((response) => {\n        callback && callback(response.data)\n    })\n    \n    .catch((error) => {\n        console.log('Delete Messages Error', error)\n    });\n}","import React from 'react'\n\nconst AuthFail = () => {\n    return (\n        <div style={{ height: '100%', textAlign: 'center' }}>\n            \n            <div style={{ width: '100%' }}>\n                <img\n                    style={{ width: '40%', paddingTop: '25vh' }}\n                    src='https://chat-engine-assets.s3.amazonaws.com/denied.svg'\n                    alt='welcome-to-chat-engine'\n                />\n            </div>\n\n            <div style={{ fontSize: '18px', paddingTop: '24px', width: '75%', paddingLeft: '12.5%' }}>\n                Your credentials are incorrect. Make sure your Public Key, Username, and Password are correct at <a href='https://chatengine.io'>chatengine.io</a>\n            </div>\n\n        </div>\n    )\n}\n\nexport default AuthFail","import React from 'react'\n\nconst Welcome = () => {\n    return (\n        <div style={{ height: '100%', textAlign: 'center' }}>\n\n            <div style={{ width: '100%' }}>                    \n                <img\n                    style={{ width: '60%', paddingTop: '33vh' }}\n                    src='https://chat-engine-assets.s3.amazonaws.com/welcome.svg'\n                    alt='welcome-to-chat-engine'\n                />\n            </div>\n\n            <div style={{ fontSize: '18px', paddingTop: '24px', width: '75%', paddingLeft: '12.5%' }}>\n                Fill out the \"New Chat\" form to get started.\n            </div>\n\n        </div>\n    )\n}\n\nexport default Welcome\n","import React, { useContext } from 'react'\n\nimport { ChatEngineContext } from '../../../Context'\n\nimport { SyncOutlined } from '@ant-design/icons'\n\nconst ConnectionBar  = () => {\n    const { connecting } = useContext(ChatEngineContext)\n\n    if (!connecting) return <div />\n\n    return (\n        <div \n            style={{ \n                zIndex: '1',\n                bottom: '66px', \n                left: 'calc(50% - 78px)',\n                position: 'absolute', \n                fontSize: '15px',\n                padding: '10px 22px', \n                color: 'white',\n                backgroundColor: '#fa8c16',\n                borderRadius: '1.3em',\n            }}\n            id='ce-connecting-popup'\n        >\n            <SyncOutlined spin />\n            {' '}\n            Connecting\n        </div>\n    )\n}\n\nexport default ConnectionBar\n","import React, { useState } from 'react'\n\nimport { MenuOutlined, CloseOutlined } from '@ant-design/icons'\n\nimport ChatList from '../../ChatList'\n\nconst ChatListDrawer = props => {\n    const [isOpen, setIsOpen] = useState(false)\n\n    return (\n        <div> \n            <MenuOutlined\n                onClick={() => setIsOpen(true)}\n                style={{ color: 'rgb(24, 144, 255)', outline: 'none' }} \n            />\n\n            { \n                isOpen &&\n                <div style={styles.drawerContainer}>\n                    <CloseOutlined\n                        style={styles.closeIcon}\n                        onClick={() => setIsOpen(false)}\n                    />\n\n                    <div style={styles.titleContainer}>\n                        <div style={styles.titleText}>\n                            My Chats\n                        </div>\n                    </div>\n\n                    <ChatList \n                        {...props} \n                        onChatClick={() => setIsOpen(false)}\n                    />\n                </div>\n            }\n        </div>\n    )\n}\n\nexport default ChatListDrawer\n\nconst styles = {\n    drawerContainer: { \n        position: 'fixed',\n        zIndex: '1',\n        top: '0px',\n        left: '0px',\n        width: '100%',\n        height: '100%',\n        backgroundColor: 'white',\n        textAlign: 'left'\n    },\n    closeIcon: {\n        position: 'absolute',\n        left: '28px',\n        top: '32px'\n    },\n    titleContainer: {\n        width: '100%',\n        padding: '24px 0px',\n        textAlign: 'center',\n        color: 'rgb(24, 144, 255)',\n    },\n    titleText: {\n        fontSize: '24px',\n        fontWeight: '600',\n    }\n}\n","import React, { useState } from 'react'\n\nimport { removePerson } from 'react-chat-engine'\n\nimport { Avatar, Button } from 'react-chat-engine'\n\nconst Person = props => {\n    const [selected, setSelected] = useState(false)\n\n    const { person, chat, conn } = props\n\n    if (!person || !chat) { return <div /> }\n\n    if (!conn || conn === null) return <div />\n\n    function onRemovePerson() {\n        removePerson(\n            props.conn,\n            props.chat.id,\n            props.person.username\n        )\n    }\n\n    function renderPersonText(person) {\n        if (person.first_name && person.first_name !== null) {\n            return `${person.first_name}${person.last_name ? ` ${person.last_name}` : ''}`\n        } else {\n            return person.username\n        }\n    }\n\n    return (\n        <div \n            className='ce-person-container'\n            onMouseEnter={() => setSelected(true)}\n            onMouseLeave={() => setSelected(false)}\n        >\n            <div \n                className='ce-person-avatar'\n                style={{ padding: '2px', height: '0px' }}\n            >\n                <Avatar \n                    avatar={person.avatar} \n                    username={person.username} \n                    is_online={person.is_online}\n                />\n            </div>\n\n            <div\n                className='ce-person-text'\n                style={{ paddingLeft: '52px', height: '44px', position: 'relative', top: '10px', fontSize: '15px' }}\n            >\n                { renderPersonText(person) }\n            </div>\n\n            {\n                selected && (conn.userName === chat.admin.username) && (person.username !== chat.admin.username) &&\n                <div\n                    className='ce-delete-chat' \n                    style={{ float: 'right', height: '0px', position: 'relative', bottom: '44px'}}\n                >\n                    <Button \n                        theme='danger'\n                        icon='delete'\n                        onClick={() => onRemovePerson()}\n                    />\n                </div>\n            }\n        </div>\n    )\n}\n\nexport default Person\n","import React, { useState } from 'react';\n\nimport { Avatar } from 'react-chat-engine'\n\n\nconst Option = props => {\n    const [focused, setFocused] = useState(false)\n\n    const { avatar, username } = props.person \n\n    return (\n        <div \n            id={`ce-username-option-${username}`}\n            onMouseEnter={() => setFocused(true)}\n            onMouseLeave={() => setFocused(false)}\n            onClick={() => props.onClick && props.onClick()}\n            style={{ ...styles.option, ...{ backgroundColor: focused ? '#f5f5f5' : 'white'} }}\n        >\n            <div>\n                <Avatar username={username} avatar={avatar} />\n            </div>\n\n            <div style={{ display: 'flex', padding: '12px 4px' }}>\n                {props.person.username}\n            </div>\n        </div>\n    );\n}\n\nexport default Option\n\nconst styles = {\n  option: {\n    padding: '4px 16px',\n    cursor: 'pointer',\n    fontSize: '15px',\n    display: 'flex'\n  },\n}","import React, { useState } from 'react';\n\nimport { addPerson, getOtherPeople } from 'react-chat-engine'\n\nimport { AutoCompleteInput } from 'react-chat-engine'\n\nimport Option from './Option'\n\nconst PersonForm = props => {\n  const [state, setState] = useState({\n    value: '',\n    others: []\n  })\n\n  function handleChange(value) {\n    setState({ ...state, value });\n  }\n\n  function invitePerson(name) {\n    addPerson(\n      props.conn,\n      props.chat.id,\n      name,\n      () => { \n        setState({ ...state, value: '' }); \n        getOthers(); \n      }\n    )\n  }\n\n  function getOthers() {\n    getOtherPeople(\n      props.conn,\n      props.chat.id,\n      (id, others) => setState({ ...state, others }),\n      () => {},\n    )\n  }\n\n  function renderOption(option) {\n    return <Option person={option} onClick={() => invitePerson(option.username)} />\n  }\n\n  return (\n    <div style={{ marginBottom: '12px' }}>\n      <AutoCompleteInput \n        style={{ width: '100%' }}\n        label='Type a username'\n        value={state.value}\n        options={state.others}\n        onFocus={() => getOthers()}\n        handleChange={(value) => handleChange(value)} \n        renderOption={(option) => renderOption(option)}\n      />\n    </div>\n  )\n}\n\nexport default PersonForm\n","import React, { useState } from 'react';\n\nimport Person from './Person'\nimport PersonForm from './PersonForm'\n\nimport { LeftOutlined, DownOutlined } from '@ant-design/icons'\n\nconst PeopleSettings = props => {\n    const [state, setState] = useState({\n        collapsed: false,\n        hovered: false\n    })\n    const { chat } = props\n\n    if (chat.is_direct_chat) { return <div /> }\n\n    function renderChatPeople(people, chat) {\n        return people.map((chatPerson, index) => {\n            return (\n                <Person \n                    key={`person_${index}`} \n                    person={chatPerson.person}\n                    conn={props} \n                    chat={chat} \n                />\n            )\n        })\n    }    \n\n    return (\n        <div style={{ borderTop: '1px solid #f0f0f0' }}>\n            <div \n                onMouseEnter={() => setState({ ...state, hovered: true })}\n                onMouseLeave={() => setState({ ...state, hovered: false })}\n                onClick={() => setState({ ...state, collapsed: !state.collapsed })}\n                style={state.hovered ? { backgroundColor: '#f0f0f0', cursor: 'pointer' } : {}}\n                className='ce-section-title-container ce-person-title-container'\n            >\n                <div\n                    className='ce-section-title ce-people-title'\n                    style={{ fontSize: '17px', padding: '12px', fontWeight: '600' }}>\n                    People\n                </div>\n\n                {\n                    state.collapsed ?\n                    <LeftOutlined style={styles.collapseIcon} /> :\n                    <DownOutlined style={styles.collapseIcon} />\n                }\n            </div>\n\n            {\n                !state.collapsed &&\n                <div>\n                    <div style={{ height: '12px' }} />\n\n                    { renderChatPeople(chat.people, chat) }\n\n                    <div style={{ height: '12px' }} />\n\n                    {\n                        props && chat && props.userName === chat.admin.username &&\n                        <PersonForm conn={props} chat={chat} />\n                    }\n                </div>\n            }\n        </div>\n    )\n}\n\nexport default PeopleSettings\n\nconst styles = {\n    collapseIcon: {\n        float: 'right',\n        position: 'relative',\n        bottom: '30px',\n        right: '12px'\n    }\n}","import React from 'react'\n\nconst Thumbnail = props => {\n    const { attachment } = props \n\n    if (!attachment) { return <div /> }\n\n    return (\n        <div style={styles.container} className='ce-photo-thumbnail'>\n            \n            <div style={{ paddingTop: '100%' }} />\n            \n            <img\n                alt={attachment.id}\n                style={styles.image}\n                src={attachment.file}\n                className='ce-photo-img'\n                id={`image-${attachment.id}`}\n            />\n            \n        </div>\n    )\n}\n\nexport default Thumbnail\n\nconst styles = {\n    container: { \n        position: 'relative', \n        width: 'calc(33% - 8px)', \n        border: '1px solid white', \n        display: 'inline-block',\n        cursor: 'pointer'\n    },\n    image: {\n        top: '0px', \n        width: '100%', \n        height: '100%',\n        position: 'absolute',\n        objectFit: 'cover'\n    }\n}","import React, { useState } from 'react'\n\nimport Thumbnail from './Thumbnail'\n\nimport { LeftOutlined, DownOutlined } from '@ant-design/icons'\n\n\nconst PhotosSettings = props => {\n    const [state, setState] = useState({\n        collapsed: true,\n        hovered: false\n    })\n    const { chat } = props\n\n    function renderPhotos(attachments) {\n        return attachments.map((attachment, index) => {\n            return <Thumbnail key={`person_${index}`} attachment={attachment} />\n        })\n    }\n\n    return (\n        <div style={{ borderTop: '1px solid #f0f0f0' }} className='ce-photo-section'>\n            <div \n                onMouseEnter={() => setState({ ...state, hovered: true })}\n                onMouseLeave={() => setState({ ...state, hovered: false })}\n                onClick={() => setState({ ...state, collapsed: !state.collapsed })}\n                style={state.hovered ? { backgroundColor: '#f0f0f0', cursor: 'pointer' } : {}}\n                className='ce-section-title-container ce-photo-title-container'\n            >\n                <div \n                    className='ce-section-title ce-photo-title'\n                    style={{ fontSize: '17px', padding: '12px', fontWeight: '600' }}\n                >\n                    Photos\n                </div>\n\n                {\n                    state.collapsed ?\n                    <LeftOutlined style={styles.collapseIcon} /> :\n                    <DownOutlined style={styles.collapseIcon} />\n                }\n            </div>\n\n            {\n                !state.collapsed &&\n                <div className='ce-photo-feed'>\n                    <div style={{ height: '12px' }} />\n\n                    { renderPhotos(chat.attachments) }\n                </div>\n            }\n        </div>\n    )\n}\n\nexport default PhotosSettings\n\nconst styles = {\n    collapseIcon: {\n        float: 'right',\n        position: 'relative',\n        bottom: '30px',\n        right: '12px'\n    }\n}\n","import React, { useState } from 'react'\n\nimport { Button, deleteChat } from 'react-chat-engine'\n\nimport { LeftOutlined, DownOutlined } from '@ant-design/icons'\n\nconst OptionsSettings = props => {\n    const [state, setState] = useState({\n        collapsed: true,\n        hovered: false\n    })\n    const { chat } = props\n\n    return (\n        <div style={{ borderTop: '1px solid #f0f0f0' }}>\n            <div \n                id='ce-options-drop-down'\n                onMouseEnter={() => setState({ ...state, hovered: true })}\n                onMouseLeave={() => setState({ ...state, hovered: false })}\n                onClick={() => setState({ ...state, collapsed: !state.collapsed })}\n                style={state.hovered ? { backgroundColor: '#f0f0f0', cursor: 'pointer' } : {}}\n            >\n                <div style={{ fontSize: '17px', padding: '12px', fontWeight: '600' }}>\n                    Options\n                </div>\n\n                {\n                    state.collapsed ?\n                    <LeftOutlined style={styles.collapseIcon} /> :\n                    <DownOutlined style={styles.collapseIcon} />\n                }\n            </div>\n            \n            {\n                !state.collapsed &&\n                <div>\n                    <div style={{ height: '12px' }} />\n\n                    <Button \n                        value=\"Delete\" \n                        theme='danger'\n                        icon='delete'\n                        id='ce-delete-chat-button'\n                        onClick={() => deleteChat(props, chat.id, (data) => {})}\n                        style={{ width: '100%', marginBottom: '12px' }}\n                    />\n                </div>\n            }\n        </div>\n    )\n}\n\nexport default OptionsSettings\n\nconst styles = {\n    collapseIcon: {\n        float: 'right',\n        position: 'relative',\n        bottom: '30px',\n        right: '12px'\n    }\n}\n","import React, { useState, useEffect, useRef } from 'react';\n\nimport { editChat, TextInput } from 'react-chat-engine'\n\nconst NewMessageForm = props => {\n    const didMountRef = useRef(false)\n    const [state, setState] = useState({\n        activeChat: null,\n        value: ''\n    })\n  \n    function handleChange(event) {\n        setState({ ...state, value: event.target.value });\n    }\n  \n    function handleSubmit(event) {\n        event.preventDefault();\n\n        editChat(\n            props.conn, \n            props.chat.id,\n            {title: state.value},\n            (data) => {}\n        )\n    }\n\n    useEffect(() => {\n        if (!didMountRef.current) {\n            didMountRef.current = true\n\n        } else {\n            if(state.activeChat !== props.chat.id) {\n                setState({ \n                    ...state,\n                    value: props.chat.title,\n                    activeChat: props.chat.id\n                })\n            }\n        }\n    })\n\n    return (\n        <form onSubmit={(e) => handleSubmit(e)} className='ce-chat-title-form'>\n            <TextInput \n                label=\"Rename this Chat\" \n                value={state.value} \n                default={props.chat.title}\n                handleChange={(e) => handleChange(e)} \n                style={{ \n                    fontSize: '16px',\n                    fontWeight: '600',\n                    textAlign: 'center',\n                    border: '0px solid white',\n                    width: '100%',\n                }}\n            />\n        </form>\n    );\n}\n\nexport default NewMessageForm","import React, { useContext } from 'react'\n\nimport { ChatEngineContext } from '../../../Context'\n\nimport { Avatar } from 'react-chat-engine'\n\nimport TitleForm from './TitleForm'\n\nconst ChatSettingsTop = props => {\n    const { conn } = useContext(ChatEngineContext)\n    const { chat } = props\n    \n    if (!conn || conn === null) return <div />\n\n    const topPeople = chat.people.slice(0, 3)\n    const otherPerson = getOtherPerson(chat.people)\n\n    function renderOnePerson(people) {\n        return (\n            <div style={{ width: '100%', paddingTop: '14px' }}>\n                <div style={{ float: 'left', position: 'relative', left: 'calc(50% - 22px)' }}>\n                    <Avatar \n                        show_online={false} \n                        username={people[0].person.username} \n                        avatar={people[0].person.avatar}\n                    />\n                </div>\n            </div>\n        )\n    }\n\n    function renderTwoPeople(people) {\n        return (\n            <div style={{ width: '100%', paddingTop: '14px' }}>\n                <div style={{ float: 'left', position: 'relative', left: 'calc(50% - 22px - 15px)' }}>\n                    <Avatar \n                        show_online={false} \n                        username={people[0].person.username} \n                        avatar={people[0].person.avatar}\n                    />\n                </div>\n\n                <div style={{ float: 'left', position: 'relative', left: 'calc(50% - 44px - 22px + 15px)' }}>\n                    <Avatar \n                        show_online={false} \n                        username={people[1].person.username} \n                        avatar={people[1].person.avatar}\n                    />\n                </div>\n            </div>\n        )\n    }\n\n    function renderThreePeople(people) {\n        return (\n            <div style={{ width: '100%', paddingTop: '14px' }}>\n                <div style={{ float: 'left', position: 'relative', left: 'calc(50% - 22px - 24px)' }}>\n                    <Avatar \n                        show_online={false} \n                        username={people[0].person.username}\n                        avatar={people[0].person.avatar}\n                    />\n                </div>\n\n                <div style={{ float: 'left', position: 'relative', left: 'calc(50% - 24px - 44px)' }}>\n                    <Avatar \n                        show_online={false} \n                        username={people[1].person.username} \n                        avatar={people[1].person.avatar}\n                    />\n                </div>\n\n                <div style={{ float: 'left', position: 'relative', left: 'calc(50% - 22px - 44px - 44px + 24px)' }}>\n                    <Avatar \n                        show_online={false} \n                        username={people[2].person.username}\n                        avatar={people[2].person.avatar}\n                    />\n                </div>\n            </div>\n        )\n    }\n\n    function getOtherPerson(people) {\n        return people.find(person => person.person.username !== conn.userName);\n    }\n    \n    return (\n        <div className='ce-chat-settings-container'>\n            <div className='ce-chat-avatars-row'>\n                { topPeople.length === 1 && renderOnePerson(topPeople) }\n                \n                { chat.is_direct_chat && otherPerson && renderOnePerson([otherPerson]) }\n\n                { !chat.is_direct_chat && otherPerson && topPeople.length === 2 && renderTwoPeople(topPeople) }\n\n                { !chat.is_direct_chat && otherPerson && topPeople.length === 3 && renderThreePeople(topPeople) }\n            </div>\n\n            {\n                chat.is_direct_chat && otherPerson ?\n                <div style={{ \n                    paddingTop: '55px',\n                    paddingBottom: '7px',\n                    fontSize: '16px',\n                    fontWeight: '600',\n                    textAlign: 'center',\n                    border: '0px solid white',\n                    width: '100%',\n                }}>\n                    { otherPerson.person.username }\n                </div> :\n                <TitleForm chat={chat} conn={conn} />\n            }\n        </div>\n    )\n}\n\nexport default ChatSettingsTop\n","import React, { useContext } from 'react'\n\nimport { ChatEngineContext } from '../../Context'\n\nimport PeopleSettings from './PeopleSettings'\nimport PhotosSettings from './PhotosSettings'\nimport OptionsSettings from './OptionsSettings'\nimport ChatSettingsTop from './ChatSettingsTop'\n\nconst ChatSettings = props => {\n    const { conn, chats, activeChat } = useContext(ChatEngineContext)  \n    const chat = chats && chats[activeChat] \n\n    if (props.renderChatSettings) return props.renderChatSettings(props)\n    \n    if (!chat) return <div style={styles.filler} />\n    \n    return (\n        <div style={styles.settingsContainer} className='ce-settings'>\n            <div style={{ width: '90%', paddingLeft: '5%' }} className='ce-settings-container'>\n                {\n                    props.renderChatSettingsTop ?\n                    props.renderChatSettingsTop(conn, chat) :\n                    <ChatSettingsTop {...props} chat={chat} />\n                }\n\n                {\n                    props.renderPeopleSettings ?\n                    props.renderPeopleSettings(conn, chat) :\n                    <PeopleSettings {...props} chat={chat} />\n                }\n\n                {\n                    props.renderPhotosSettings ?\n                    props.renderPhotosSettings(chat) :\n                    <PhotosSettings {...props} chat={chat} />\n                }\n\n                {\n                    props && chat && props.userName === chat.admin.username  &&\n                    <div>\n                        {\n                            props.renderOptionsSettings ?\n                            props.renderOptionsSettings(conn, chat) :\n                            <OptionsSettings {...props} chat={chat} />\n                        }\n                    </div>\n                }\n            </div>\n        </div>\n    )\n}\n\nexport default ChatSettings\n\nconst styles = {\n    settingsContainer: { \n        height: '100%',\n        overflow: 'scroll',\n        overflowX: 'hidden',\n        borderLeft: '1px solid #afafaf',\n        backgroundColor: 'white',\n        fontFamily: 'Avenir'\n    },\n    filler: { \n        display: 'flex',\n        width: '90%',\n        paddingLeft: '5%',\n        borderLeft: '1px solid #afafaf'\n    }\n}","import React, { useState } from 'react'\n\nimport { SettingOutlined, CloseOutlined } from '@ant-design/icons'\n\nimport ChatSettings from '../../ChatSettings'\n\nconst ChatSettingsDrawer = props => {\n    const [isOpen, setIsOpen] = useState(false)\n\n    return (\n        <div> \n            <SettingOutlined\n                onClick={() => setIsOpen(true)}\n                style={{ color: 'rgb(24, 144, 255)', outline: 'none' }} \n            />\n\n            { \n                isOpen &&\n                <div style={styles.drawerContainer}>\n                    <CloseOutlined\n                        style={styles.closeIcon}\n                        onClick={() => setIsOpen(false)}\n                    />\n\n                    <div style={styles.titleContainer}>\n                        <div style={styles.titleText}>\n                            Chat Settings\n                        </div>\n                    </div>\n\n                    <ChatSettings {...props} />\n                </div>\n            }\n        </div>\n    );\n}\n\nexport default ChatSettingsDrawer\n\nconst styles = {\n    drawerContainer: { \n        position: 'fixed',\n        zIndex: '1',\n        top: '0px',\n        left: '0px',\n        width: '100%',\n        height: '100%',\n        backgroundColor: 'white',\n        textAlign: 'left'\n    },\n    closeIcon: {\n        position: 'absolute',\n        left: '28px',\n        top: '32px'\n    },\n    titleContainer: {\n        width: '100%',\n        padding: '24px 0px',\n        textAlign: 'center',\n        color: 'rgb(24, 144, 255)',\n    },\n    titleText: {\n        fontSize: '24px',\n        fontWeight: '600',\n    },\n}\n","import React, { useContext } from 'react'\n\nimport { ChatEngineContext } from '../../../Context'\n\nimport { timeSinceDate } from '../../Utilities/dateToString'\n\nimport ChatListDrawer from './ChatListDrawer'\nimport ChatSettingsDrawer from './ChatSettingsDrawer'\n\nimport { Row, Col } from 'react-grid-system'\n\nimport { setConfiguration } from 'react-grid-system';\n \nsetConfiguration({ maxScreenClass: 'xl', gutterWidth: 0 });\n\nconst ChatHeader = () => {\n    const { conn, chats, activeChat } = useContext(ChatEngineContext)\n\n    if (!chats || !activeChat || !chats[activeChat]) { return <div /> }\n\n    if (!conn || conn === null) { return <div /> }\n\n    const chat = chats[activeChat]\n    const otherPerson = chat.people.find(person => person.person.username !== conn.userName);\n    const title = chat.is_direct_chat && otherPerson ? otherPerson.person.username : chat.title\n\n    return (\n        <Row \n            className='ce-chat-title'\n            style={styles.titleSection}\n        >\n            <Col \n                xs={2} \n                sm={0} \n                style={{ ...styles.mobileOptiom, ...{ left: '6px' } }}\n                className='ce-chat-list-mobile-option'\n            >\n                <ChatListDrawer />\n            </Col>\n\n            <Col \n                xs={8}\n                sm={12}\n                style={styles.titleContainer} \n                className='ce-chat-title-container'\n            >\n                <div \n                    style={styles.titleText} \n                    className='ce-chat-title-text' \n                    id={`ce-chat-feed-title-${title}`}\n                >\n                    { title }\n                </div>\n                \n                <div style={styles.subtitleText} className='ce-chat-subtitle-text'>\n                    {\n                        chat.last_message.created && chat.last_message.created.length > 0 ?\n                        `Active ${timeSinceDate(chat.last_message.created)}` :\n                        'Say hello!'\n                    }\n                </div>\n            </Col>\n\n            <Col \n                xs={2} \n                sm={0} \n                style={{ ...styles.mobileOptiom, ...{ right: '6px' } }}\n                className='ce-chat-settings-mobile-option'\n            >\n                <ChatSettingsDrawer />\n            </Col>\n        </Row>\n    );\n}\n\nexport default ChatHeader\n\nconst styles = {\n    titleSection: { \n        position: 'absolute',\n        top: '0px',\n        width: '100%',\n        zIndex: '1',\n        backgroundColor: 'rgb(256, 256, 256, 0.92)',\n        fontFamily: 'Avenir',\n    },\n    mobileOptiom: {\n        width: '100%',\n        top: '32px',\n        textAlign: 'center',\n        color: 'rgb(24, 144, 255)',\n        overflow: 'hidden'\n    },\n    titleContainer: {\n        width: '100%',\n        padding: '18px 0px',\n        textAlign: 'center',\n        color: 'rgb(24, 144, 255)',\n    },\n    titleText: {\n        fontSize: '24px',\n        fontWeight: '600',\n    },\n    subtitleText: {\n        fontSize: '12px',\n    }\n}\n","import React, { useState, useRef, useEffect, useContext } from 'react'\n\nimport { ChatEngineContext } from '../../../Context'\n\nconst RenderTrigger = props => {\n    const { setLoadMoreMessages } = useContext(ChatEngineContext)\n\n    function useOnScreen(ref) {\n        const [isIntersecting, setIntersecting] = useState(false)\n      \n        const observer = new IntersectionObserver(\n            ([entry]) => {\n                setIntersecting(entry.isIntersecting)\n                \n                if (entry.isIntersecting) { \n                    props.onEnter && props.onEnter()\n                } else {\n                    props.onLeave && props.onLeave()\n                }\n            }\n        )\n      \n        useEffect(() => {\n          observer.observe(ref.current)\n          // Remove the observer as soon as the component is unmounted\n          return () => { observer.disconnect() }\n        }, [])\n      \n        return isIntersecting\n    }\n  \n    const ref = useRef()\n    const isVisible = useOnScreen(ref)\n    \n    return <div ref={ref} />\n}\n\nexport default RenderTrigger","import React from 'react'\n\nconst months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']\nconst suffix = [\n  'st', 'nd', 'rd', 'th', 'th',\n  'th', 'th', 'th', 'th', 'th',\n  'th', 'th', 'th', 'th', 'th',\n  'th', 'th', 'th', 'th', 'th',\n  'st', 'nd', 'rd', 'th', 'th',\n  'th', 'th', 'th', 'th', 'th',\n  'st'\n]\n\nconst DatePartition = props => {\n    function getDate(date) {\n        return date ? date.substr(0, 10) : null\n    }\n\n    function formatDate(date_time) {\n        if (!date_time) return ''\n        \n        const year = date_time.substr(0, 4)\n        const month = months[parseInt(date_time.substr(5, 2)) - 1]\n        const day = date_time.substr(8, 2)\n        const dayDuffix = suffix[parseInt(date_time.substr(8, 2)) - 1]\n\n        var time = date_time.substr(11, 5)\n        var timeSuffix = ''\n\n        if(parseInt(time.substr(0, 2)) >= 12){\n            if(parseInt(time.substr(0, 2)) > 12){\n            time = String(parseInt(time.substr(0, 2)) - 12) + ':' + time.substr(3, 2)\n            }\n            timeSuffix = 'PM'\n\n        } else {\n            timeSuffix = 'AM'\n        }\n\n        return time + timeSuffix + ', ' + month + ' ' + day + dayDuffix + ', ' + year\n    }\n\n    const { lastCreated, created } = props\n\n    const lastDate = getDate(lastCreated)\n    const thisDate = getDate(created)\n\n    if (lastCreated && lastDate === thisDate ) {\n        return <div />\n    }\n\n    return (\n        <div style={styles.dateText} className='ce-message-date-text'>\n            { formatDate(created) }\n        </div>\n    )\n}\n\nexport default DatePartition\n\nconst styles = {\n    dateText: { \n        width: '100%', \n        textAlign: 'center',\n        paddingTop: '4px',\n        paddingBottom: '10px',\n        fontSize: '15px',\n        color: 'rgba(0, 0, 0, .40)'\n    }\n}","import React, { useState } from 'react'\n\nimport { LoadingOutlined } from '@ant-design/icons'\n\nconst Thumbnail = props => {\n    const [hovered, setHovered] = useState(false)\n    const { attachment } = props\n    const style={ \n        ...styles.thumbnail, \n        ...{ border: hovered ? '1px solid #1890ff' : '0px' } \n    }\n\n    if (!attachment) {\n        return (\n            <div style={styles.loadingContainer}>\n                <LoadingOutlined  style={{ color: 'white', padding: '4px', fontSize: '28px' }} />\n            </div>\n        )\n    }\n\n    return (\n        <img \n            onClick={() => window.open(attachment.file)}\n            onMouseEnter={() => setHovered(true)}\n            onMouseLeave={() => setHovered(false)}\n            src={attachment.file}\n            alt={'thumb-nail'}\n            style={style}\n        />\n    )\n}\n\nexport default Thumbnail\n\nconst styles = {\n    loadingContainer: {\n        width: '100%', \n        cursor: 'pointer',\n        textAlign: 'right', \n        display: 'inline-block', \n        objectFit: 'cover',\n        borderRadius: '0.3em',\n        marginRight: '2px',\n\n        height: '30vw', \n        width: '30vw', \n        maxHeight: '200px',\n        maxWidth: '200px',\n        minHeight: '100px',\n        minWidth: '100px',\n        backgroundColor: '#d9d9d9',\n    },\n    thumbnail: { \n        width: '100%', \n        cursor: 'pointer',\n        textAlign: 'right', \n        display: 'inline', \n        objectFit: 'cover',\n        borderRadius: '0.3em',\n        paddingRight: '2px',\n\n        height: '30vw', \n        width: '30vw', \n        maxHeight: '200px',\n        maxWidth: '200px',\n        minHeight: '100px',\n        minWidth: '100px',\n    }\n}","\n\nconst colors = [\n    '#D64045',\n    '#5B3000',\n    '#00CC99',\n    '#467599',\n    '#1D3354',\n    '#8F250C',\n    '#6153CC',\n    '#961D4E',\n    '#A29F15',\n    '#0CAADC',\n    '#FF5154',\n    '#FA7921',\n    '#688E26',\n    '#550527',\n    '#A10702',\n    '#FF1053',\n    '#6C6EA0',\n    '#100B00',\n]\n\nfunction stringToNumber(str){\n    let sum = 0\n    for (var i = 0; i < str.length; i++) {\n        sum = sum + (str.charCodeAt(i) * i) - 97\n    }\n    return sum\n}\n\nexport function stringToColor(str) {\n    if (!str) {\n        return 'black'\n    } else {\n        return colors[stringToNumber(str) % colors.length]\n    }\n}","import React, { Component } from 'react'\n\nimport { stringToColor } from '../../Utilities/colorMapping' \n\n\nexport default class Dot extends Component {\n    state = { avatar: '' }\n\n    updateImg() {\n        let { avatar } = this.props\n        avatar = avatar && avatar !== null ? avatar : ''\n        \n        if (avatar.split('?')[0] !== this.state.avatar.split('?')[0]) {\n            this.setState({ avatar })\n        }\n    }\n\n    componentDidMount() { this.updateImg() }\n\n    componentDidUpdate() { this.updateImg() }\n\n    render() {\n        const { username } = this.props\n        const color = stringToColor(username)\n        const customStyle = this.props.style ? this.props.style : {}\n        \n        return (\n            <div\n                className='ce-avatar-dot'\n                style={{\n                    ...styles.dot,\n                    ...customStyle,\n                    ...{\n                        backgroundColor: this.state.avatar ? 'white' : color,\n                        backgroundImage: this.state.avatar && `url(${this.state.avatar})`,\n                        backgroundRepeat: 'no-repeat',\n                        backgroundPosition: 'center',\n                        backgroundSize: '14px'\n                    }\n                }}\n            />\n        )\n    }\n}\n\nconst styles = {\n    dot: {\n        width: '13px',\n        height: '13px',\n        borderRadius: '13px',\n        textAlign: 'center',\n    }\n}","import React from 'react'\n\nimport Thumbnail from './Thumbnail'\n\nimport Dot from '../../../components/Avatar/Dot'\n\nimport { Row, Col, setConfiguration } from 'react-grid-system'\n\nsetConfiguration({ maxScreenClass: 'xl' })\n\nconst Message = props => {\n    function renderReads() {\n        const { chat, message } = props\n\n        if(!chat) { return <div /> }\n\n        return chat.people.map((chatPerson, index) => {\n            if (message.id === chatPerson.last_read) {\n                return (\n                    <Dot \n                        key={`read_${index}`}\n                        avatar={chatPerson.person.avatar}\n                        username={chatPerson.person.username}\n                        style={{ float: 'right', marginLeft: '4px' }} \n                    />\n                )\n            }\n            return <div key={`read_${index}`} />\n        })\n    }\n\n    function renderAttachments() {\n        const { message } = props\n        const attachments = message && message.attachments ? message.attachments : []\n        return attachments.map((attachment, index) => {\n            return <Thumbnail attachment={attachment} key={`attachment_${index}`} />\n        })\n    }\n\n    \n    const { lastMessage, message, nextMessage } = props\n\n    if (!message) { return <div /> }\n\n    const attachments = message && message.attachments && message.attachments\n\n    const topRightRadius = !lastMessage || lastMessage.sender_username !== message.sender_username ? '1.3em' : '0.3em'\n    const bottomRightRadius = !nextMessage || nextMessage.sender_username !== message.sender_username ? '1.3em' : '0.3em'\n\n    const borderRadius = `1.3em ${topRightRadius} ${bottomRightRadius} 1.3em`\n    const paddingBottom = !nextMessage || nextMessage.sender_username !== message.sender_username ? '12px' : '2px'\n\n    return (\n        <div \n            className='ce-message-row ce-my-message'\n            style={{ width: '100%', textAlign: 'right', paddingBottom }}\n        >\n            <div \n                style={{ display: 'auto' }} \n                className='ce-my-message-attachments-container'\n            >\n                { renderAttachments() }\n            </div>\n\n            <Row\n                style={{ paddingRight: '2px' }} \n                className='ce-message-bubble-row ce-my-message-bubble-row'\n            >\n                <Col xs={1} sm={2} md={3} />\n\n                <Col xs={11} sm={10} md={9}>\n                    {\n                        !attachments || message.text && \n                        <div\n                            className='ce-message-bubble ce-my-message-bubble'\n                            style={{ ...styles.myMessage, ...{ borderRadius } }}\n                        >\n                            { message.text }\n                        </div>\n                    }\n                </Col>\n\n                <Col xs={1} sm={2} md={3} />\n\n                <Col xs={12} className='ce-reads-row ce-my-reads-row'>\n                    { renderReads() }\n                </Col>\n            </Row>\n        </div>\n    )\n}\n\nexport default Message\n\nconst styles = {\n    myMessage: {\n        color: 'white', \n        cursor: 'pointer',\n        float: 'right', textAlign: 'left', // Stay right but render text\n        padding: '12px',\n        fontSize: '15px',\n        whiteSpace: 'pre-line',\n        backgroundColor: 'rgb(24, 144, 255)', \n    }\n}","import React from 'react'\n\nimport Thumbnail from './Thumbnail'\n\nimport { Avatar, Dot } from 'react-chat-engine'\n\nimport { Row, Col, setConfiguration } from 'react-grid-system'\n\nsetConfiguration({ maxScreenClass: 'xl' })\n\n\nconst TheirMessage = props => {\n    function renderReads() {\n        const { chat, message } = props\n\n        if(!chat) { return <div /> }\n\n        return chat.people.map((person, index) => {\n            if (message.id === person.last_read) {\n                return (\n                    <Dot \n                        key={`read_${index}`}\n                        avatar={person.person.avatar}\n                        username={person.person.username}\n                        style={{ float: 'left', marginLeft: '4px' }}\n                    />\n                )\n            }\n            return <div key={`read_${index}`} />\n        })\n    }\n\n    function renderAttachments() {\n        const { message } = props\n        const attachments = message && message.attachments ? props.message.attachments : []\n        return attachments.map((attachment, index) => {\n            return <Thumbnail attachment={attachment} key={`attachment_${index}`} />\n        })\n    }\n\n    const { lastMessage, message, nextMessage } = props\n\n    if (!message) { return <div /> }\n\n    const attachments = message && message.attachments && message.attachments\n\n    const topLeftRadius = !lastMessage || lastMessage.sender_username !== message.sender_username ? '1.3em' : '0.3em'\n    const bottomLeftRadius = !nextMessage || nextMessage.sender_username !== message.sender_username ? '1.3em' : '0.3em'\n\n    const borderRadius = `${topLeftRadius} 1.3em 1.3em ${bottomLeftRadius}`\n    const paddingBottom = !nextMessage || nextMessage.sender_username !== message.sender_username ? '12px' : '2px'\n\n    return (\n        <div \n            style={{ width: '100%', paddingBottom }}\n            className='ce-message-row ce-their-message'\n        >\n            {\n                (!lastMessage || lastMessage.sender_username !== message.sender_username) &&\n                <div style={styles.nameText} className='ce-their-message-sender'>\n                    { message.sender_username }\n                </div>\n            }\n        \n            <Row style={{ paddingLeft: '2px' }} className='ce-their-message-row'>\n                <Col xs={11} sm={10} md={9}>\n                    <div style={{ height: '0px' }} className='ce-their-message-avatar'>\n                        {\n                            (!nextMessage || nextMessage.sender_username !== message.sender_username) &&\n                            <Avatar\n                                show_online={false}\n                                username={message.sender_username}\n                                avatar={message.sender && message.sender.avatar}\n                            />\n                        }\n\n                    </div>\n\n                    <div \n                        style={{ display: 'auto', paddingLeft: '50px' }}\n                        className='ce-their-message-attachments-container'\n                    >\n                        { renderAttachments() }\n                    </div>\n\n                    {\n                        !attachments || message.text &&\n                        <div style={{ paddingLeft: '48px' }}>\n                            <div\n                                className='ce-message-bubble ce-their-message-bubble'\n                                style={{ ...styles.theirMessage, ...{ borderRadius } }}\n                            >\n                                { message.text }\n                            </div>\n                        </div>  \n                    }\n                </Col>\n\n                {/* Col is 9 to not slipp into RHS */}\n                <Col \n                    xs={9} \n                    style={{ marginLeft: '48px' }} \n                    className='ce-reads-row ce-their-reads-row'\n                >\n                    { renderReads() }\n                </Col>\n            </Row>\n        </div>\n    )\n}\n\nexport default TheirMessage\n\nconst styles = {\n    theirMessage: {\n        cusor: 'auto',\n        color: 'black', \n        float: 'left',\n        padding: '12px',\n        fontSize: '15px',\n        whiteSpace: 'pre-line',\n        backgroundColor: '#f1f0f0', \n    },\n    nameText: { \n        paddingLeft: '62px', \n        paddingBottom: '2px', \n        color: 'rgba(0, 0, 0, .40)', \n        fontSize: '15px' \n    }\n}","import React from 'react'\n\nimport Thumbnail from './Thumbnail'\n\nimport Dot from '../../../components/Avatar/Dot'\n\nimport { Row, Col, setConfiguration } from 'react-grid-system'\n\nsetConfiguration({ maxScreenClass: 'xl' })\n\nconst SendingMessage = props => {\n    function renderReads() {\n        const { chat, message } = props\n\n        if(!chat) { return <div /> }\n\n        return chat.people.map((chatPerson, index) => {\n            if (message.id === chatPerson.last_read) {\n                return (\n                    <Dot \n                        key={`read_${index}`}\n                        avatar={chatPerson.person.avatar}\n                        username={chatPerson.person.username}\n                        style={{ float: 'right', marginLeft: '4px' }} \n                    />\n                )\n            }\n            return <div key={`read_${index}`} />\n        })\n    }\n\n    function renderAttachments(attachments) {\n        return attachments.map((a, index) => {\n            return <Thumbnail key={`sending-file-${index}`} />\n        })\n    }\n\n    const { lastMessage, message, nextMessage } = props\n\n    if (!message) { return <div /> }\n\n    const attachments = message && message.attachments ? message.attachments : []\n\n    const topRightRadius = !lastMessage || lastMessage.sender_username !== message.sender_username ? '1.3em' : '0.3em'\n    const bottomRightRadius = !nextMessage || nextMessage.sender_username !== message.sender_username ? '1.3em' : '0.3em'\n\n    const borderRadius = `1.3em ${topRightRadius} ${bottomRightRadius} 1.3em`\n    const paddingBottom = !nextMessage || nextMessage.sender_username !== message.sender_username ? '12px' : '2px'\n\n    return (\n        <div \n            className='ce-message-row ce-my-message ce-my-message-sending'\n            style={{ width: '100%', textAlign: 'right', paddingBottom }}\n        >\n            <div \n                style={{ display: 'auto' }} \n                className='ce-my-message-attachments-container'\n            >\n                { renderAttachments(attachments) }\n            </div>\n\n            <Row\n                style={{ paddingRight: '2px' }} \n                className='ce-message-bubble-row ce-my-message-bubble-row ce-my-message-sending-row'\n            >\n                <Col xs={1} sm={2} md={3} />\n\n                <Col xs={11} sm={10} md={9}>\n                    {\n                        message.text &&\n                        <div\n                            className='ce-message-bubble ce-my-message-bubble'\n                            style={{ ...styles.myMessage, ...{ borderRadius } }}\n                        >\n                            { message.text }\n                        </div>\n                    }\n                </Col>\n                \n                <Col xs={1} sm={2} md={3} />\n            </Row>\n        </div>\n    )\n}\n\nexport default SendingMessage\n\nconst styles = {\n    myMessage: {\n        color: 'white', \n        cursor: 'pointer',\n        float: 'right', textAlign: 'left', // Stay right but render text\n        padding: '12px',\n        fontSize: '15px',\n        whiteSpace: 'pre-line',\n        backgroundColor: '#40a9ff', \n    }\n}","import React, { useContext } from 'react'\n\nimport { ChatEngineContext } from '../../../../Context'\n\nimport DatePartition from './DatePartition'\nimport MyMessage from './MyMessage'\nimport TheirMessage from './TheirMessage'\nimport SendingMessage from './SendingMessage'\n\nconst Message = props => {\n    const { lastMessage, message, nextMessage, sending, chat } = props\n\n    const { conn } = useContext(ChatEngineContext)\n\n    if (!message || !chat) { return <div /> }\n\n    if (!conn || conn === null) { return <div /> }\n\n    return (\n        <div className='ce-message-and-date'>\n            {\n                !sending &&\n                <DatePartition \n                    lastCreated={lastMessage ? lastMessage.created : null} \n                    created={message.created} \n                />\n            }\n\n            {\n                sending ? \n                <SendingMessage \n                    chat={chat} \n                    conn={conn} \n                    lastMessage={lastMessage} \n                    message={message} \n                    nextMessage={nextMessage} \n                /> :\n                <div>\n                    {\n                        message.sender_username === conn.userName || message.sender_username === conn.senderUsername ?\n                        <MyMessage \n                            chat={chat}\n                            conn={conn}\n                            lastMessage={lastMessage}\n                            message={message}\n                            nextMessage={nextMessage}\n                        /> :\n                        <TheirMessage \n                            chat={chat}\n                            conn={conn}\n                            lastMessage={lastMessage}\n                            message={message}\n                            nextMessage={nextMessage}\n                        />\n                    }\n                </div>\n            }\n        </div>\n    ) \n}\n\nexport default Message","import React, { useContext } from 'react'\n\nimport { ChatEngineContext } from '../../../Context'\n\nimport { RenderTrigger } from '../Triggers'\n\nimport MessageBubble from './MessageBubbles/index'\n\nconst Messages = props => {\n    const { \n        conn,\n        chats,\n        messages,\n        activeChat,\n        setLoadMoreMessages,\n        setIsBottomVisible,\n    } = useContext(ChatEngineContext)\n\n    const chat = chats && chats[activeChat]\n    const keys = Object.keys(messages)\n\n    if (!conn || conn === null) return <div />\n    \n    return keys.map((key, index) => {\n        const message = messages[key]\n        const lastMessageKey = index === 0 ? null : keys[index - 1]\n        const nextMessageKey = index === keys.length - 1 ? null : keys[index + 1]\n\n        if (props.renderMessageBubble) {\n            return (\n                <div key={`message_${index}`}>\n                    { \n                        props.renderMessageBubble(\n                            conn, \n                            chat, \n                            messages[lastMessageKey], \n                            message, \n                            messages[nextMessageKey]\n                        ) \n                    }\n                </div>\n            )\n        }\n        \n        return (\n            <div key={`message_${index}`} id={`ce-message-${message.id}`}>\n                {/* Scroll down if the top of last msg is visible */}\n                { \n                    index === keys.length - 1 && \n                    <RenderTrigger \n                        onEnter={() => setIsBottomVisible(true)}\n                        onLeave={() => setIsBottomVisible(false)}\n                    />\n                }\n\n                <MessageBubble \n                    chat={chat}\n                    message={message}\n                    lastMessage={messages[lastMessageKey]}\n                    nextMessage={messages[nextMessageKey]}\n                />\n\n                {/* Load more if the bottom of top msg is visible */}\n                { \n                    index === 0 && \n                    <RenderTrigger onEnter={() => setLoadMoreMessages(true)} /> \n                }\n            </div>\n        )\n    })\n}\nexport default Messages","import React, { useContext } from 'react'\n\nimport { ChatEngineContext } from '../../../Context'\n\nimport MessageBubble from './MessageBubbles/index'\n\nconst SendingMessages = props => {\n    const { \n        conn,\n        chats,\n        activeChat,\n        sendingMessages,\n    } = useContext(ChatEngineContext)\n    \n    const keys = Object.keys(sendingMessages)\n    const chat = chats && chats[activeChat]\n\n    if (!conn || conn === null) return <div />\n\n    return keys.map((key, index) => {\n        const message = sendingMessages[key]\n        const lastMessageKey = index === 0 ? null : keys[index - 1]\n        const nextMessageKey = index === keys.length - 1 ? null : keys[index + 1]\n\n        if(message && message.chat === activeChat) {\n            return (\n                <MessageBubble \n                    sending\n                    key={`sending-msg-${index}`}\n                    chat={chat}\n                    message={message}\n                    lastMessage={sendingMessages[lastMessageKey]}\n                    nextMessage={sendingMessages[nextMessageKey]}\n                />\n            )\n        }\n    })\n}\nexport default SendingMessages","import React, { useContext } from 'react'\n\nimport { ChatEngineContext } from '../../Context'\n\nimport { stringToColor } from '../Utilities/colorMapping'\n\nconst Typers = props => {\n    const { conn, activeChat, typingCounter } = useContext(ChatEngineContext)\n    const typers = typingCounter && typingCounter[activeChat] ? typingCounter[activeChat] : []\n\n    if (!conn || conn === null) return <div />\n\n    if (props.renderIsTyping) { return props.renderIsTyping(typers) }\n\n    return (\n        <div>\n            {\n                Object.keys(typers).map((username, index) => {\n                    if (conn.userName !== username && props.currentTime < typers[username] + 2000) {\n                        return (\n                            <div \n                                key={`typer_${index}`} \n                                style={{ color: stringToColor(username), padding: '2px', paddingLeft: '12px' }}\n                            >\n                                {`${username} is typing...`}\n                            </div>\n                        )\n\n                    } else {\n                        return <div key={`typer_${index}`} />\n                    }\n                })\n            }\n        </div>\n    )\n}\nexport default Typers","import React, { useState, useEffect } from 'react'\n\nimport { CloseCircleTwoTone } from '@ant-design/icons'\n\nconst Thumbnail = props => {\n    const [hovered, setHovered] = useState(false)\n    const [blob, setBlob] = useState('')\n    useEffect(() => {\n      setBlob(URL.createObjectURL(props.file))\n    }, [props.file])\n    return (\n        <div \n            style={{ padding: '12px 6px', display: 'inline-block', position: \"relative\" }}\n            onMouseEnter={() => setHovered(true)}\n            onMouseLeave={() => setHovered(false)}\n        >\n            \n            <img\n                style={styles.imageSquare}\n                alt={props.file ? props.file.name : ''}\n                src={blob}\n            />\n\n            {\n                hovered &&\n                <CloseCircleTwoTone \n                    style={styles.closeIcon} \n                    onClick={() => props.onRemove && props.onRemove()}\n                />\n            }\n        </div>\n    )\n}\n\nexport default Thumbnail\n\nconst styles = {\n    imageSquare: { \n        height: '108px', \n        width: '108px', \n        border: '1px solid #afafaf',\n        borderRadius: '8px',\n        objectFit: 'cover',\n        display: 'inline',\n    },\n    closeIcon: {\n        position: 'absolute', \n        bottom: 'calc(100% - 32px)', \n        left: '96px', \n        width: '0px', \n        cursor: 'pointer'\n    }\n}\n","import React from 'react'\n\nimport Thumbnail from './Thumbnail'\n\nconst FileRow = props => {\n    function renderFiles() {\n        return props.files.map((file, index) => {\n            return (\n                <Thumbnail \n                    file={file} \n                    key={`thumb_${index}`} \n                    onRemove={() => props.onRemove && props.onRemove(index)}\n                />\n            )\n        })\n    }\n  \n    return (\n        <div style={{ width: 'calc(100% - 24px)', paddingLeft: '12px' }}>\n            { renderFiles() }\n        </div>\n    )\n}\n\nexport default FileRow","import React, { useState } from 'react';\n\nimport { PaperClipOutlined } from '@ant-design/icons'\n\nconst ImagesInput = props => {\n    const [state, setState] = useState({\n        hovered: false,\n    })\n\n    function onSelect(event) {\n        const files = Array.from(event.target.files)\n        props.onSelectFiles &&  props.onSelectFiles(files)\n    }\n\n    return (\n        <form\n            className=\"uploader\"\n            encType=\"multipart/form-data\"\n            style={{ height: '0px' }}\n        >\n            <label\n                htmlFor=\"files\"\n                id='upload-document-button'\n            >\n                <PaperClipOutlined \n                    onMouseEnter={() => setState({ ...state, hovered: true })}\n                    onMouseLeave={() => setState({ ...state, hovered: false })}\n                    style={{\n                        ...{ cursor: 'pointer', position: 'absolute', bottom: '20px', right: '63px', fontSize: '18px' },\n                        ...{ color: state.hovered ? '#69c0ff' : '#1890ff' }\n                    }}\n                />\n            </label>\n\n            <input\n                multiple\n                id=\"files\"\n                accept=\"image/x-png,image/gif,image/jpeg\"\n                style={{ visibility: \"hidden\" }}\n                type=\"file\"\n                onChange={(e) => onSelect(e)}\n                onClick={(e) => e.target.value = null}\n            />\n        </form>\n    );\n}\n\nexport default ImagesInput\n","import React, { Component } from 'react'\n\nexport default class MessageInput extends Component {\n    state = {\n        focused: false,\n        value: null,\n        height: 0\n    }\n\n    resize() {\n        var textarea = document.getElementById(\"msg-textarea\");\n        textarea.style.height = \"\";\n        textarea.style.height = Math.min(textarea.scrollHeight, 150) + \"px\";\n        this.setState({ height: Math.min(textarea.scrollHeight, 150) })\n    }\n\n    componentDidMount() { this.resize() }\n\n    handleChange(e) {\n        this.resize()\n        this.props.handleChange && this.props.handleChange(e)\n    }\n\n    onKeyDown(e) {\n        if (e.key === 'Enter') { \n            e.preventDefault()\n\n            if (this.props.value.length > 0) {\n                this.props.onSubmit && this.props.onSubmit(e) \n            }\n        }\n    }    \n\n    render() {\n        const style = { \n            ...styles.input, \n            ...{ overflowY: this.state.height === 150 ? 'scroll' : 'hidden' } \n        }\n\n        return (\n            <textarea \n                id='msg-textarea'\n                className='ce-input ce-textarea-input'\n                rows='1'\n                style={style}\n                value={this.props.value}\n                placeholder={this.props.label}\n                onBlur={() => this.setState({ focused: false })}\n                onFocus={() => this.setState({ focused: true })}\n                type={this.props.type ? this.props.type : \"text\" }\n                onChange={(e) => this.handleChange(e)} \n                onKeyDown={(e) => this.onKeyDown(e)}\n            />\n        )\n    }\n}\n\nconst styles = {\n    input: { \n        border: '1px solid white',\n        width: 'calc(100% - 64px - 24px - 44px)',\n        outline: 'none', \n        fontSize: '15px',\n        fontFamily: 'Avenir',\n        paddingLeft: '12px',\n        paddingRight: '12px',\n        position: 'relative', \n        left: '12px',\n        resize: 'none', \n        overflowX: 'hidden'\n    }\n}","import React, { useContext, useState } from 'react'\n\nimport { ChatEngineContext } from '../../../Context'\n\nimport { sendMessage, isTyping } from 'react-chat-engine'\n\nimport FileRow from './FileRow'\nimport ImagesInput from './ImagesInput'\nimport MessageInput from './MessageInput'\n\nimport { Button } from 'react-chat-engine'\n\nconst NewMessageForm = () => {\n  const { conn, activeChat, sendingMessages, setSendingMessages } = useContext(ChatEngineContext)\n  const [state, setState] = useState({\n    trigger: 0,\n    mod: 3,\n    value: '',\n    attachments: []\n  })\n\n  if (!conn || conn === null) return <div />\n\n  function onRemove(index) {\n    let { attachments } = state \n    attachments.splice(index, 1)\n    setState({ ...state, attachments })\n  }\n  \n  function handleChange(event) {\n    setState({\n      ...state,\n      value: event.target.value,\n      trigger: (state.trigger + 1) % state.mod\n    });\n    \n    if (state.trigger === 1) {\n      isTyping(conn, activeChat)\n    }\n  }\n  \n  function handleSubmit(event) {\n    event.preventDefault();\n\n    const { attachments } = state\n    const text = state.value.trim()\n    const custom_json = { sender_id: Date.now().toString() }\n    const sender_username = conn.userName ? conn.userName : conn.senderUsername\n    const data = { text, attachments, custom_json, sender_username, chat: activeChat }\n\n    if (text.length > 0 || attachments.length > 0) {\n      sendMessage(conn, activeChat, data, (data) => {})\n    }\n\n    setState({ ...state, value: '', attachments: [] })\n    \n    // TODO: Should be in Text Area Input\n    var textarea = document.getElementById(\"msg-textarea\")\n    textarea.style.height = \"24px\"\n\n    let newSendingMessages = {...sendingMessages}\n    newSendingMessages[data.custom_json.sender_id] = data\n    setSendingMessages(newSendingMessages)\n  }\n\n  return (\n    <div \n      id='msg-form-container'\n      style={styles.NewMessageFormContainer}\n      className='ce-message-form-container'\n    >\n      <FileRow files={state.attachments} onRemove={(i) => onRemove(i)} />\n\n      <ImagesInput onSelectFiles={(attachments) => setState({ ...state, attachments })} />\n\n      <form onSubmit={handleSubmit.bind(this)} className='ce-message-form'>\n        <div style={styles.inputContainer} className='ce-message-input-form'>\n          <MessageInput\n            value={state.value}\n            label='Send a message...'\n            handleChange={handleChange.bind(this)}\n            onSubmit={handleSubmit.bind(this)}\n          />\n\n          <Button \n            icon='send'\n            type=\"submit\"\n            id='ce-send-message-button'\n            style={{ position: 'absolute', bottom: '10px', right: '6px' }}\n          />\n        </div>\n      </form>\n    </div>\n  );\n}\n\nexport default NewMessageForm\n\nconst styles = {\n  NewMessageFormContainer: { \n    position: 'absolute', \n    bottom: '0px', \n    width: '100%', \n    backgroundColor: 'white',\n  },\n  inputContainer: { \n    minHeight: '36px',\n    paddingTop: '10px',\n    paddingBottom: '6px',\n  },\n}","import React, { useContext, useState, useEffect, useRef } from 'react'\n\nimport { ChatEngineContext } from '../../Context'\n\nimport { getLatestMessages, readMessage } from '../../../actions/messages'\n\nimport { AuthFail, ConnectionBar, Welcome } from './Steps'\n\nimport ChatHeader from './ChatHeader'\nimport Messages from './Messages'\nimport SendingMessages from './Messages/SendingMessages'\nimport Typers from './Typers'\nimport NewMessageForm from './NewMessageForm'\n\nimport _ from 'lodash'\n\nimport { animateScroll } from \"react-scroll\"\n\nconst initial = 45\nlet count = initial\nconst interval = 33\n\nconst ChatFeed = props => {\n    const didMountRef = useRef(false)\n    const [duration, setDuration] = useState(0)\n    const [currentChat, setCurrentChat] = useState(null)\n    const [currentTime, setCurrentTime] = useState(Date.now())\n    const { \n        conn,\n        chats, setChats,\n        sendingMessages,\n        messages, setMessages,\n        activeChat, setActiveChat,\n        loadMoreMessages, setLoadMoreMessages,\n        isBottomVisible,\n    } = useContext(ChatEngineContext)\n\n    function onReadMessage(chat) {\n        if (chats) {\n            const newChats = {...chats}\n            newChats[chat.id] = chat\n            setChats(newChats)\n        }\n    }\n\n    function onGetMessages(chatId, messages, scrollDownTo) {\n        setMessages(_.mapKeys(messages, 'id'))\n\n        if (messages.length > 0) {\n            const message = messages[messages.length - 1]\n\n            if (props.userName && props.userName !== message.sender_username) {\n                readMessage(conn, chatId, message.id, (chat) => onReadMessage(chat))\n            }\n        }\n\n        if (scrollDownTo) {\n            animateScroll.scrollToBottom({ duration: 0, containerId: scrollDownTo })\n        }\n        \n        props.onGetMessages && props.onGetMessages(chatId, messages)\n    }\n\n    function loadMessages(loadMoreMessages) {\n        // Message Loader triggers\n        if (loadMoreMessages) { \n            count = count + interval\n            setLoadMoreMessages(false)\n\n            getLatestMessages(\n                conn, activeChat, count, \n                (chatId, messages) => onGetMessages(chatId, messages, false)\n            )\n\n        // Active Chat passed by context\n        } else if (conn && !props.activeChat && activeChat !== null && activeChat !== currentChat) {\n            count = initial\n            setCurrentChat(activeChat)\n\n            getLatestMessages(\n                conn, activeChat, count, \n                (chatId, messages) => onGetMessages(chatId, messages, \"ce-feed-container\")\n            )\n\n        // Active Chat passed by props\n        } else if (conn && props.activeChat && props.activeChat !== currentChat) {\n            count = initial\n            setActiveChat(props.activeChat)\n            setCurrentChat(props.activeChat)\n\n            getLatestMessages(\n                conn, props.activeChat, count, \n                (chatId, messages) => onGetMessages(chatId, messages, \"ce-feed-container\")\n            )\n        }\n    }\n\n    useEffect(() => { loadMessages(false) }, [conn, activeChat, currentChat])\n    useEffect(() => { loadMessages(loadMoreMessages) }, [loadMoreMessages])\n\n    useEffect(() => {\n        if (!didMountRef.current) {\n            didMountRef.current = true\n            \n            setTimeout(() => {\n                setDuration(100)\n            }, 3000) // Start animating scroll post-load\n\n            setInterval(() => {\n                setCurrentTime(Date.now())\n            }, 1000) // Check time every second\n\n        } else {\n            // Scroll on new incoming messages\n            if(isBottomVisible && !_.isEmpty(messages)) {\n                animateScroll.scrollToBottom({\n                    duration,\n                    containerId: \"ce-feed-container\"\n                })\n            }\n        }\n    }, [sendingMessages, messages, isBottomVisible])\n\n\n    const chat = chats && chats[currentChat] \n\n    if(props.renderChatFeed) {\n        return props.renderChatFeed(props)\n    \n    } else if (conn === undefined) {\n        return <AuthFail />\n    \n    } else if (conn && chats !== null && _.isEmpty(chats)) {\n        return <Welcome />\n    }\n\n    return (\n        <div \n            className='ce-chat-feed'\n            style={{ height: '100%', maxHeight: '100vh', backgroundColor: '#f0f0f0' }}\n        >\n            { props.renderChatHeader ?  props.renderChatHeader(chat) : <ChatHeader /> }\n\n            <div\n                id='ce-feed-container'\n                style={styles.feedContainer} \n                className='ce-chat-feed-container'\n            >\n                <div style={{ height: '88px' }} className='ce-feed-container-top' />\n\n                <Messages {...props} />\n\n                <SendingMessages {...props} />\n\n                <Typers currentTime={currentTime} />\n\n                <ConnectionBar />\n\n                <div style={{ height: '54px' }} className='ce-feed-container-bottom' />\n            </div>\n\n            { props.renderNewMessageForm ? props.renderNewMessageForm(props, currentChat) : <NewMessageForm /> }\n        </div>\n    )\n}\n\nexport default ChatFeed\n\nconst styles = {\n    feedContainer: { \n        width: '100%',\n        height: '100%',\n        maxHeight: '100vh',\n        overflowX: 'hidden',\n        overflowY: 'scroll',\n        backgroundColor: 'white',\n        fontFamily: 'Avenir',\n    }\n}","import React, { useContext } from 'react'\n\nimport { ChatEngineContext } from '../Context'\n\nimport _ from 'lodash'\n\nimport Socket from '../Socket'\n\nimport ChatList from './ChatList'\nimport ChatFeed from './ChatFeed'\nimport ChatSettings from './ChatSettings'\n\nimport { Row, Col } from 'react-grid-system'\nimport { setConfiguration } from 'react-grid-system';\n \nsetConfiguration({ maxScreenClass: 'xl', gutterWidth: 0 });\n\nconst ChatEngine = props => {\n  const context = useContext(ChatEngineContext)\n  const { height } = props\n  const propsAndContext = {...props, ...context}\n\n  return (\n    <div style={{ textAlign: 'left', backgroundColor: 'white' }}>\n      <Socket {...props} />\n\n      <Row>\n        <Col xs={0} sm={3} style={{ height: height ? height : '' }}>\n          <ChatList {...propsAndContext} />\n        </Col>\n\n        <Col xs={12} sm={6} style={{ height: height ? height : '' }}>\n          <ChatFeed {...propsAndContext} />\n        </Col>\n\n        <Col xs={0} sm={3} style={{ height: height ? height : '' }}>\n          <ChatSettings { ...propsAndContext} />\n        </Col>\n      </Row>\n    </div>\n  )\n}\n\nexport default ChatEngine","import React, { useContext } from 'react'\n\nimport ChatEngine from './ChatEngine'\n\nimport { ChatEngineWrapper, ChatEngineContext } from './Context'\n\nconst ChatEngineApp = (props) => {\n    if (useContext(ChatEngineContext)) {\n        return <ChatEngine {...props} />\n    } else {\n        return <ChatEngineWrapper><ChatEngine {...props} /></ChatEngineWrapper>\n    }\n    \n}\n\nexport default ChatEngineApp\n","import React, { useContext, useState } from 'react'\n\nimport { ChatEngineContext } from '../Context'\n\nimport { getChat, getLatestMessages } from 'react-chat-engine'\n\nimport { WebSocket } from 'nextjs-websocket'\n\nconst ChatSocket = props => {\n    const [reconnect, reset] = useState(Date.now() + 10000)\n    const {\n      setConnecting,\n      conn, setConn, setCreds,\n      chats, setChats,\n      messages, setMessages,\n      sendingMessages, setSendingMessages,\n      activeChat, setActiveChat,\n      typingCounter, setTypingCounter,\n    } = useContext(ChatEngineContext)\n\n    // Common Context Handlers\n\n    function onEditChat(chat) {\n        if (chats) {\n            const newChats = {...chats}\n            newChats[chat.id] = chat\n            setChats(newChats)\n        }\n\n        props.onEditChat && props.onEditChat(chat)\n    }\n\n    function onGetChat(chat) {\n        if (activeChat === null) {\n            setActiveChat(chat.id)\n        }\n\n        setChats(_.mapKeys([chat], 'id'))\n    }\n\n    function onConnect(conn) {\n        setConn(conn); setCreds(conn);\n        setConnecting(false)\n    \n        getChat(conn, props.chatID, (chat) => onGetChat(chat))\n    \n        if (Date.now() > reconnect) {\n            getLatestMessages(\n                conn, props.chatID, 45,\n                (id, list) => {\n                    setMessages({...messages, ..._.mapKeys(list, 'id')})\n                }\n            )\n        }\n\n        props.onConnect && props.onConnect(conn)\n    }\n    \n    // Socket Events\n\n    function handleEvent(event) {\n        const eventJSON = JSON.parse(event)\n\n        if (eventJSON.action === 'login_error') {\n            console.log(\n                `Your chat auth credentials were not correct: \\n\n                Project ID: ${props.projectID} \\n\n                Chat ID: ${props.chatID} \\n\n                Access Key: ${props.chatAccessKey}\\n\n                Double check these credentials to make sure they're correct.\\n\n                If all three are correct, try resetting the username and secret in the Online Dashboard or Private API.`\n            )\n\n            setConn(undefined); setCreds(undefined);\n\n            props.onFailAuth && props.onFailAuth(conn)\n\n        } else if (eventJSON.action === 'edit_chat') {\n            onEditChat(eventJSON.data)\n            \n        } else if (eventJSON.action === 'delete_chat') {\n            const chat = eventJSON.data \n\n            if (chats) {\n                chats[chat.id] = undefined\n                \n                setChats(chats)\n            }\n\n            props.onDeleteChat && props.onDeleteChat(chat)\n\n        } else if (eventJSON.action === 'add_person') {\n            onEditChat(eventJSON.data)\n            \n            props.onAddPerson && props.onAddPerson(eventJSON.data)\n\n        } else if (eventJSON.action === 'remove_person') {\n            onEditChat(eventJSON.data)\n\n            props.onRemovePerson && props.onRemovePerson(eventJSON.data)\n\n        } else if (eventJSON.action === 'new_message') {\n            const { id, message } = eventJSON.data\n\n            if (typeof message.custom_json === \"string\" && message.custom_json.indexOf('sender_id') !== -1) {\n                sendingMessages[JSON.parse(message.custom_json).sender_id] = undefined\n                setSendingMessages(sendingMessages)\n            }\n        \n            if (id === activeChat) {\n                const newMessages = {...messages}\n                newMessages[message.id] = message\n                setMessages(newMessages)\n            }\n\n            props.onNewMessage && props.onNewMessage(id, message)\n\n        } else if (eventJSON.action === 'edit_message') {\n            const { id, message } = eventJSON.data\n            \n            if (id === activeChat) {\n                messages[message.id] = message\n                setMessages(messages)\n            }\n\n            props.onEditMessage && props.onEditMessage(id, message)\n\n        } else if (eventJSON.action === 'delete_message') {\n            const { id, message } = eventJSON.data\n\n            if (id === activeChat) {\n                messages[message.id] = undefined\n                setMessages(messages)\n            }\n\n            props.onDeleteMessage && props.onDeleteMessage(id, message)\n        \n        } else if (eventJSON.action === 'is_typing') {\n            const { id, person } = eventJSON.data\n            let newTypingCounter = {...typingCounter}\n            newTypingCounter = {\n                ...newTypingCounter,\n                [id]: {\n                    ...newTypingCounter[id],\n                    [person]: Date.now()\n                }\n            }\n\n            setTypingCounter(newTypingCounter)\n\n            props.onTyping && props.onTyping(id, person)\n        }\n    }\n\n    function onClose() { setConnecting(true) }\n\n    // Render\n    \n    const {\n        development,\n        publicKey, projectID, \n        chatID, chatAccessKey, \n    } = props \n    \n    const wsStart = development ? 'ws://' : 'wss://'\n    const rootHost = development ? '127.0.0.1:8000' : 'api.chatengine.io'\n    const project = publicKey ? publicKey : projectID\n\n    return <WebSocket \n        url={`${wsStart}${rootHost}/chat/?projectID=${project}&chatID=${chatID}&accessKey=${chatAccessKey}`}\n        onOpen={() => onConnect(props)}\n        onClose={onClose.bind(this)}\n        onMessage={handleEvent.bind(this)}\n        reconnectIntervalInMilliSeconds={3000}\n    />\n}\n\nexport default ChatSocket","import React, { Component } from 'react'\n\nimport { stringToColor } from '../../Utilities/colorMapping' \n\n\nexport default class Avatar extends Component {\n    state = { avatar: '' }  \n\n    updateImg() {\n        let { avatar } = this.props\n        avatar = avatar && avatar !== null ? avatar : ''\n        \n        if (avatar.split('?')[0] !== this.state.avatar.split('?')[0]) {\n            this.setState({ avatar })\n        }\n    }\n\n    componentDidMount() { this.updateImg() }\n\n    componentDidUpdate() { this.updateImg() }\n\n    render() {\n        const { username, is_online } = this.props\n        const customStyle = this.props.style ? this.props.style : {}\n        const text = username ? username.substring(0, 2).toUpperCase() : ''\n        const color = stringToColor(username)    \n                \n        return (\n            <div style={{ width: '48px', height: '48px' }}>\n                <div style={{ height: '0px' }}>\n                    <div \n                        className='ce-avatar'\n                        style={{ \n                            ...styles.avatar, \n                            ...customStyle, \n                            ...{ \n                                backgroundColor: this.state.avatar ? 'white' : color,\n                                backgroundImage: this.state.avatar && `url(${this.state.avatar})`,\n                                backgroundRepeat: 'no-repeat',\n                                backgroundPosition: 'center',\n                                backgroundSize: '48px',\n                            }\n                        }}\n                    >   \n                        <div \n                            className='ce-avatar-text'\n                            style={styles.avatarText}\n                        >\n                            { !this.state.avatar && text }\n                        </div>\n                    </div>\n                </div>\n\n                {\n                    this.props.show_online !== false && \n                    <div\n                        className='ce-avatar-status'\n                        style={{\n                            ...styles.status, \n                            ...{ backgroundColor: is_online ? '#52c41a' : '#f5222d' }\n                        }}\n                    />\n                }\n            </div>\n        )\n    }\n}\n\nconst styles = {\n    avatar: {\n        width: '44px',\n        height: '44px',\n        borderRadius: '22px',\n        color: 'white',\n        textAlign: 'center',\n    },\n    avatarText: {\n        color: 'white', \n        paddingTop: '12px', \n        fontSize: '15px', \n        fontWeight: '600'\n    },\n    status: { \n        width: '8px', \n        height: '8px', \n        borderRadius: '100%', \n        border: '2px solid white',   \n    }\n}","import React, { Component } from 'react'\n\nimport { PlusOutlined, ArrowUpOutlined, DeleteOutlined, UserAddOutlined } from '@ant-design/icons'\n\nexport default class Button extends Component {\n    state = {\n        hovered: false\n    }\n\n    render() {\n        const { value, icon, theme, style } = this.props\n\n        const customStyle = style ? style : {}\n        const hoverStyle = this.state.hovered ? styles.hoverButton : {}\n        const themeStyle = theme === 'danger' ? styles.dangerButton : styles.button\n\n        return (\n            <button \n                id={this.props.id}\n                type={this.props.type}\n                onClick={() => this.props.onClick && this.props.onClick()}\n                onMouseEnter={() => this.setState({ hovered: true })}\n                onMouseLeave={() => this.setState({ hovered: false })}\n                style={{ ...themeStyle, ...customStyle, ...hoverStyle }}\n                className={`ce-primary-button ${theme === 'danger' ? 'ce-danger-button' : ''}`}\n            >\n\n                { icon === 'plus' && <PlusOutlined /> }\n                { icon === 'send'  && <ArrowUpOutlined /> }\n                { icon === 'delete'  && <DeleteOutlined /> }\n                { icon === 'user-add'  && <UserAddOutlined /> }\n\n                { value && icon ? ` ${value}` : value}  \n\n            </button>\n        )\n    }\n}\n\nconst styles = {\n    button: {\n        color: 'white',\n        border: 'none',\n        outline: 'none',\n        height: '36px',\n        fontSize: '15px',\n        cursor: 'pointer',\n        padding: '8px 16px',\n        borderRadius: '33px',\n        backgroundColor: '#1890ff'\n    },\n    dangerButton: {\n        color: 'red',\n        border: 'none',\n        outline: 'none',\n        height: '36px',\n        fontSize: '15px',\n        cursor: 'pointer',\n        padding: '8px 16px',\n        borderRadius: '33px',\n        backgroundColor: 'white',\n        border: '1px solid red',\n    },\n    hoverButton: {\n        opacity: '0.66'\n    }\n}","import React, { Component } from 'react'\n\nexport default class TextInput extends Component {\n    state = {\n        focused: false,\n        value: null\n    }\n\n    componentDidMount() {\n        const value = this.props.default\n        if(value) {\n            const event = {target: {value}}\n            this.props.handleChange(event)\n            this.setState({ value })\n        }\n    }\n\n    render() {\n        const customStyle = this.props.style ? this.props.style : {}\n        const defaultStyle = this.state.focused ? styles.focusInput : styles.input\n\n        return (\n            // NOTE: You may need to make a div the searchContainer to put icons in...\n            <input \n                id={this.props.id}\n                autoFocus={this.props.autoFocus}\n                className='ce-input ce-text-input'\n                value={this.props.value} \n                placeholder={this.props.label}\n                style={{ ...defaultStyle, ...customStyle }}\n                onBlur={() => {\n                    this.setState({ focused: false });\n                    this.props.onBlur && this.props.onBlur();\n                }}\n                onFocus={() => {\n                    this.setState({ focused: true });\n                    this.props.onFocus && this.props.onFocus();\n                }}\n                type={this.props.type ? this.props.type : \"text\" }\n                onChange={(e) => this.props.handleChange && this.props.handleChange(e)} \n            />\n        )\n    }\n}\n\nconst styles = {\n    input: {\n        // Sizes\n        height: '36px',\n        fontSize: '15px',\n        fontFamily: 'Avenir',\n        // Border\n        outline: 'none',\n        borderRadius: '24px',\n        border: '1px solid #d9d9d9',\n        // Padding and fixed width\n        padding: '0px 12px',\n        boxSizing: 'border-box',\n    },\n    focusInput: {\n        // Sizes\n        height: '36px',\n        fontSize: '15px',\n        fontFamily: 'Avenir',\n        // Border\n        outline: 'none',\n        borderRadius: '24px',\n        border: '1px solid #1890ff',\n        // Padding and fixed width\n        padding: '0px 12px',\n        boxSizing: 'border-box',\n    }\n}","import React, { Component } from 'react'\n\nimport { CloseOutlined } from '@ant-design/icons'\n\nexport default class AutoComplete extends Component {\n    state = {\n        focused: false,\n        showAll: false,\n    }\n\n    onFocus() {\n        this.onChange('', true)\n        this.setState({ focused: true })\n        this.props.onFocus && this.props.onFocus()\n    }\n\n    onBlur() {\n        this.setState({ focused: false })\n        this.props.onBlur && this.props.onBlur()\n    }\n\n    onChange(value, showAll) {\n        this.setState({ showAll })\n        this.props.handleChange && this.props.handleChange(value)\n    }\n\n    getNames() {\n        let count = 0\n        const max = this.props.max ? this.props.max : 3\n        \n        const results = []\n\n        this.props.options.map(option => {\n            if (JSON.stringify(option).toLowerCase().indexOf(this.props.value.toLowerCase()) !== -1 && count < max) {\n                count = count + 1\n                results.push(option)\n            }\n        })\n        \n        return results\n    }\n\n\n    renderOptions() {\n        if(!this.props.value && !this.state.showAll) { return <div /> }\n\n        const results = this.getNames()\n\n        return results.map((option, index) => {\n            return (\n                <div key={`option_${index}`} className='ce-autocomplete-option'>\n                    { this.props.renderOption && this.props.renderOption(option) }\n\n                    { \n                        index === results.length - 1 && \n                        <div \n                            style={styles.close} \n                            className='ce-autocomplete-close'\n                            onClick={() => this.onChange('', false)}\n                        >\n                            <CloseOutlined />\n                        </div>\n                    }\n                </div>\n            )\n        })\n    }\n\n    render() {\n        const { options } = this.props\n        const customStyle = this.props.style ? this.props.style : {}\n        const defaultStyle = { ...styles.input, ...{ border: this.state.focused ? '1px solid #1890ff' : '1px solid #d9d9d9' } }\n\n        return (\n            <div>\n                <input \n                    id='ce-add-username-input'\n                    className='ce-input ce-autocomplete-input'\n                    value={this.props.value} \n                    placeholder={this.props.label}\n                    style={{ ...defaultStyle, ...customStyle }}\n                    type={this.props.type ? this.props.type : \"text\" }\n                    onBlur={() => this.onBlur()}\n                    onFocus={() => this.onFocus()}\n                    onChange={(e) => this.onChange(e.target.value, true)}\n                />\n\n                {\n                    options && options.length > 0 && this.state.showAll &&\n                    <div \n                        className='ce-autocomplete-options'\n                        style={{ borderRadius: '19px', border: '1px solid #afafaf', overflow: 'hidden' }}\n                    >\n                        { this.props.options && this.renderOptions() }\n                    </div>\n                }\n            </div>\n        )\n    }\n}\n\nconst styles = {\n    input: {\n        height: '36px',\n        fontSize: '15px',\n        outline: 'none',\n        borderRadius: '24px',\n        padding: '0px 12px',\n        boxSizing: 'border-box',\n        fontFamily: 'Avenir'\n    },\n    close: {\n        cursor: 'pointer',\n        textAlign: 'center',\n        padding: '8px 12px',\n        fontSize: '15px',\n        borderRadius: '24px',\n    }\n}","import axios from 'axios'\n\nimport * as str from '..'\nimport { getHeaders } from '../auth'\n\nexport function addPerson(props, chatId, userName, callback) {\n    axios.post(\n        `${str.getApiUrl(props)}/chats/${chatId}/people/`,\n        { username: userName },\n        { headers: getHeaders(props) }\n    )\n\n    .then((response) => {\n        callback && callback(response.data)\n    })\n    \n    .catch((error) => {\n        console.log('New Person Error', error)\n    });\n}","import axios from 'axios'\nimport * as str from '..'\nimport { getHeaders } from '../auth'\n\nexport function removePerson(props, chatId, userName, callback) {\n    axios.put(\n        `${str.getApiUrl(props)}/chats/${chatId}/people/`,\n        { username: userName },\n        { headers: getHeaders(props) }\n    )\n\n    .then((response) => {\n        callback && callback(response.data)\n    })\n    \n    .catch((error) => {\n        console.log('Delete Person Error', error)\n    });\n}","import axios from 'axios'\nimport * as str from '../../actions'\nimport { getHeaders } from '../auth'\n\nexport function getOtherPeople(props, chatId, successCallback, errorCallback) {\n    axios.get(\n        `${str.getApiUrl(props)}/chats/${chatId}/others/`,\n        { headers: getHeaders(props) }\n    )\n\n    .then((response) => {\n        // Run hook in Axios on GET requests\n        props.onGetOtherPeople && props.onGetOtherPeople(chatId, response.data)\n\n        successCallback && successCallback(chatId, response.data)\n    })\n    \n    .catch((error) => {\n        console.log('Fetch Other People Error', error)\n\n        errorCallback && errorCallback()\n    });\n}","import axios from 'axios'\n\nimport * as str from '..'\nimport { getHeaders } from '../auth'\n\nexport function getMyData(props, callback) {\n    axios.get(\n        `${str.getApiUrl(props)}/chats/me/`,\n        { headers: getHeaders(props) }\n    )\n\n    .then((response) => {\n        callback && callback(response.data)\n    })\n    \n    .catch((error) => {\n        console.log('Get Myself Error', error)\n    });\n}","import axios from 'axios'\n\nimport * as str from '..'\nimport { getHeaders } from '../auth'\n\nexport function editMyData(props, data, callback) {\n    axios.patch(\n        `${str.getApiUrl(props)}/chats/me/`,\n        data,\n        { headers: getHeaders(props) }\n    )\n\n    .then((response) => {\n        callback && callback(response.data)\n    })\n    \n    .catch((error) => {\n        console.log('Edit Myself Error', error)\n    });\n}","import axios from 'axios'\nimport * as str from '..'\nimport { getHeaders } from '../auth'\n\nexport function leaveChat(props, chatId, callback) {\n    axios.delete(\n        `${str.getApiUrl(props)}/chats/${chatId}/people/`,\n        { headers: getHeaders(props)}\n    )\n\n    .then((response) => {\n        callback && callback(response.data)\n    })\n    \n    .catch((error) => {\n        console.log('Delete Person Error', error)\n    });\n}","import axios from 'axios'\n\nimport * as str from '..'\nimport { getHeaders } from '../auth'\n\nexport function isTyping(props, chatId, callback) {\n    axios.post(\n        `${str.getApiUrl(props)}/chats/${chatId}/typing/`,\n        {},\n        { headers: getHeaders(props) }\n    )\n\n    .then((response) => {\n        callback && callback(response.data)\n    })\n    \n    .catch((error) => {});\n}"]},"metadata":{},"sourceType":"module"}